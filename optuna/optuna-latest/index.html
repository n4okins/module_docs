<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Optuna 3.2.0.dev0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="_static/sg_gallery.css" type="text/css" />
      <link rel="stylesheet" href="_static/sg_gallery-binder.css" type="text/css" />
      <link rel="stylesheet" href="_static/sg_gallery-dataframe.css" type="text/css" />
      <link rel="stylesheet" href="_static/sg_gallery-rendered-html.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="canonical" href="https://optuna.readthedocs.io/en/stable/index.html" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">
    <div class="navbar">
        <div class="navbar ml-auto">
            <ul class="navbar-nav">
                <li>
                    <a href="https://optuna.org/#key_features" class="header_link">Key Features</a>
                </li>
                <li>
                    <a href="https://optuna.org/#code_examples" class="header_link">Code Examples</a>
                </li>
                <li>
                    <a href="https://optuna.org/#installation" class="header_link">Installation</a>
                </li>
                <li>
                    <a href="https://optuna.org/#blog" class="header_link">Blog</a>
                </li>
                <li>
                    <a href="https://optuna.org/#video" class="header_link">Videos</a>
                </li>
                <li>
                    <a href="https://optuna.org/#paper" class="header_link">Paper</a>
                </li>
                <li>
                    <a href="https://optuna.org/#community" class="header_link">Community</a>
                </li>
            </ul>
        </div>
    </div>
     

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#">
            
              <img src="_static/optuna-logo.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                latest
              </div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-tutorial/index">Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-reference/index">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="index.html#document-faq">FAQ</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">Optuna</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <!-- This file is necessary to remove "Edit on Github" button from readthedocs by following https://docs.readthedocs.io/en/stable/guides/remove-edit-buttons.html#remove-links-from-top-right-corner --><div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Optuna 3.2.0.dev0 documentation</li>

  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <p><a class="reference internal" href="https://raw.githubusercontent.com/optuna/optuna/master/docs/image/optuna-logo.png"><img alt="OPTUNA" src="https://raw.githubusercontent.com/optuna/optuna/master/docs/image/optuna-logo.png" style="width: 800px;" /></a></p>
<section id="optuna-a-hyperparameter-optimization-framework">
<h1>Optuna: A hyperparameter optimization framework<a class="headerlink" href="#optuna-a-hyperparameter-optimization-framework" title="Permalink to this heading"></a></h1>
<p><em>Optuna</em> is an automatic hyperparameter optimization software framework,
particularly designed for machine learning. It features an imperative,
<em>define-by-run</em> style user API. Thanks to our <em>define-by-run</em> API, the
code written with Optuna enjoys high modularity, and the user of Optuna
can dynamically construct the search spaces for the hyperparameters.</p>
<section id="key-features">
<h2>Key Features<a class="headerlink" href="#key-features" title="Permalink to this heading"></a></h2>
<p>Optuna has modern functionalities as follows:</p>
<ul class="simple">
<li><p><a class="reference internal" href="index.html#document-tutorial/10_key_features/001_first"><span class="doc">Lightweight, versatile, and platform agnostic architecture</span></a></p>
<ul>
<li><p>Handle a wide variety of tasks with a simple installation that has few requirements.</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="index.html#document-tutorial/10_key_features/002_configurations"><span class="doc">Pythonic search spaces</span></a></p>
<ul>
<li><p>Define search spaces using familiar Python syntax including conditionals and loops.</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="index.html#document-tutorial/10_key_features/003_efficient_optimization_algorithms"><span class="doc">Efficient optimization algorithms</span></a></p>
<ul>
<li><p>Adopt state-of-the-art algorithms for sampling hyperparameters and efficiently pruning unpromising trials.</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="index.html#document-tutorial/10_key_features/004_distributed"><span class="doc">Easy parallelization</span></a></p>
<ul>
<li><p>Scale studies to tens or hundreds of workers with little or no changes to the code.</p></li>
</ul>
</li>
<li><p><a class="reference internal" href="index.html#document-tutorial/10_key_features/005_visualization"><span class="doc">Quick visualization</span></a></p>
<ul>
<li><p>Inspect optimization histories from a variety of plotting functions.</p></li>
</ul>
</li>
</ul>
</section>
<section id="basic-concepts">
<h2>Basic Concepts<a class="headerlink" href="#basic-concepts" title="Permalink to this heading"></a></h2>
<p>We use the terms <em>study</em> and <em>trial</em> as follows:</p>
<ul class="simple">
<li><p>Study: optimization based on an objective function</p></li>
<li><p>Trial: a single execution of the objective function</p></li>
</ul>
<p>Please refer to sample code below. The goal of a <em>study</em> is to find out
the optimal set of hyperparameter values (e.g., <code class="docutils literal notranslate"><span class="pre">classifier</span></code> and
<code class="docutils literal notranslate"><span class="pre">svm_c</span></code>) through multiple <em>trials</em> (e.g., <code class="docutils literal notranslate"><span class="pre">n_trials=100</span></code>). Optuna is
a framework designed for the automation and the acceleration of the
optimization <em>studies</em>.</p>
<p><a class="reference external" href="http://colab.research.google.com/github/optuna/optuna-examples/blob/main/quickstart.ipynb"><img alt="Open in Colab" src="https://colab.research.google.com/assets/colab-badge.svg" /></a></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">...</span>

<span class="c1"># Define an objective function to be minimized.</span>
<span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>

    <span class="c1"># Invoke suggest methods of a Trial object to generate hyperparameters.</span>
    <span class="n">regressor_name</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_categorical</span><span class="p">(</span><span class="s1">&#39;classifier&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;SVR&#39;</span><span class="p">,</span> <span class="s1">&#39;RandomForest&#39;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">regressor_name</span> <span class="o">==</span> <span class="s1">&#39;SVR&#39;</span><span class="p">:</span>
        <span class="n">svr_c</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s1">&#39;svr_c&#39;</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="mf">1e10</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">regressor_obj</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">svm</span><span class="o">.</span><span class="n">SVR</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="n">svr_c</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rf_max_depth</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_int</span><span class="p">(</span><span class="s1">&#39;rf_max_depth&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">32</span><span class="p">)</span>
        <span class="n">regressor_obj</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">ensemble</span><span class="o">.</span><span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="n">rf_max_depth</span><span class="p">)</span>

    <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">fetch_california_housing</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_val</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_val</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="n">regressor_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">y_pred</span> <span class="o">=</span> <span class="n">regressor_obj</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_val</span><span class="p">)</span>

    <span class="n">error</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_val</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">error</span>  <span class="c1"># An objective value linked with the Trial object.</span>

<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">()</span>  <span class="c1"># Create a new study.</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>  <span class="c1"># Invoke optimization of the objective function.</span>
</pre></div>
</div>
</section>
<section id="communication">
<h2>Communication<a class="headerlink" href="#communication" title="Permalink to this heading"></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/optuna/optuna/discussions">GitHub Discussions</a> for questions.</p></li>
<li><p><a class="reference external" href="https://github.com/optuna/optuna/issues">GitHub Issues</a> for bug
reports and feature requests.</p></li>
</ul>
</section>
<section id="contribution">
<h2>Contribution<a class="headerlink" href="#contribution" title="Permalink to this heading"></a></h2>
<p>Any contributions to Optuna are welcome! When you send a pull request,
please follow the <a class="reference external" href="https://github.com/optuna/optuna/blob/master/CONTRIBUTING.md">contribution guide</a>.</p>
</section>
<section id="license">
<h2>License<a class="headerlink" href="#license" title="Permalink to this heading"></a></h2>
<p>MIT License (see <a class="reference external" href="https://github.com/optuna/optuna/blob/master/LICENSE">LICENSE</a>).</p>
<p>Optuna uses the codes from SciPy and fdlibm projects (see <a class="reference internal" href="index.html#document-license_thirdparty"><span class="doc">Third-party License</span></a>).</p>
</section>
<section id="reference">
<h2>Reference<a class="headerlink" href="#reference" title="Permalink to this heading"></a></h2>
<p>Takuya Akiba, Shotaro Sano, Toshihiko Yanase, Takeru Ohta, and Masanori
Koyama. 2019. Optuna: A Next-generation Hyperparameter Optimization
Framework. In KDD (<a class="reference external" href="https://arxiv.org/abs/1907.10902">arXiv</a>).</p>
<div class="toctree-wrapper compound">
<span id="document-installation"></span><section id="installation">
<h3>Installation<a class="headerlink" href="#installation" title="Permalink to this heading"></a></h3>
<p>Optuna supports Python 3.7 or newer.</p>
<p>We recommend to install Optuna via pip:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>optuna
</pre></div>
</div>
<p>You can also install the development version of Optuna from master branch of Git repository:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>git+https://github.com/optuna/optuna.git
</pre></div>
</div>
<p>You can also install Optuna via conda:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>conda<span class="w"> </span>install<span class="w"> </span>-c<span class="w"> </span>conda-forge<span class="w"> </span>optuna
</pre></div>
</div>
</section>
<span id="document-tutorial/index"></span><section id="tutorial">
<h3>Tutorial<a class="headerlink" href="#tutorial" title="Permalink to this heading"></a></h3>
<p>If you are new to Optuna or want a general introduction, we highly recommend the below video.</p>
<iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/P6NwZVl8ttc" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<br />
<br />
<br /><div class="sphx-glr-thumbnails"></div><section id="key-features">
<h4>Key Features<a class="headerlink" href="#key-features" title="Permalink to this heading"></a></h4>
<p>Showcases Optuna’s <a class="reference external" href="https://github.com/optuna/optuna/blob/master/README.md#key-features">Key Features</a>.</p>
<div class="sphx-glr-thumbnails"><div class="sphx-glr-thumbcontainer" tooltip="Optuna is entirely written in Python and has few dependencies. This means that we can quickly m..."><img alt="" src="_images/sphx_glr_001_first_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-10-key-features-001-first-py"><span class="std std-ref">1. Lightweight, versatile, and platform agnostic architecture</span></a></p>
  <div class="sphx-glr-thumbnail-title">1. Lightweight, versatile, and platform agnostic architecture</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="For hyperparameter sampling, Optuna provides the following features:"><img alt="" src="_images/sphx_glr_002_configurations_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-10-key-features-002-configurations-py"><span class="std std-ref">2. Pythonic Search Space</span></a></p>
  <div class="sphx-glr-thumbnail-title">2. Pythonic Search Space</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Optuna enables efficient hyperparameter optimization by adopting state-of-the-art algorithms fo..."><img alt="" src="_images/sphx_glr_003_efficient_optimization_algorithms_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-10-key-features-003-efficient-optimization-algorithms-py"><span class="std std-ref">3. Efficient Optimization Algorithms</span></a></p>
  <div class="sphx-glr-thumbnail-title">3. Efficient Optimization Algorithms</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="It&#x27;s straightforward to parallelize optuna.study.Study.optimize."><img alt="" src="_images/sphx_glr_004_distributed_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-10-key-features-004-distributed-py"><span class="std std-ref">4. Easy Parallelization</span></a></p>
  <div class="sphx-glr-thumbnail-title">4. Easy Parallelization</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Optuna provides various visualization features in optuna.visualization to analyze optimization ..."><img alt="" src="_images/sphx_glr_005_visualization_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-10-key-features-005-visualization-py"><span class="std std-ref">5. Quick Visualization for Hyperparameter Optimization Analysis</span></a></p>
  <div class="sphx-glr-thumbnail-title">5. Quick Visualization for Hyperparameter Optimization Analysis</div>
</div></div></section>
<section id="recipes">
<h4>Recipes<a class="headerlink" href="#recipes" title="Permalink to this heading"></a></h4>
<p>Showcases the recipes that might help you using Optuna with comfort.</p>
<div class="sphx-glr-thumbnails"><div class="sphx-glr-thumbcontainer" tooltip="An RDB backend enables persistent experiments (i.e., to save and resume a study) as well as acc..."><img alt="" src="_images/sphx_glr_001_rdb_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-20-recipes-001-rdb-py"><span class="std std-ref">Saving/Resuming Study with RDB Backend</span></a></p>
  <div class="sphx-glr-thumbnail-title">Saving/Resuming Study with RDB Backend</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This tutorial showcases Optuna&#x27;s multi-objective optimization feature by optimizing the validat..."><img alt="" src="_images/sphx_glr_002_multi_objective_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-20-recipes-002-multi-objective-py"><span class="std std-ref">Multi-objective Optimization with Optuna</span></a></p>
  <div class="sphx-glr-thumbnail-title">Multi-objective Optimization with Optuna</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This feature is to annotate experiments with user-defined attributes."><img alt="" src="_images/sphx_glr_003_attributes_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-20-recipes-003-attributes-py"><span class="std std-ref">User Attributes</span></a></p>
  <div class="sphx-glr-thumbnail-title">User Attributes</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="    ask, Create a new trial and suggest parameters.     best-trial, Show the best trial.     be..."><img alt="" src="_images/sphx_glr_004_cli_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-20-recipes-004-cli-py"><span class="std std-ref">Command-Line Interface</span></a></p>
  <div class="sphx-glr-thumbnail-title">Command-Line Interface</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Thanks to user-defined samplers, you can:"><img alt="" src="_images/sphx_glr_005_user_defined_sampler_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-20-recipes-005-user-defined-sampler-py"><span class="std std-ref">User-Defined Sampler</span></a></p>
  <div class="sphx-glr-thumbnail-title">User-Defined Sampler</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="In optuna.pruners, we described how an objective function can optionally include calls to a pru..."><img alt="" src="_images/sphx_glr_006_user_defined_pruner_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-20-recipes-006-user-defined-pruner-py"><span class="std std-ref">User-Defined Pruner</span></a></p>
  <div class="sphx-glr-thumbnail-title">User-Defined Pruner</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This tutorial showcases how to use &amp; implement Optuna Callback for optimize."><img alt="" src="_images/sphx_glr_007_optuna_callback_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-20-recipes-007-optuna-callback-py"><span class="std std-ref">Callback for Study.optimize</span></a></p>
  <div class="sphx-glr-thumbnail-title">Callback for Study.optimize</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="It&#x27;s natural that you have some specific sets of hyperparameters to try first such as initial l..."><img alt="" src="_images/sphx_glr_008_specify_params_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-20-recipes-008-specify-params-py"><span class="std std-ref">Specify Hyperparameters Manually</span></a></p>
  <div class="sphx-glr-thumbnail-title">Specify Hyperparameters Manually</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Optuna has an Ask-and-Tell interface, which provides a more flexible interface for hyperparamet..."><img alt="" src="_images/sphx_glr_009_ask_and_tell_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-20-recipes-009-ask-and-tell-py"><span class="std std-ref">Ask-and-Tell Interface</span></a></p>
  <div class="sphx-glr-thumbnail-title">Ask-and-Tell Interface</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="In some cases, you may want to re-evaluate the objective function with the best hyperparameters..."><img alt="" src="_images/sphx_glr_010_reuse_best_trial_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-20-recipes-010-reuse-best-trial-py"><span class="std std-ref">Re-use the best trial</span></a></p>
  <div class="sphx-glr-thumbnail-title">Re-use the best trial</div>
</div></div><div class="toctree-wrapper compound">
<span id="document-tutorial/10_key_features/index"></span><section id="key-features">
<span id="sphx-glr-tutorial-10-key-features"></span><span id="id1"></span><h5>Key Features<a class="headerlink" href="#key-features" title="Permalink to this heading"></a></h5>
<p>Showcases Optuna’s <a class="reference external" href="https://github.com/optuna/optuna/blob/master/README.md#key-features">Key Features</a>.</p>
<div class="sphx-glr-thumbnails"><div class="sphx-glr-thumbcontainer" tooltip="Optuna is entirely written in Python and has few dependencies. This means that we can quickly m..."><img alt="" src="_images/sphx_glr_001_first_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-10-key-features-001-first-py"><span class="std std-ref">1. Lightweight, versatile, and platform agnostic architecture</span></a></p>
  <div class="sphx-glr-thumbnail-title">1. Lightweight, versatile, and platform agnostic architecture</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="For hyperparameter sampling, Optuna provides the following features:"><img alt="" src="_images/sphx_glr_002_configurations_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-10-key-features-002-configurations-py"><span class="std std-ref">2. Pythonic Search Space</span></a></p>
  <div class="sphx-glr-thumbnail-title">2. Pythonic Search Space</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Optuna enables efficient hyperparameter optimization by adopting state-of-the-art algorithms fo..."><img alt="" src="_images/sphx_glr_003_efficient_optimization_algorithms_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-10-key-features-003-efficient-optimization-algorithms-py"><span class="std std-ref">3. Efficient Optimization Algorithms</span></a></p>
  <div class="sphx-glr-thumbnail-title">3. Efficient Optimization Algorithms</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="It&#x27;s straightforward to parallelize optuna.study.Study.optimize."><img alt="" src="_images/sphx_glr_004_distributed_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-10-key-features-004-distributed-py"><span class="std std-ref">4. Easy Parallelization</span></a></p>
  <div class="sphx-glr-thumbnail-title">4. Easy Parallelization</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Optuna provides various visualization features in optuna.visualization to analyze optimization ..."><img alt="" src="_images/sphx_glr_005_visualization_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-10-key-features-005-visualization-py"><span class="std std-ref">5. Quick Visualization for Hyperparameter Optimization Analysis</span></a></p>
  <div class="sphx-glr-thumbnail-title">5. Quick Visualization for Hyperparameter Optimization Analysis</div>
</div></div><div class="toctree-wrapper compound">
<span id="document-tutorial/10_key_features/001_first"></span><div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-tutorial-10-key-features-001-first-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="lightweight-versatile-and-platform-agnostic-architecture">
<span id="first"></span><span id="sphx-glr-tutorial-10-key-features-001-first-py"></span><h6>1. Lightweight, versatile, and platform agnostic architecture<a class="headerlink" href="#lightweight-versatile-and-platform-agnostic-architecture" title="Permalink to this heading"></a></h6>
<p>Optuna is entirely written in Python and has few dependencies.
This means that we can quickly move to the real example once you get interested in Optuna.</p>
<section id="quadratic-function-example">
<h6 aria-level="7">Quadratic Function Example<a class="headerlink" href="#quadratic-function-example" title="Permalink to this heading"></a></h6>
<p>Usually, Optuna is used to optimize hyperparameters, but as an example,
let’s optimize a simple quadratic function: <span class="math notranslate nohighlight">\((x - 2)^2\)</span>.</p>
<p>First of all, import <a class="reference internal" href="index.html#module-optuna" title="optuna"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optuna</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">optuna</span>
</pre></div>
</div>
<p>In optuna, conventionally functions to be optimized are named <cite>objective</cite>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
</pre></div>
</div>
<p>This function returns the value of <span class="math notranslate nohighlight">\((x - 2)^2\)</span>. Our goal is to find the value of <code class="docutils literal notranslate"><span class="pre">x</span></code>
that minimizes the output of the <code class="docutils literal notranslate"><span class="pre">objective</span></code> function. This is the “optimization.”
During the optimization, Optuna repeatedly calls and evaluates the objective function with
different values of <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
<p>A <a class="reference internal" href="index.html#optuna.trial.Trial" title="optuna.trial.Trial"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trial</span></code></a> object corresponds to a single execution of the objective
function and is internally instantiated upon each invocation of the function.</p>
<p>The <cite>suggest</cite> APIs (for example, <a class="reference internal" href="index.html#optuna.trial.Trial.suggest_float" title="optuna.trial.Trial.suggest_float"><code class="xref py py-func docutils literal notranslate"><span class="pre">suggest_float()</span></code></a>) are called
inside the objective function to obtain parameters for a trial.
<a class="reference internal" href="index.html#optuna.trial.Trial.suggest_float" title="optuna.trial.Trial.suggest_float"><code class="xref py py-func docutils literal notranslate"><span class="pre">suggest_float()</span></code></a> selects parameters uniformly within the range
provided. In our example, from <span class="math notranslate nohighlight">\(-10\)</span> to <span class="math notranslate nohighlight">\(10\)</span>.</p>
<p>To start the optimization, we create a study object and pass the objective function to method
<a class="reference internal" href="index.html#optuna.study.Study.optimize" title="optuna.study.Study.optimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">optimize()</span></code></a> as follows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">()</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p>You can get the best parameter as follows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">best_params</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">best_params</span>
<span class="n">found_x</span> <span class="o">=</span> <span class="n">best_params</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Found x: </span><span class="si">{}</span><span class="s2">, (x - 2)^2: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">found_x</span><span class="p">,</span> <span class="p">(</span><span class="n">found_x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Found x: 1.9890913222999047, (x - 2)^2: 0.00011899924916455633
</pre></div>
</div>
<p>We can see that the <code class="docutils literal notranslate"><span class="pre">x</span></code> value found by Optuna is close to the optimal value of <code class="docutils literal notranslate"><span class="pre">2</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When used to search for hyperparameters in machine learning,
usually the objective function would return the loss or accuracy
of the model.</p>
</div>
</section>
<section id="study-object">
<h6 aria-level="7">Study Object<a class="headerlink" href="#study-object" title="Permalink to this heading"></a></h6>
<p>Let us clarify the terminology in Optuna as follows:</p>
<ul class="simple">
<li><p><strong>Trial</strong>: A single call of the objective function</p></li>
<li><p><strong>Study</strong>: An optimization session, which is a set of trials</p></li>
<li><p><strong>Parameter</strong>: A variable whose value is to be optimized, such as <code class="docutils literal notranslate"><span class="pre">x</span></code> in the above example</p></li>
</ul>
<p>In Optuna, we use the study object to manage optimization.
Method <a class="reference internal" href="index.html#optuna.study.create_study" title="optuna.study.create_study"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_study()</span></code></a> returns a study object.
A study object has useful properties for analyzing the optimization outcome.</p>
<p>To get the dictionary of parameter name and parameter values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">study</span><span class="o">.</span><span class="n">best_params</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;x&#39;: 1.9890913222999047}
</pre></div>
</div>
<p>To get the best observed value of the objective function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">study</span><span class="o">.</span><span class="n">best_value</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>0.00011899924916455633
</pre></div>
</div>
<p>To get the best trial:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">study</span><span class="o">.</span><span class="n">best_trial</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>FrozenTrial(number=74, state=TrialState.COMPLETE, values=[0.00011899924916455633], datetime_start=datetime.datetime(2023, 3, 17, 6, 24, 1, 95119), datetime_complete=datetime.datetime(2023, 3, 17, 6, 24, 1, 100364), params={&#39;x&#39;: 1.9890913222999047}, user_attrs={}, system_attrs={}, intermediate_values={}, distributions={&#39;x&#39;: FloatDistribution(high=10.0, log=False, low=-10.0, step=None)}, trial_id=74, value=None)
</pre></div>
</div>
<p>To get all trials:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">study</span><span class="o">.</span><span class="n">trials</span>
<span class="k">for</span> <span class="n">trial</span> <span class="ow">in</span> <span class="n">study</span><span class="o">.</span><span class="n">trials</span><span class="p">[:</span><span class="mi">2</span><span class="p">]:</span>  <span class="c1"># Show first two trials</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">trial</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>FrozenTrial(number=0, state=TrialState.COMPLETE, values=[9.083646219199833], datetime_start=datetime.datetime(2023, 3, 17, 6, 24, 0, 759056), datetime_complete=datetime.datetime(2023, 3, 17, 6, 24, 0, 759524), params={&#39;x&#39;: -1.0139087941077172}, user_attrs={}, system_attrs={}, intermediate_values={}, distributions={&#39;x&#39;: FloatDistribution(high=10.0, log=False, low=-10.0, step=None)}, trial_id=0, value=None)
FrozenTrial(number=1, state=TrialState.COMPLETE, values=[10.951427187877243], datetime_start=datetime.datetime(2023, 3, 17, 6, 24, 0, 759869), datetime_complete=datetime.datetime(2023, 3, 17, 6, 24, 0, 760156), params={&#39;x&#39;: 5.3092940618623246}, user_attrs={}, system_attrs={}, intermediate_values={}, distributions={&#39;x&#39;: FloatDistribution(high=10.0, log=False, low=-10.0, step=None)}, trial_id=1, value=None)
</pre></div>
</div>
<p>To get the number of trials:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">study</span><span class="o">.</span><span class="n">trials</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>100
</pre></div>
</div>
<p>By executing <a class="reference internal" href="index.html#optuna.study.Study.optimize" title="optuna.study.Study.optimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">optimize()</span></code></a> again, we can continue the optimization.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p>To get the updated number of trials:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">study</span><span class="o">.</span><span class="n">trials</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>200
</pre></div>
</div>
<p>As the objective function is so easy that the last 100 trials don’t improve the result.
However, we can check the result again:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">best_params</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">best_params</span>
<span class="n">found_x</span> <span class="o">=</span> <span class="n">best_params</span><span class="p">[</span><span class="s2">&quot;x&quot;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Found x: </span><span class="si">{}</span><span class="s2">, (x - 2)^2: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">found_x</span><span class="p">,</span> <span class="p">(</span><span class="n">found_x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Found x: 1.9993639369815985, (x - 2)^2: 4.04576163377985e-07
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  1.086 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-tutorial-10-key-features-001-first-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="_downloads/c92b98cc9064d8f189c8c89e61fe9c5a/001_first.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">001_first.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="_downloads/09a922232ee2c9bb3c93aeda0df00ee5/001_first.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">001_first.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>
<span id="document-tutorial/10_key_features/002_configurations"></span><div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-tutorial-10-key-features-002-configurations-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="pythonic-search-space">
<span id="configurations"></span><span id="sphx-glr-tutorial-10-key-features-002-configurations-py"></span><h6>2. Pythonic Search Space<a class="headerlink" href="#pythonic-search-space" title="Permalink to this heading"></a></h6>
<p>For hyperparameter sampling, Optuna provides the following features:</p>
<ul class="simple">
<li><p><a class="reference internal" href="index.html#optuna.trial.Trial.suggest_categorical" title="optuna.trial.Trial.suggest_categorical"><code class="xref py py-func docutils literal notranslate"><span class="pre">optuna.trial.Trial.suggest_categorical()</span></code></a> for categorical parameters</p></li>
<li><p><a class="reference internal" href="index.html#optuna.trial.Trial.suggest_int" title="optuna.trial.Trial.suggest_int"><code class="xref py py-func docutils literal notranslate"><span class="pre">optuna.trial.Trial.suggest_int()</span></code></a> for integer parameters</p></li>
<li><p><a class="reference internal" href="index.html#optuna.trial.Trial.suggest_float" title="optuna.trial.Trial.suggest_float"><code class="xref py py-func docutils literal notranslate"><span class="pre">optuna.trial.Trial.suggest_float()</span></code></a> for floating point parameters</p></li>
</ul>
<p>With optional arguments of <code class="docutils literal notranslate"><span class="pre">step</span></code> and <code class="docutils literal notranslate"><span class="pre">log</span></code>, we can discretize or take the logarithm of
integer and floating point parameters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">optuna</span>


<span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="c1"># Categorical parameter</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_categorical</span><span class="p">(</span><span class="s2">&quot;optimizer&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;MomentumSGD&quot;</span><span class="p">,</span> <span class="s2">&quot;Adam&quot;</span><span class="p">])</span>

    <span class="c1"># Integer parameter</span>
    <span class="n">num_layers</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_int</span><span class="p">(</span><span class="s2">&quot;num_layers&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="c1"># Integer parameter (log)</span>
    <span class="n">num_channels</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_int</span><span class="p">(</span><span class="s2">&quot;num_channels&quot;</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">512</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Integer parameter (discretized)</span>
    <span class="n">num_units</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_int</span><span class="p">(</span><span class="s2">&quot;num_units&quot;</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

    <span class="c1"># Floating point parameter</span>
    <span class="n">dropout_rate</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;dropout_rate&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="c1"># Floating point parameter (log)</span>
    <span class="n">learning_rate</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;learning_rate&quot;</span><span class="p">,</span> <span class="mf">1e-5</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Floating point parameter (discretized)</span>
    <span class="n">drop_path_rate</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;drop_path_rate&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
<section id="defining-parameter-spaces">
<h6 aria-level="7">Defining Parameter Spaces<a class="headerlink" href="#defining-parameter-spaces" title="Permalink to this heading"></a></h6>
<p>In Optuna, we define search spaces using familiar Python syntax including conditionals and loops.</p>
<p>Also, you can use branches or loops depending on the parameter values.</p>
<p>For more various use, see <a class="reference external" href="https://github.com/optuna/optuna-examples/">examples</a>.</p>
<ul class="simple">
<li><p>Branches:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sklearn.ensemble</span>
<span class="kn">import</span> <span class="nn">sklearn.svm</span>


<span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="n">classifier_name</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_categorical</span><span class="p">(</span><span class="s2">&quot;classifier&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;SVC&quot;</span><span class="p">,</span> <span class="s2">&quot;RandomForest&quot;</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">classifier_name</span> <span class="o">==</span> <span class="s2">&quot;SVC&quot;</span><span class="p">:</span>
        <span class="n">svc_c</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;svc_c&quot;</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="mf">1e10</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">classifier_obj</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="n">svc_c</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rf_max_depth</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_int</span><span class="p">(</span><span class="s2">&quot;rf_max_depth&quot;</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">classifier_obj</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">ensemble</span><span class="o">.</span><span class="n">RandomForestClassifier</span><span class="p">(</span><span class="n">max_depth</span><span class="o">=</span><span class="n">rf_max_depth</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Loops:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>


<span class="k">def</span> <span class="nf">create_model</span><span class="p">(</span><span class="n">trial</span><span class="p">,</span> <span class="n">in_size</span><span class="p">):</span>
    <span class="n">n_layers</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_int</span><span class="p">(</span><span class="s2">&quot;n_layers&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="n">layers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_layers</span><span class="p">):</span>
        <span class="n">n_units</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_int</span><span class="p">(</span><span class="s2">&quot;n_units_l</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">128</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_size</span><span class="p">,</span> <span class="n">n_units</span><span class="p">))</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">())</span>
        <span class="n">in_size</span> <span class="o">=</span> <span class="n">n_units</span>
    <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_size</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="o">*</span><span class="n">layers</span><span class="p">)</span>
</pre></div>
</div>
<section id="note-on-the-number-of-parameters">
<h6 aria-level="8">Note on the Number of Parameters<a class="headerlink" href="#note-on-the-number-of-parameters" title="Permalink to this heading"></a></h6>
<p>The difficulty of optimization increases roughly exponentially with regard to the number of parameters. That is, the number of necessary trials increases exponentially when you increase the number of parameters, so it is recommended to not add unimportant parameters.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.001 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-tutorial-10-key-features-002-configurations-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="_downloads/a17fa797645dc8363565ee6a50908e27/002_configurations.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">002_configurations.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="_downloads/4239c2fc38c810c87be56aa03d0933e6/002_configurations.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">002_configurations.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>
</section>
<span id="document-tutorial/10_key_features/003_efficient_optimization_algorithms"></span><div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-tutorial-10-key-features-003-efficient-optimization-algorithms-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="efficient-optimization-algorithms">
<span id="pruning"></span><span id="sphx-glr-tutorial-10-key-features-003-efficient-optimization-algorithms-py"></span><h6>3. Efficient Optimization Algorithms<a class="headerlink" href="#efficient-optimization-algorithms" title="Permalink to this heading"></a></h6>
<p>Optuna enables efficient hyperparameter optimization by
adopting state-of-the-art algorithms for sampling hyperparameters and
pruning efficiently unpromising trials.</p>
<section id="sampling-algorithms">
<h6 aria-level="7">Sampling Algorithms<a class="headerlink" href="#sampling-algorithms" title="Permalink to this heading"></a></h6>
<p>Samplers basically continually narrow down the search space using the records of suggested parameter values and evaluated objective values,
leading to an optimal search space which giving off parameters leading to better objective values.
More detailed explanation of how samplers suggest parameters is in <a class="reference internal" href="index.html#optuna.samplers.BaseSampler" title="optuna.samplers.BaseSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSampler</span></code></a>.</p>
<p>Optuna provides the following sampling algorithms:</p>
<ul class="simple">
<li><p>Grid Search implemented in <a class="reference internal" href="index.html#optuna.samplers.GridSampler" title="optuna.samplers.GridSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">GridSampler</span></code></a></p></li>
<li><p>Random Search implemented in <a class="reference internal" href="index.html#optuna.samplers.RandomSampler" title="optuna.samplers.RandomSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">RandomSampler</span></code></a></p></li>
<li><p>Tree-structured Parzen Estimator algorithm implemented in <a class="reference internal" href="index.html#optuna.samplers.TPESampler" title="optuna.samplers.TPESampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">TPESampler</span></code></a></p></li>
<li><p>CMA-ES based algorithm implemented in <a class="reference internal" href="index.html#optuna.samplers.CmaEsSampler" title="optuna.samplers.CmaEsSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CmaEsSampler</span></code></a></p></li>
<li><p>Algorithm to enable partial fixed parameters implemented in <a class="reference internal" href="index.html#optuna.samplers.PartialFixedSampler" title="optuna.samplers.PartialFixedSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">PartialFixedSampler</span></code></a></p></li>
<li><p>Nondominated Sorting Genetic Algorithm II implemented in <a class="reference internal" href="index.html#optuna.samplers.NSGAIISampler" title="optuna.samplers.NSGAIISampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">NSGAIISampler</span></code></a></p></li>
<li><p>A Quasi Monte Carlo sampling algorithm implemented in <a class="reference internal" href="index.html#optuna.samplers.QMCSampler" title="optuna.samplers.QMCSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">QMCSampler</span></code></a></p></li>
</ul>
<p>The default sampler is <a class="reference internal" href="index.html#optuna.samplers.TPESampler" title="optuna.samplers.TPESampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">TPESampler</span></code></a>.</p>
</section>
<section id="switching-samplers">
<h6 aria-level="7">Switching Samplers<a class="headerlink" href="#switching-samplers" title="Permalink to this heading"></a></h6>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">optuna</span>
</pre></div>
</div>
<p>By default, Optuna uses <a class="reference internal" href="index.html#optuna.samplers.TPESampler" title="optuna.samplers.TPESampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">TPESampler</span></code></a> as follows.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sampler is </span><span class="si">{</span><span class="n">study</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Sampler is TPESampler
</pre></div>
</div>
<p>If you want to use different samplers for example <a class="reference internal" href="index.html#optuna.samplers.RandomSampler" title="optuna.samplers.RandomSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">RandomSampler</span></code></a>
and <a class="reference internal" href="index.html#optuna.samplers.CmaEsSampler" title="optuna.samplers.CmaEsSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CmaEsSampler</span></code></a>,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">sampler</span><span class="o">=</span><span class="n">optuna</span><span class="o">.</span><span class="n">samplers</span><span class="o">.</span><span class="n">RandomSampler</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sampler is </span><span class="si">{</span><span class="n">study</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">sampler</span><span class="o">=</span><span class="n">optuna</span><span class="o">.</span><span class="n">samplers</span><span class="o">.</span><span class="n">CmaEsSampler</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sampler is </span><span class="si">{</span><span class="n">study</span><span class="o">.</span><span class="n">sampler</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Sampler is RandomSampler
Sampler is CmaEsSampler
</pre></div>
</div>
</section>
<section id="pruning-algorithms">
<h6 aria-level="7">Pruning Algorithms<a class="headerlink" href="#pruning-algorithms" title="Permalink to this heading"></a></h6>
<p><code class="docutils literal notranslate"><span class="pre">Pruners</span></code> automatically stop unpromising trials at the early stages of the training (a.k.a., automated early-stopping).</p>
<p>Optuna provides the following pruning algorithms:</p>
<ul class="simple">
<li><p>Median pruning algorithm implemented in <a class="reference internal" href="index.html#optuna.pruners.MedianPruner" title="optuna.pruners.MedianPruner"><code class="xref py py-class docutils literal notranslate"><span class="pre">MedianPruner</span></code></a></p></li>
<li><p>Non-pruning algorithm implemented in <a class="reference internal" href="index.html#optuna.pruners.NopPruner" title="optuna.pruners.NopPruner"><code class="xref py py-class docutils literal notranslate"><span class="pre">NopPruner</span></code></a></p></li>
<li><p>Algorithm to operate pruner with tolerance implemented in <a class="reference internal" href="index.html#optuna.pruners.PatientPruner" title="optuna.pruners.PatientPruner"><code class="xref py py-class docutils literal notranslate"><span class="pre">PatientPruner</span></code></a></p></li>
<li><p>Algorithm to prune specified percentile of trials implemented in <a class="reference internal" href="index.html#optuna.pruners.PercentilePruner" title="optuna.pruners.PercentilePruner"><code class="xref py py-class docutils literal notranslate"><span class="pre">PercentilePruner</span></code></a></p></li>
<li><p>Asynchronous Successive Halving algorithm implemented in <a class="reference internal" href="index.html#optuna.pruners.SuccessiveHalvingPruner" title="optuna.pruners.SuccessiveHalvingPruner"><code class="xref py py-class docutils literal notranslate"><span class="pre">SuccessiveHalvingPruner</span></code></a></p></li>
<li><p>Hyperband algorithm implemented in <a class="reference internal" href="index.html#optuna.pruners.HyperbandPruner" title="optuna.pruners.HyperbandPruner"><code class="xref py py-class docutils literal notranslate"><span class="pre">HyperbandPruner</span></code></a></p></li>
<li><p>Threshold pruning algorithm implemented in <a class="reference internal" href="index.html#optuna.pruners.ThresholdPruner" title="optuna.pruners.ThresholdPruner"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThresholdPruner</span></code></a></p></li>
</ul>
<p>We use <a class="reference internal" href="index.html#optuna.pruners.MedianPruner" title="optuna.pruners.MedianPruner"><code class="xref py py-class docutils literal notranslate"><span class="pre">MedianPruner</span></code></a> in most examples,
though basically it is outperformed by <a class="reference internal" href="index.html#optuna.pruners.SuccessiveHalvingPruner" title="optuna.pruners.SuccessiveHalvingPruner"><code class="xref py py-class docutils literal notranslate"><span class="pre">SuccessiveHalvingPruner</span></code></a> and
<a class="reference internal" href="index.html#optuna.pruners.HyperbandPruner" title="optuna.pruners.HyperbandPruner"><code class="xref py py-class docutils literal notranslate"><span class="pre">HyperbandPruner</span></code></a> as in <a class="reference external" href="https://github.com/optuna/optuna/wiki/Benchmarks-with-Kurobako">this benchmark result</a>.</p>
</section>
<section id="activating-pruners">
<h6 aria-level="7">Activating Pruners<a class="headerlink" href="#activating-pruners" title="Permalink to this heading"></a></h6>
<p>To turn on the pruning feature, you need to call <a class="reference internal" href="index.html#optuna.trial.Trial.report" title="optuna.trial.Trial.report"><code class="xref py py-func docutils literal notranslate"><span class="pre">report()</span></code></a> and <a class="reference internal" href="index.html#optuna.trial.Trial.should_prune" title="optuna.trial.Trial.should_prune"><code class="xref py py-func docutils literal notranslate"><span class="pre">should_prune()</span></code></a> after each step of the iterative training.
<a class="reference internal" href="index.html#optuna.trial.Trial.report" title="optuna.trial.Trial.report"><code class="xref py py-func docutils literal notranslate"><span class="pre">report()</span></code></a> periodically monitors the intermediate objective values.
<a class="reference internal" href="index.html#optuna.trial.Trial.should_prune" title="optuna.trial.Trial.should_prune"><code class="xref py py-func docutils literal notranslate"><span class="pre">should_prune()</span></code></a> decides termination of the trial that does not meet a predefined condition.</p>
<p>We would recommend using integration modules for major machine learning frameworks.
Exclusive list is <a class="reference internal" href="index.html#module-optuna.integration" title="optuna.integration"><code class="xref py py-mod docutils literal notranslate"><span class="pre">integration</span></code></a> and usecases are available in <a class="reference external" href="https://github.com/optuna/optuna-examples/">~optuna/examples</a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">import</span> <span class="nn">sklearn.datasets</span>
<span class="kn">import</span> <span class="nn">sklearn.linear_model</span>
<span class="kn">import</span> <span class="nn">sklearn.model_selection</span>


<span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="n">iris</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">()</span>
    <span class="n">classes</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="p">))</span>
    <span class="n">train_x</span><span class="p">,</span> <span class="n">valid_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">valid_y</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">train_test_split</span><span class="p">(</span>
        <span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span>
    <span class="p">)</span>

    <span class="n">alpha</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="mf">1e-5</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">linear_model</span><span class="o">.</span><span class="n">SGDClassifier</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
        <span class="n">clf</span><span class="o">.</span><span class="n">partial_fit</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="n">classes</span><span class="p">)</span>

        <span class="c1"># Report intermediate objective value.</span>
        <span class="n">intermediate_value</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">valid_x</span><span class="p">,</span> <span class="n">valid_y</span><span class="p">)</span>
        <span class="n">trial</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">intermediate_value</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>

        <span class="c1"># Handle pruning based on the intermediate value.</span>
        <span class="k">if</span> <span class="n">trial</span><span class="o">.</span><span class="n">should_prune</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">optuna</span><span class="o">.</span><span class="n">TrialPruned</span><span class="p">()</span>

    <span class="k">return</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">valid_x</span><span class="p">,</span> <span class="n">valid_y</span><span class="p">)</span>
</pre></div>
</div>
<p>Set up the median stopping rule as the pruning condition.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add stream handler of stdout to show the messages</span>
<span class="n">optuna</span><span class="o">.</span><span class="n">logging</span><span class="o">.</span><span class="n">get_logger</span><span class="p">(</span><span class="s2">&quot;optuna&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">))</span>
<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">pruner</span><span class="o">=</span><span class="n">optuna</span><span class="o">.</span><span class="n">pruners</span><span class="o">.</span><span class="n">MedianPruner</span><span class="p">())</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>A new study created in memory with name: no-name-80e4e039-60b2-49c5-9bb3-8b147645ac35
Trial 0 finished with value: 0.23684210526315785 and parameters: {&#39;alpha&#39;: 0.014093658792264428}. Best is trial 0 with value: 0.23684210526315785.
Trial 1 finished with value: 0.13157894736842102 and parameters: {&#39;alpha&#39;: 0.0026166216353281234}. Best is trial 1 with value: 0.13157894736842102.
Trial 2 finished with value: 0.3421052631578947 and parameters: {&#39;alpha&#39;: 0.00017728573680767575}. Best is trial 1 with value: 0.13157894736842102.
Trial 3 finished with value: 0.07894736842105265 and parameters: {&#39;alpha&#39;: 0.0004980566159174095}. Best is trial 3 with value: 0.07894736842105265.
Trial 4 finished with value: 0.23684210526315785 and parameters: {&#39;alpha&#39;: 0.044886596997974086}. Best is trial 3 with value: 0.07894736842105265.
Trial 5 pruned.
Trial 6 pruned.
Trial 7 pruned.
Trial 8 pruned.
Trial 9 pruned.
Trial 10 pruned.
Trial 11 pruned.
Trial 12 pruned.
Trial 13 pruned.
Trial 14 pruned.
Trial 15 pruned.
Trial 16 pruned.
Trial 17 pruned.
Trial 18 pruned.
Trial 19 finished with value: 0.02631578947368418 and parameters: {&#39;alpha&#39;: 0.0030259129873368485}. Best is trial 19 with value: 0.02631578947368418.
</pre></div>
</div>
<p>As you can see, several trials were pruned (stopped) before they finished all of the iterations.
The format of message is <code class="docutils literal notranslate"><span class="pre">&quot;Trial</span> <span class="pre">&lt;Trial</span> <span class="pre">Number&gt;</span> <span class="pre">pruned.&quot;</span></code>.</p>
</section>
<section id="which-sampler-and-pruner-should-be-used">
<h6 aria-level="7">Which Sampler and Pruner Should be Used?<a class="headerlink" href="#which-sampler-and-pruner-should-be-used" title="Permalink to this heading"></a></h6>
<p>From the benchmark results which are available at <a class="reference external" href="https://github.com/optuna/optuna/wiki/Benchmarks-with-Kurobako">optuna/optuna - wiki “Benchmarks with Kurobako”</a>, at least for not deep learning tasks, we would say that</p>
<ul class="simple">
<li><p>For <a class="reference internal" href="index.html#optuna.samplers.RandomSampler" title="optuna.samplers.RandomSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">RandomSampler</span></code></a>, <a class="reference internal" href="index.html#optuna.pruners.MedianPruner" title="optuna.pruners.MedianPruner"><code class="xref py py-class docutils literal notranslate"><span class="pre">MedianPruner</span></code></a> is the best.</p></li>
<li><p>For <a class="reference internal" href="index.html#optuna.samplers.TPESampler" title="optuna.samplers.TPESampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">TPESampler</span></code></a>, <a class="reference internal" href="index.html#optuna.pruners.HyperbandPruner" title="optuna.pruners.HyperbandPruner"><code class="xref py py-class docutils literal notranslate"><span class="pre">HyperbandPruner</span></code></a> is the best.</p></li>
</ul>
<p>However, note that the benchmark is not deep learning.
For deep learning tasks,
consult the below table.
This table is from the <a class="reference external" href="https://doi.org/10.14923/transinfj.2019JDR0003">Ozaki et al., Hyperparameter Optimization Methods: Overview and Characteristics, in IEICE Trans, Vol.J103-D No.9 pp.615-631, 2020</a> paper,
which is written in Japanese.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parallel Compute Resource</p></th>
<th class="head"><p>Categorical/Conditional Hyperparameters</p></th>
<th class="head"><p>Recommended Algorithms</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="2"><p>Limited</p></td>
<td><p>No</p></td>
<td><p>TPE. GP-EI if search space is low-dimensional and continuous.</p></td>
</tr>
<tr class="row-odd"><td><p>Yes</p></td>
<td><p>TPE. GP-EI if search space is low-dimensional and continuous</p></td>
</tr>
<tr class="row-even"><td rowspan="2"><p>Sufficient</p></td>
<td><p>No</p></td>
<td><p>CMA-ES, Random Search</p></td>
</tr>
<tr class="row-odd"><td><p>Yes</p></td>
<td><p>Random Search or Genetic Algorithm</p></td>
</tr>
</tbody>
</table>
</section>
<section id="integration-modules-for-pruning">
<h6 aria-level="7">Integration Modules for Pruning<a class="headerlink" href="#integration-modules-for-pruning" title="Permalink to this heading"></a></h6>
<p>To implement pruning mechanism in much simpler forms, Optuna provides integration modules for the following libraries.</p>
<p>For the complete list of Optuna’s integration modules, see <a class="reference internal" href="index.html#module-optuna.integration" title="optuna.integration"><code class="xref py py-mod docutils literal notranslate"><span class="pre">integration</span></code></a>.</p>
<p>For example, <a class="reference internal" href="index.html#optuna.integration.XGBoostPruningCallback" title="optuna.integration.XGBoostPruningCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">XGBoostPruningCallback</span></code></a> introduces pruning without directly changing the logic of training iteration.
(See also <a class="reference external" href="https://github.com/optuna/optuna-examples/tree/main/xgboost/xgboost_integration.py">example</a> for the entire script.)</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pruning_callback</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">integration</span><span class="o">.</span><span class="n">XGBoostPruningCallback</span><span class="p">(</span><span class="n">trial</span><span class="p">,</span> <span class="s1">&#39;validation-error&#39;</span><span class="p">)</span>
<span class="n">bst</span> <span class="o">=</span> <span class="n">xgb</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">dtrain</span><span class="p">,</span> <span class="n">evals</span><span class="o">=</span><span class="p">[(</span><span class="n">dvalid</span><span class="p">,</span> <span class="s1">&#39;validation&#39;</span><span class="p">)],</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">pruning_callback</span><span class="p">])</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  1.671 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-tutorial-10-key-features-003-efficient-optimization-algorithms-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="_downloads/d644481a46b46a106b111c67d4186242/003_efficient_optimization_algorithms.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">003_efficient_optimization_algorithms.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="_downloads/6156704970cffef444c9a05792c1ebc2/003_efficient_optimization_algorithms.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">003_efficient_optimization_algorithms.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>
<span id="document-tutorial/10_key_features/004_distributed"></span><div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-tutorial-10-key-features-004-distributed-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="easy-parallelization">
<span id="distributed"></span><span id="sphx-glr-tutorial-10-key-features-004-distributed-py"></span><h6>4. Easy Parallelization<a class="headerlink" href="#easy-parallelization" title="Permalink to this heading"></a></h6>
<p>It’s straightforward to parallelize <a class="reference internal" href="index.html#optuna.study.Study.optimize" title="optuna.study.Study.optimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">optuna.study.Study.optimize()</span></code></a>.</p>
<p>If you want to manually execute Optuna optimization:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>start an RDB server (this example uses MySQL)</p></li>
<li><p>create a study with <code class="docutils literal notranslate"><span class="pre">--storage</span></code> argument</p></li>
<li><p>share the study among multiple nodes and processes</p></li>
</ol>
</div></blockquote>
<p>Of course, you can use Kubernetes as in <a class="reference external" href="https://github.com/optuna/optuna-examples/tree/main/kubernetes">the kubernetes examples</a>.</p>
<p>To just see how parallel optimization works in Optuna, check the below video.</p>
<iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/J_aymk4YXhg?start=427" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe><section id="create-a-study">
<h6 aria-level="7">Create a Study<a class="headerlink" href="#create-a-study" title="Permalink to this heading"></a></h6>
<p>You can create a study using <code class="docutils literal notranslate"><span class="pre">optuna</span> <span class="pre">create-study</span></code> command.
Alternatively, in Python script you can use <a class="reference internal" href="index.html#optuna.create_study" title="optuna.create_study"><code class="xref py py-func docutils literal notranslate"><span class="pre">optuna.create_study()</span></code></a>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>mysql<span class="w"> </span>-u<span class="w"> </span>root<span class="w"> </span>-e<span class="w"> </span><span class="s2">&quot;CREATE DATABASE IF NOT EXISTS example&quot;</span>
$<span class="w"> </span>optuna<span class="w"> </span>create-study<span class="w"> </span>--study-name<span class="w"> </span><span class="s2">&quot;distributed-example&quot;</span><span class="w"> </span>--storage<span class="w"> </span><span class="s2">&quot;mysql://root@localhost/example&quot;</span>
<span class="o">[</span>I<span class="w"> </span><span class="m">2020</span>-07-21<span class="w"> </span><span class="m">13</span>:43:39,642<span class="o">]</span><span class="w"> </span>A<span class="w"> </span>new<span class="w"> </span>study<span class="w"> </span>created<span class="w"> </span>with<span class="w"> </span>name:<span class="w"> </span>distributed-example
</pre></div>
</div>
<p>Then, write an optimization script. Let’s assume that <code class="docutils literal notranslate"><span class="pre">foo.py</span></code> contains the following code.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">optuna</span>


<span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">load_study</span><span class="p">(</span>
        <span class="n">study_name</span><span class="o">=</span><span class="s2">&quot;distributed-example&quot;</span><span class="p">,</span> <span class="n">storage</span><span class="o">=</span><span class="s2">&quot;mysql://root@localhost/example&quot;</span>
    <span class="p">)</span>
    <span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="share-the-study-among-multiple-nodes-and-processes">
<h6 aria-level="7">Share the Study among Multiple Nodes and Processes<a class="headerlink" href="#share-the-study-among-multiple-nodes-and-processes" title="Permalink to this heading"></a></h6>
<p>Finally, run the shared study from multiple processes.
For example, run <code class="docutils literal notranslate"><span class="pre">Process</span> <span class="pre">1</span></code> in a terminal, and do <code class="docutils literal notranslate"><span class="pre">Process</span> <span class="pre">2</span></code> in another one.
They get parameter suggestions based on shared trials’ history.</p>
<p>Process 1:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>python<span class="w"> </span>foo.py
<span class="o">[</span>I<span class="w"> </span><span class="m">2020</span>-07-21<span class="w"> </span><span class="m">13</span>:45:02,973<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">0</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">45</span>.35553104173011<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;x&#39;</span>:<span class="w"> </span><span class="m">8</span>.73465151598285<span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">0</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">45</span>.35553104173011.
<span class="o">[</span>I<span class="w"> </span><span class="m">2020</span>-07-21<span class="w"> </span><span class="m">13</span>:45:04,013<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">2</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">4</span>.6002397305938905<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;x&#39;</span>:<span class="w"> </span><span class="m">4</span>.144816945707463<span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">1</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.028194513284051464.
...
</pre></div>
</div>
<p>Process 2 (the same command as process 1):</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>python<span class="w"> </span>foo.py
<span class="o">[</span>I<span class="w"> </span><span class="m">2020</span>-07-21<span class="w"> </span><span class="m">13</span>:45:03,748<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">1</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.028194513284051464<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;x&#39;</span>:<span class="w"> </span><span class="m">1</span>.8320877810162361<span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">1</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.028194513284051464.
<span class="o">[</span>I<span class="w"> </span><span class="m">2020</span>-07-21<span class="w"> </span><span class="m">13</span>:45:05,783<span class="o">]</span><span class="w"> </span>Trial<span class="w"> </span><span class="m">3</span><span class="w"> </span>finished<span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">24</span>.45966755098074<span class="w"> </span>and<span class="w"> </span>parameters:<span class="w"> </span><span class="o">{</span><span class="s1">&#39;x&#39;</span>:<span class="w"> </span><span class="m">6</span>.945671597566982<span class="o">}</span>.<span class="w"> </span>Best<span class="w"> </span>is<span class="w"> </span>trial<span class="w"> </span><span class="m">1</span><span class="w"> </span>with<span class="w"> </span>value:<span class="w"> </span><span class="m">0</span>.028194513284051464.
...
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">n_trials</span></code> is the number of trials each process will run, not the total number of trials across all processes. For example, the script given above runs 100 trials for each process, 100 trials * 2 processes = 200 trials. <a class="reference internal" href="index.html#optuna.study.MaxTrialsCallback" title="optuna.study.MaxTrialsCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">optuna.study.MaxTrialsCallback</span></code></a> can ensure how many times trials will be performed across all processes.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We do not recommend SQLite for distributed optimizations at scale because it may cause deadlocks and serious performance issues. Please consider to use another database engine like PostgreSQL or MySQL.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please avoid putting the SQLite database on NFS when running distributed optimizations. See also: <a class="reference external" href="https://www.sqlite.org/faq.html#q5">https://www.sqlite.org/faq.html#q5</a></p>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.000 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-tutorial-10-key-features-004-distributed-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="_downloads/88561a374e0349ac0de9f630e42a4741/004_distributed.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">004_distributed.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="_downloads/08c086493809e0245421fbbf4cefdd32/004_distributed.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">004_distributed.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>
<span id="document-tutorial/10_key_features/005_visualization"></span><div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-tutorial-10-key-features-005-visualization-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="quick-visualization-for-hyperparameter-optimization-analysis">
<span id="visualization"></span><span id="sphx-glr-tutorial-10-key-features-005-visualization-py"></span><h6>5. Quick Visualization for Hyperparameter Optimization Analysis<a class="headerlink" href="#quick-visualization-for-hyperparameter-optimization-analysis" title="Permalink to this heading"></a></h6>
<p>Optuna provides various visualization features in <a class="reference internal" href="index.html#module-optuna.visualization" title="optuna.visualization"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optuna.visualization</span></code></a> to analyze optimization results visually.</p>
<p>This tutorial walks you through this module by visualizing the history of lightgbm model for breast cancer dataset.</p>
<p>For visualizing multi-objective optimization (i.e., the usage of <a class="reference internal" href="index.html#optuna.visualization.plot_pareto_front" title="optuna.visualization.plot_pareto_front"><code class="xref py py-func docutils literal notranslate"><span class="pre">optuna.visualization.plot_pareto_front()</span></code></a>),
please refer to the tutorial of <a class="reference internal" href="index.html#multi-objective"><span class="std std-ref">Multi-objective Optimization with Optuna</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>By using <a class="reference external" href="https://github.com/optuna/optuna-dashboard">Optuna Dashboard</a>, you can also check the optimization history,
hyperparameter importances, hyperparameter relationships, etc. in graphs and tables.
Please make your study persistent using <a class="reference internal" href="index.html#rdb"><span class="std std-ref">RDB backend</span></a> and execute following commands to run Optuna Dashboard.</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>pip<span class="w"> </span>install<span class="w"> </span>optuna-dashboard
<span class="gp">$ </span>optuna-dashboard<span class="w"> </span>sqlite:///example-study.db
</pre></div>
</div>
<p>Please check out <a class="reference external" href="https://github.com/optuna/optuna-dashboard">the GitHub repository</a> for more details.</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Manage Studies</p></th>
<th class="head"><p>Visualize with Interactive Graphs</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><img alt="https://user-images.githubusercontent.com/5564044/205545958-305f2354-c7cd-4687-be2f-9e46e7401838.gif" src="https://user-images.githubusercontent.com/5564044/205545958-305f2354-c7cd-4687-be2f-9e46e7401838.gif" />
</td>
<td><img alt="https://user-images.githubusercontent.com/5564044/205545965-278cd7f4-da7d-4e2e-ac31-6d81b106cada.gif" src="https://user-images.githubusercontent.com/5564044/205545965-278cd7f4-da7d-4e2e-ac31-6d81b106cada.gif" />
</td>
</tr>
</tbody>
</table>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">lightgbm</span> <span class="k">as</span> <span class="nn">lgb</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sklearn.datasets</span>
<span class="kn">import</span> <span class="nn">sklearn.metrics</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="kn">import</span> <span class="nn">optuna</span>

<span class="c1"># You can use Matplotlib instead of Plotly for visualization by simply replacing `optuna.visualization` with</span>
<span class="c1"># `optuna.visualization.matplotlib` in the following examples.</span>
<span class="kn">from</span> <span class="nn">optuna.visualization</span> <span class="kn">import</span> <span class="n">plot_contour</span>
<span class="kn">from</span> <span class="nn">optuna.visualization</span> <span class="kn">import</span> <span class="n">plot_edf</span>
<span class="kn">from</span> <span class="nn">optuna.visualization</span> <span class="kn">import</span> <span class="n">plot_intermediate_values</span>
<span class="kn">from</span> <span class="nn">optuna.visualization</span> <span class="kn">import</span> <span class="n">plot_optimization_history</span>
<span class="kn">from</span> <span class="nn">optuna.visualization</span> <span class="kn">import</span> <span class="n">plot_parallel_coordinate</span>
<span class="kn">from</span> <span class="nn">optuna.visualization</span> <span class="kn">import</span> <span class="n">plot_param_importances</span>
<span class="kn">from</span> <span class="nn">optuna.visualization</span> <span class="kn">import</span> <span class="n">plot_slice</span>

<span class="n">SEED</span> <span class="o">=</span> <span class="mi">42</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">SEED</span><span class="p">)</span>
</pre></div>
</div>
<p>Define the objective function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">train_x</span><span class="p">,</span> <span class="n">valid_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">valid_y</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
    <span class="n">dtrain</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">train_y</span><span class="p">)</span>
    <span class="n">dvalid</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">valid_x</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">valid_y</span><span class="p">)</span>

    <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;objective&quot;</span><span class="p">:</span> <span class="s2">&quot;binary&quot;</span><span class="p">,</span>
        <span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="s2">&quot;auc&quot;</span><span class="p">,</span>
        <span class="s2">&quot;verbosity&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;boosting_type&quot;</span><span class="p">:</span> <span class="s2">&quot;gbdt&quot;</span><span class="p">,</span>
        <span class="s2">&quot;bagging_fraction&quot;</span><span class="p">:</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;bagging_fraction&quot;</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span>
        <span class="s2">&quot;bagging_freq&quot;</span><span class="p">:</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_int</span><span class="p">(</span><span class="s2">&quot;bagging_freq&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
        <span class="s2">&quot;min_child_samples&quot;</span><span class="p">:</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_int</span><span class="p">(</span><span class="s2">&quot;min_child_samples&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="p">}</span>

    <span class="c1"># Add a callback for pruning.</span>
    <span class="n">pruning_callback</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">integration</span><span class="o">.</span><span class="n">LightGBMPruningCallback</span><span class="p">(</span><span class="n">trial</span><span class="p">,</span> <span class="s2">&quot;auc&quot;</span><span class="p">)</span>
    <span class="n">gbm</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">dtrain</span><span class="p">,</span> <span class="n">valid_sets</span><span class="o">=</span><span class="p">[</span><span class="n">dvalid</span><span class="p">],</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">pruning_callback</span><span class="p">])</span>

    <span class="n">preds</span> <span class="o">=</span> <span class="n">gbm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">valid_x</span><span class="p">)</span>
    <span class="n">pred_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">valid_y</span><span class="p">,</span> <span class="n">pred_labels</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">accuracy</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span>
    <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;maximize&quot;</span><span class="p">,</span>
    <span class="n">sampler</span><span class="o">=</span><span class="n">optuna</span><span class="o">.</span><span class="n">samplers</span><span class="o">.</span><span class="n">TPESampler</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">SEED</span><span class="p">),</span>
    <span class="n">pruner</span><span class="o">=</span><span class="n">optuna</span><span class="o">.</span><span class="n">pruners</span><span class="o">.</span><span class="n">MedianPruner</span><span class="p">(</span><span class="n">n_warmup_steps</span><span class="o">=</span><span class="mi">10</span><span class="p">),</span>
<span class="p">)</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
</pre></div>
</div>
<section id="plot-functions">
<h6 aria-level="7">Plot functions<a class="headerlink" href="#plot-functions" title="Permalink to this heading"></a></h6>
<p>Visualize the optimization history. See <a class="reference internal" href="index.html#optuna.visualization.plot_optimization_history" title="optuna.visualization.plot_optimization_history"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_optimization_history()</span></code></a> for the details.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_optimization_history</span><span class="p">(</span><span class="n">study</span><span class="p">)</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-2.18.2.min.js"></script>                <div id="d2dc763f-7333-45f1-ab6b-406049418668" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("d2dc763f-7333-45f1-ab6b-406049418668")) {                    Plotly.newPlot(                        "d2dc763f-7333-45f1-ab6b-406049418668",                        [{"mode":"markers","name":"Objective Value","x":[0,1,2,3,4,5,12,18,25,44,55,82],"y":[0.972027972027972,0.972027972027972,0.958041958041958,0.9790209790209791,0.958041958041958,0.993006993006993,0.986013986013986,0.986013986013986,0.9790209790209791,0.986013986013986,0.986013986013986,0.9790209790209791],"type":"scatter"},{"name":"Best Value","x":[0,1,2,3,4,5,12,18,25,44,55,82],"y":[0.972027972027972,0.972027972027972,0.972027972027972,0.9790209790209791,0.9790209790209791,0.993006993006993,0.993006993006993,0.993006993006993,0.993006993006993,0.993006993006993,0.993006993006993,0.993006993006993],"type":"scatter"}],                        {"title":{"text":"Optimization History Plot"},"xaxis":{"title":{"text":"Trial"}},"yaxis":{"title":{"text":"Objective Value"}},"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}}},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
<br />
<br /><p>Visualize the learning curves of the trials. See <a class="reference internal" href="index.html#optuna.visualization.plot_intermediate_values" title="optuna.visualization.plot_intermediate_values"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_intermediate_values()</span></code></a> for the details.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_intermediate_values</span><span class="p">(</span><span class="n">study</span><span class="p">)</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-2.18.2.min.js"></script>                <div id="c05a6b3b-306e-4e2e-a1bb-67ca425a8d9b" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("c05a6b3b-306e-4e2e-a1bb-67ca425a8d9b")) {                    Plotly.newPlot(                        "c05a6b3b-306e-4e2e-a1bb-67ca425a8d9b",                        [{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial0","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[0.9527673741156887,0.9534956304619226,0.9534956304619226,0.9675405742821473,0.9675405742821473,0.9882438618393674,0.9863712026633374,0.9884519350811486,0.9901165210153974,0.9888680815647107,0.990220557636288,0.9891801914273824,0.990220557636288,0.9906367041198502,0.9916770703287557,0.992093216812318,0.9924053266749896,0.993237619642114,0.993237619642114,0.993237619642114,0.9931335830212235,0.9937578027465668,0.994173949230129,0.9937578027465668,0.9943820224719101,0.9937578027465668,0.9943820224719101,0.9952143154390345,0.9956304619225967,0.9956304619225967,0.9958385351643778,0.9958385351643778,0.996046608406159,0.996046608406159,0.996046608406159,0.9962546816479401,0.9958385351643778,0.9958385351643778,0.9958385351643778,0.9956304619225967,0.9956304619225967,0.9956304619225967,0.9958385351643778,0.996046608406159,0.9958385351643778,0.9956304619225967,0.996046608406159,0.9958385351643778,0.9956304619225967,0.996046608406159,0.9958385351643778,0.9958385351643778,0.9958385351643778,0.996046608406159,0.996046608406159,0.996046608406159,0.996046608406159,0.9962546816479401,0.9962546816479401,0.9956304619225967,0.9956304619225967,0.996046608406159,0.996046608406159,0.9964627548897211,0.9964627548897211,0.9966708281315023,0.9964627548897211,0.9970869746150645,0.9970869746150645,0.9970869746150645,0.9970869746150645,0.9970869746150645,0.9970869746150645,0.9970869746150645,0.9970869746150645,0.9970869746150645,0.9970869746150645,0.9970869746150645,0.9970869746150645,0.9970869746150645,0.9970869746150645,0.9968789013732834,0.9968789013732834,0.9966708281315023,0.9964627548897211,0.996046608406159,0.996046608406159,0.9956304619225967,0.9956304619225967,0.9958385351643778,0.9956304619225967,0.9952143154390345,0.9950062421972534,0.9952143154390345,0.9956304619225967,0.9950062421972534,0.9954223886808157,0.9950062421972534,0.9954223886808157,0.9954223886808157],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial1","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[0.9746376811594203,0.9822037510656436,0.985080988917306,0.9860400682011935,0.9888107416879796,0.9905157715260017,0.9921142369991475,0.9928601875532822,0.9928601875532822,0.993925831202046,0.994458653026428,0.9946717817561808,0.9946717817561808,0.9948849104859335,0.9948849104859335,0.9953111679454391,0.9953111679454391,0.9955242966751918,0.9961636828644501,0.9961636828644501,0.9957374254049446,0.9955242966751918,0.9955242966751918,0.9959505541346974,0.9963768115942029,0.9961636828644501,0.9963768115942029,0.9968030690537084,0.9970161977834612,0.9974424552429667,0.9974424552429667,0.9968030690537084,0.9972293265132139,0.9974424552429667,0.9972293265132139,0.9972293265132139,0.9974424552429667,0.9976555839727195,0.9976555839727195,0.9976555839727195,0.9976555839727195,0.9972293265132139,0.9974424552429667,0.9974424552429667,0.9974424552429667,0.9972293265132139,0.9970161977834612,0.9972293265132139,0.9970161977834612,0.9970161977834612,0.9974424552429667,0.9972293265132139,0.9968030690537084,0.9968030690537084,0.9968030690537084,0.9974424552429667,0.9970161977834612,0.9972293265132139,0.9974424552429667,0.9974424552429667,0.9974424552429667,0.9974424552429667,0.9972293265132139,0.9972293265132139,0.9972293265132139,0.9972293265132139,0.9972293265132139,0.9970161977834612,0.9974424552429667,0.9974424552429667,0.9978687127024722,0.9978687127024722,0.9978687127024722,0.9978687127024722,0.9978687127024722,0.9980818414322251,0.9978687127024722,0.9978687127024722,0.9978687127024722,0.9980818414322251,0.9978687127024722,0.9978687127024722,0.9978687127024722,0.9978687127024722,0.9978687127024722,0.9976555839727195,0.9974424552429667,0.9978687127024722,0.9980818414322251,0.9982949701619779,0.9980818414322251,0.9980818414322251,0.9982949701619779,0.9980818414322251,0.9980818414322251,0.9980818414322251,0.9978687127024722,0.9978687127024722,0.9978687127024722,0.9978687127024722],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial2","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[0.8978858784893268,0.9536124794745484,0.9613095238095238,0.9727011494252874,0.972495894909688,0.9770114942528736,0.9778325123152709,0.9762931034482759,0.9767036124794746,0.9779351395730707,0.979371921182266,0.9811165845648604,0.9819376026272578,0.9828612479474549,0.9846059113300493,0.9835796387520526,0.9848111658456487,0.9846059113300493,0.986863711001642,0.9866584564860427,0.9863505747126436,0.9847085385878489,0.9838875205254516,0.9836822660098522,0.9834770114942529,0.9824507389162561,0.9818349753694581,0.9818349753694581,0.9818349753694581,0.9816297208538588,0.9814244663382594,0.9812192118226601,0.9814244663382594,0.9820402298850575,0.9823481116584565,0.9823481116584565,0.9821428571428571,0.9821428571428571,0.9813218390804598,0.9809113300492611,0.9809113300492611,0.9809113300492611,0.9800903119868637,0.9800903119868637,0.9805008210180624,0.9800903119868637,0.9802955665024631,0.9805008210180624,0.979679802955665,0.9798850574712644,0.979679802955665,0.9798850574712644,0.9802955665024631,0.9802955665024631,0.9802955665024631,0.9813218390804598,0.9819376026272578,0.9823481116584565,0.9825533661740559,0.9833743842364532,0.9831691297208539,0.9835796387520526,0.9841954022988506,0.9837848932676518,0.9835796387520526,0.9829638752052545,0.9831691297208539,0.9829638752052545,0.9825533661740559,0.9821428571428571,0.9827586206896551,0.9823481116584565,0.9829638752052545,0.9831691297208539,0.9829638752052545,0.9829638752052545,0.9831691297208539,0.9835796387520526,0.9844006568144499,0.9850164203612479,0.9844006568144499,0.9844006568144499,0.9837848932676518,0.9835796387520526,0.9835796387520526,0.9837848932676518,0.9837848932676518,0.9833743842364532,0.9837848932676518,0.9839901477832512,0.9833743842364532,0.9827586206896551,0.9827586206896551,0.9827586206896551,0.9823481116584565,0.9823481116584565,0.9829638752052545,0.9829638752052545,0.9829638752052545,0.9829638752052545],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial3","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[0.9180191427382438,0.9369538077403246,0.9660840615896795,0.9683728672492717,0.9682688306283812,0.9771119434040783,0.9812734082397003,0.9827299209321682,0.9850187265917603,0.9857469829379941,0.9842904702455264,0.9846025801081981,0.9860590928006658,0.9868913857677902,0.9885559717020391,0.9881398252184769,0.9875156054931336,0.9864752392842281,0.9887640449438202,0.9893882646691635,0.9900124843945068,0.990220557636288,0.9906367041198502,0.9910528506034124,0.9912609238451935,0.9918851435705368,0.992093216812318,0.9931335830212235,0.9939658759883478,0.9939658759883478,0.9939658759883478,0.9947981689554724,0.9947981689554724,0.9952143154390345,0.9954223886808157,0.9962546816479401,0.9962546816479401,0.996046608406159,0.9958385351643778,0.9962546816479401,0.9958385351643778,0.9958385351643778,0.9958385351643778,0.9964627548897211,0.9962546816479401,0.9964627548897211,0.9968789013732834,0.9970869746150645,0.9972950478568456,0.9968789013732834,0.9972950478568456,0.9970869746150645,0.9968789013732834,0.9970869746150645,0.9966708281315023,0.9970869746150645,0.9972950478568456,0.9972950478568456,0.9975031210986267,0.9975031210986267,0.9975031210986267,0.9977111943404078,0.9977111943404078,0.99812734082397,0.99812734082397,0.9983354140657511,0.9983354140657511,0.9983354140657511,0.9983354140657511,0.9983354140657511,0.9983354140657511,0.99812734082397,0.99812734082397,0.99812734082397,0.99812734082397,0.99812734082397,0.99812734082397,0.99812734082397,0.99812734082397,0.997919267582189,0.997919267582189,0.997919267582189,0.997919267582189,0.99812734082397,0.99812734082397,0.99812734082397,0.9983354140657511,0.9983354140657511,0.99812734082397,0.99812734082397,0.99812734082397,0.9985434873075323,0.9985434873075323,0.9985434873075323,0.9985434873075323,0.9985434873075323,0.9985434873075323,0.9987515605493134,0.9987515605493134,0.9987515605493134],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial4","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[0.9710743801652892,0.9729338842975207,0.9694214876033058,0.9693181818181819,0.9724173553719008,0.9733471074380166,0.9737603305785124,0.9735537190082645,0.9725206611570248,0.9725206611570248,0.9723140495867768,0.9723140495867768,0.9861570247933884,0.9878099173553719,0.987603305785124,0.9888429752066116,0.9880165289256199,0.9880165289256199,0.9913223140495868,0.9917355371900827,0.9915289256198347,0.9911157024793389,0.990909090909091,0.9902892561983471,0.9900826446280991,0.9898760330578512,0.9911157024793389,0.9907024793388429,0.9902892561983471,0.9898760330578512,0.990909090909091,0.9911157024793389,0.990909090909091,0.9915289256198347,0.9913223140495868,0.990495867768595,0.9898760330578512,0.9900826446280991,0.9913223140495868,0.9921487603305785,0.9913223140495868,0.9911157024793389,0.9919421487603306,0.9927685950413223,0.9923553719008265,0.9931818181818182,0.9929752066115702,0.9931818181818182,0.993595041322314,0.993595041322314,0.993595041322314,0.993595041322314,0.993595041322314,0.9933884297520661,0.9929752066115702,0.9927685950413223,0.9929752066115702,0.9931818181818182,0.9929752066115702,0.9927685950413223,0.9925619834710744,0.9925619834710744,0.9923553719008265,0.9921487603305785,0.9921487603305785,0.9919421487603306,0.9917355371900827,0.9915289256198347,0.9913223140495868,0.9911157024793389,0.9917355371900827,0.9921487603305785,0.9921487603305785,0.9919421487603306,0.9919421487603306,0.9923553719008265,0.9919421487603306,0.9917355371900827,0.9917355371900827,0.9921487603305785,0.9919421487603306,0.9917355371900827,0.9917355371900827,0.9919421487603306,0.9915289256198347,0.9913223140495868,0.9915289256198347,0.9915289256198347,0.9915289256198347,0.9913223140495868,0.990909090909091,0.9907024793388429,0.9902892561983471,0.9902892561983471,0.9902892561983471,0.9907024793388429,0.9913223140495868,0.9919421487603306,0.9921487603305785,0.9919421487603306],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial5","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[0.9682389937106918,0.9818658280922432,0.9832285115303984,0.9819706498951782,0.9788259958071279,0.990880503144654,0.9917190775681342,0.9941299790356394,0.9945492662473795,0.9949685534591195,0.9958071278825996,0.9962264150943396,0.9966457023060796,0.9968553459119497,0.9974842767295597,0.9968553459119497,0.9964360587002097,0.9964360587002097,0.9966457023060796,0.9968553459119497,0.9974842767295597,0.9981132075471698,0.9983228511530399,0.9983228511530399,0.9983228511530399,0.9983228511530399,0.9985324947589098,0.9987421383647799,0.9987421383647799,0.9985324947589098,0.9985324947589098,0.9985324947589098,0.9985324947589098,0.9989517819706499,0.9991614255765199,0.9991614255765199,0.9991614255765199,0.9991614255765199,0.9991614255765199,0.9991614255765199,0.9991614255765199,0.9993710691823899,0.9989517819706499,0.9989517819706499,0.9989517819706499,0.9989517819706499,0.9991614255765199,0.9991614255765199,0.9991614255765199,0.9989517819706499,0.9989517819706499,0.9989517819706499,0.9989517819706499,0.9989517819706499,0.9991614255765199,0.9993710691823899,0.9993710691823899,0.9993710691823899,0.9993710691823899,0.9991614255765199,0.9993710691823899,0.9993710691823899,0.9993710691823899,0.9993710691823899,0.9993710691823899,0.9993710691823899,0.9993710691823899,0.9993710691823899,0.9993710691823899,0.9993710691823899,0.9993710691823899,0.9993710691823899,0.9993710691823899,0.9993710691823899,0.9993710691823899,0.9991614255765199,0.9989517819706499,0.9989517819706499,0.9991614255765199,0.9993710691823899,0.9993710691823899,0.9993710691823899,0.9993710691823899,0.9993710691823899,0.99958071278826,0.99958071278826,0.99958071278826,0.99958071278826,0.99958071278826,0.99958071278826,0.9997903563941299,0.9997903563941299,0.9997903563941299,0.99958071278826,0.99958071278826,0.99958071278826,0.99958071278826,0.9997903563941299,0.99958071278826,0.99958071278826],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial6","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.937061403508772,0.9438596491228071,0.9685307017543859,0.9671052631578947,0.9805921052631579,0.9850877192982456,0.9838815789473684,0.9867324561403509,0.9868421052631579,0.9846491228070176,0.9861842105263158],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial7","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9564516129032258,0.974516129032258,0.9751612903225807,0.9709677419354839,0.9690322580645161,0.9689247311827957,0.9713978494623656,0.9729032258064516,0.9735483870967742,0.9746236559139785,0.9739784946236559],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial8","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],"y":[0.9660303776683087,0.9689039408866995,0.9707512315270936,0.9705459770114943,0.9709564860426929,0.9833743842364532,0.9827586206896551,0.9874794745484401,0.9887110016420362,0.9895320197044335,0.9885057471264368,0.9866584564860427,0.9883004926108374,0.9889162561576355,0.9883004926108374],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial9","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18],"y":[0.9431444991789819,0.9674671592775042,0.9916871921182266,0.9911740558292282,0.9899425287356322,0.9889162561576355,0.9880952380952381,0.9870689655172413,0.9864532019704434,0.9860426929392446,0.9854269293924466,0.9850164203612479,0.9866584564860427,0.9870689655172413,0.9878899835796388,0.986863711001642,0.986863711001642,0.986863711001642,0.9866584564860427],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial10","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28],"y":[0.9515532544378699,0.9765779092702169,0.9738658777120316,0.9776873767258383,0.9875493096646942,0.9885355029585798,0.9927268244575936,0.9924802761341223,0.9919871794871795,0.9932199211045365,0.9932199211045365,0.9942061143984221,0.9944526627218935,0.9939595660749507,0.9934664694280079,0.9924802761341223,0.9922337278106509,0.9912475345167653,0.9914940828402367,0.9912475345167653,0.9907544378698225,0.990507889546351,0.9900147928994083,0.9895216962524654,0.9902613412228797,0.9916173570019724,0.992603550295858,0.9930966469428008,0.9928500986193294],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial11","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9044624746450304,0.943002028397566,0.9692697768762677,0.9774847870182556,0.9818458417849899,0.981237322515213,0.9797160243407708,0.9807302231237323,0.9795131845841785,0.9817444219066938,0.981947261663286],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial12","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[0.9467178175618073,0.9854006820119352,0.9854006820119352,0.9859335038363172,0.9909420289855072,0.9952046035805626,0.9969096334185849,0.9969096334185849,0.9969096334185849,0.9970161977834612,0.9974424552429667,0.9978687127024722,0.9972293265132139,0.9984015345268542,0.9973358908780904,0.9981884057971014,0.9978687127024722,0.9985080988917306,0.9980818414322251,0.9978687127024722,0.9985080988917306,0.9985080988917306,0.9989343563512362,0.9987212276214834,0.9989343563512362,0.9991474850809889,0.9991474850809889,0.9991474850809889,0.9993606138107417,0.9993606138107417,0.9993606138107417,0.9993606138107417,0.9993606138107417,0.9993606138107417,0.9993606138107417,0.9993606138107417,0.9993606138107417,0.9993606138107417,0.9991474850809889,0.9991474850809889,0.9991474850809889,0.9993606138107417,0.9993606138107417,0.9991474850809889,0.9991474850809889,0.9991474850809889,0.9991474850809889,0.9993606138107417,0.9991474850809889,0.9989343563512362,0.9991474850809889,0.9993606138107417,0.9993606138107417,0.9993606138107417,0.9993606138107417,0.9993606138107417,0.9993606138107417,0.9991474850809889,0.9991474850809889,0.9989343563512362,0.9991474850809889,0.9991474850809889,0.9989343563512362,0.9991474850809889,0.9993606138107417,0.9993606138107417,0.9991474850809889,0.9991474850809889,0.9989343563512362,0.9991474850809889,0.9991474850809889,0.9989343563512362,0.9989343563512362,0.9989343563512362,0.9989343563512362,0.9989343563512362,0.9989343563512362,0.9989343563512362,0.9989343563512362,0.9989343563512362,0.9987212276214834,0.9987212276214834,0.9987212276214834,0.9987212276214834,0.9987212276214834,0.9987212276214834,0.9987212276214834,0.9987212276214834,0.9987212276214834,0.9987212276214834,0.9987212276214834,0.9987212276214834,0.9987212276214834,0.9987212276214834,0.9987212276214834,0.9987212276214834,0.9987212276214834,0.9989343563512362,0.9989343563512362,0.9989343563512362],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial13","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9495698924731183,0.9704301075268817,0.9721505376344086,0.9690322580645161,0.9710752688172043,0.9697849462365591,0.9762365591397849,0.9775268817204301,0.979247311827957,0.9780645161290322,0.9790322580645161],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial14","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9078313253012048,0.9142570281124498,0.9559236947791164,0.9569277108433735,0.9617469879518072,0.981425702811245,0.9812248995983935,0.9794176706827309,0.9837349397590361,0.9843373493975903,0.9847389558232932],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial15","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9660215053763441,0.9743010752688172,0.9843010752688172,0.9847311827956989,0.9808602150537634,0.9772043010752688,0.9805376344086022,0.9766666666666667,0.9776344086021506,0.9782795698924731,0.9780645161290322],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial16","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.8978858784893268,0.9682881773399015,0.9735221674876847,0.9757799671592775,0.9764983579638752,0.9780377668308703,0.9772167487684729,0.9772167487684729,0.9785509031198686,0.9838875205254516,0.9834770114942529],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial17","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.972920892494929,0.9621703853955376,0.9609533468559838,0.9663286004056795,0.9675456389452333,0.9667342799188641,0.9689655172413794,0.9697768762677484,0.9699797160243407,0.9807302231237323,0.9809330628803246],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial18","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[0.9698082415340677,0.9882700938392492,0.9882700938392492,0.9912280701754386,0.9961240310077519,0.996328029375765,0.996532027743778,0.9971440228478172,0.9971440228478172,0.9971440228478172,0.9969400244798041,0.9969400244798041,0.9973480212158303,0.9971440228478172,0.9977560179518564,0.9981640146878825,0.9983680130558955,0.9987760097919217,0.9991840065279478,0.9991840065279478,0.9987760097919217,0.9989800081599347,0.9989800081599347,0.9991840065279478,0.9991840065279478,0.9989800081599347,0.9989800081599347,0.9989800081599347,0.9989800081599347,0.9993880048959608,0.9995920032639739,0.9991840065279478,0.9991840065279478,0.9991840065279478,0.9991840065279478,0.9991840065279478,0.9991840065279478,0.9993880048959608,0.9993880048959608,0.9993880048959608,0.9993880048959608,0.9993880048959608,0.9993880048959608,0.9993880048959608,0.9993880048959608,0.9993880048959608,0.9993880048959608,0.9993880048959608,0.9993880048959608,0.9993880048959608,0.9993880048959608,0.9993880048959608,0.9993880048959608,0.9995920032639739,0.9995920032639739,0.9995920032639739,0.9995920032639739,0.9995920032639739,0.9995920032639739,0.9993880048959608,0.9997960016319869,0.9993880048959608,0.9993880048959608,0.9993880048959608,0.9993880048959608,0.9995920032639739,0.9993880048959608,0.9993880048959608,0.9993880048959608,0.9993880048959608,0.9993880048959608,0.9993880048959608,0.9993880048959608,0.9993880048959608,0.9993880048959608,0.9991840065279478,0.9993880048959608,0.9991840065279478,0.9991840065279478,0.9991840065279478,0.9991840065279478,0.9991840065279478,0.9991840065279478,0.9991840065279478,0.9991840065279478,0.9991840065279478,0.9991840065279478,0.9991840065279478,0.9989800081599347,0.9991840065279478,0.9991840065279478,0.9991840065279478,0.9991840065279478,0.9989800081599347,0.9989800081599347,0.9989800081599347,0.9989800081599347,0.9989800081599347,0.9989800081599347,0.9989800081599347],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial19","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9108056265984654,0.953537936913896,0.953537936913896,0.9585464620630861,0.9574808184143222,0.9555626598465473,0.9628090366581415,0.9630221653878943,0.9629156010230179,0.9631287297527706,0.9695225916453538],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial20","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.8621514773200166,0.938722430295464,0.938722430295464,0.938722430295464,0.951310861423221,0.9526633374947981,0.9528714107365793,0.9624427798585102,0.9624427798585102,0.9634831460674157,0.965980024968789],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial21","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70],"y":[0.9760715771951727,0.9810653349979193,0.9909488139825219,0.9923012900540991,0.9927174365376612,0.9926133999167707,0.992093216812318,0.9925093632958801,0.992093216812318,0.9923012900540991,0.9925093632958801,0.9924053266749896,0.9925093632958801,0.9933416562630045,0.9929255097794424,0.994173949230129,0.9945900957136912,0.9950062421972534,0.9950062421972534,0.9950062421972534,0.9950062421972534,0.9956304619225967,0.996046608406159,0.9958385351643778,0.9964627548897211,0.9968789013732834,0.9968789013732834,0.9970869746150645,0.9975031210986267,0.9975031210986267,0.9975031210986267,0.9975031210986267,0.9975031210986267,0.9977111943404078,0.9977111943404078,0.9977111943404078,0.997919267582189,0.997919267582189,0.997919267582189,0.997919267582189,0.997919267582189,0.997919267582189,0.997919267582189,0.997919267582189,0.997919267582189,0.997919267582189,0.997919267582189,0.997919267582189,0.997919267582189,0.997919267582189,0.997919267582189,0.997919267582189,0.997919267582189,0.9977111943404078,0.9977111943404078,0.9975031210986267,0.9977111943404078,0.9975031210986267,0.9977111943404078,0.9977111943404078,0.9975031210986267,0.9975031210986267,0.9975031210986267,0.9975031210986267,0.9975031210986267,0.9975031210986267,0.9972950478568456,0.9972950478568456,0.9975031210986267,0.9975031210986267,0.9975031210986267],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial22","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9531746031746032,0.948015873015873,0.971031746031746,0.9743055555555555,0.9754960317460317,0.9753968253968254,0.9742063492063492,0.9736111111111111,0.975,0.9748015873015873,0.9757936507936508],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial23","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9519916142557652,0.9626834381551362,0.9657232704402515,0.9759958071278826,0.9720125786163522,0.9740041928721174,0.9721174004192872,0.9722222222222222,0.9737945492662474,0.9730607966457023,0.9788259958071279],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial24","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9619611158072696,0.9630177514792899,0.9635460693153001,0.9684065934065934,0.9822485207100592,0.985207100591716,0.9842561284868977,0.9808748943364328,0.9796069315300084,0.9842561284868977,0.9867920540997465],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial25","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[0.9952451394759088,0.9952451394759088,0.9951394759087067,0.9975697379543533,0.9976754015215553,0.9983093829247676,0.9980980557903635,0.9978867286559594,0.9978867286559594,0.9972527472527473,0.9972527472527473,0.9980980557903635,0.9980980557903635,0.9980980557903635,0.9983093829247676,0.9983093829247676,0.9985207100591716,0.9987320371935756,0.9987320371935756,0.9991546914623838,0.9989433643279797,0.9989433643279797,0.9989433643279797,0.9989433643279797,0.9991546914623838,0.9991546914623838,0.9991546914623838,0.9991546914623838,0.9989433643279797,0.9989433643279797,0.9989433643279797,0.9989433643279797,0.9991546914623838,0.9989433643279797,0.9989433643279797,0.9989433643279797,0.9989433643279797,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9989433643279797,0.9989433643279797,0.9989433643279797,0.9989433643279797,0.9989433643279797,0.9989433643279797,0.9989433643279797,0.9989433643279797,0.9989433643279797,0.9989433643279797,0.9989433643279797,0.9989433643279797,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9989433643279797,0.9989433643279797,0.9989433643279797,0.9989433643279797,0.9989433643279797,0.9987320371935756,0.9989433643279797,0.9989433643279797,0.9989433643279797,0.9989433643279797,0.9989433643279797,0.9989433643279797,0.9989433643279797,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756,0.9987320371935756],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial26","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9626506024096385,0.9883534136546185,0.986144578313253,0.989558232931727,0.9886546184738956,0.9910642570281124,0.9909638554216867,0.9897590361445783,0.9913654618473896,0.9907630522088353,0.989558232931727],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial27","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9774793388429752,0.984607438016529,0.9873966942148761,0.9886363636363636,0.9883264462809918,0.987706611570248,0.9889462809917355,0.9880165289256199,0.9886363636363636,0.9888429752066116,0.9896694214876033],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial28","x":[0,1,2,3,4,5,6,7,8,9,10,11],"y":[0.9464876033057851,0.946590909090909,0.9725206611570248,0.9740702479338843,0.9857438016528925,0.987603305785124,0.9899793388429752,0.990599173553719,0.9916322314049587,0.9926652892561983,0.9945247933884298,0.9934917355371901],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial29","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9386546184738955,0.9497991967871486,0.9662650602409638,0.9635542168674699,0.9629518072289157,0.9694779116465864,0.9734939759036144,0.9758032128514056,0.9813253012048193,0.9809236947791165,0.9843373493975903],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial30","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9583853516437786,0.9839783603828548,0.9863712026633374,0.9923012900540991,0.9925093632958801,0.9900124843945068,0.9918851435705368,0.9918851435705368,0.9893882646691635,0.992093216812318,0.9918851435705368],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial31","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9328798185941043,0.9630385487528345,0.9630385487528345,0.9616780045351474,0.9781179138321996,0.9811791383219954,0.9802721088435374,0.9836734693877551,0.9832199546485261,0.98140589569161,0.9839002267573697],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial32","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18],"y":[0.9634297520661157,0.9885330578512397,0.9920454545454546,0.9920454545454546,0.9941115702479338,0.9930785123966942,0.9945247933884298,0.993801652892562,0.9948347107438017,0.993801652892562,0.993698347107438,0.993698347107438,0.9954545454545455,0.993801652892562,0.9958677685950413,0.9956611570247934,0.9954545454545455,0.9952479338842976,0.9956611570247934],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial33","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.8703703703703703,0.9588014981273408,0.9721181856013317,0.9707657095297545,0.9757594673325011,0.9805451518934665,0.9786724927174365,0.9814814814814815,0.9796088223054515,0.9816895547232626,0.982521847690387],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial34","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9325738916256158,0.9481732348111659,0.9510467980295566,0.9785509031198686,0.9826559934318555,0.9802955665024631,0.9833743842364532,0.9821428571428571,0.9806034482758621,0.9809113300492611,0.9792692939244664],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial35","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9456391875746715,0.9468339307048984,0.9594782954998009,0.9582835523695739,0.9586818000796495,0.9732178414974114,0.9732178414974114,0.9741138988450816,0.9775985663082437,0.9730187176423736,0.9771007566706491],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial36","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.927194018103109,0.9530696576151122,0.9718614718614719,0.9695985832349469,0.9713695395513577,0.9720582447855175,0.9742227469500196,0.9759937032664305,0.9750098386462023,0.9752066115702479,0.9752066115702479],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial37","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.953514739229025,0.9616780045351474,0.9713151927437642,0.9706349206349206,0.9717687074829932,0.9701814058956916,0.97437641723356,0.9767573696145124,0.9787981859410431,0.9785714285714285,0.9781179138321996],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial38","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9733552631578948,0.962938596491228,0.9650219298245614,0.9661184210526316,0.9736842105263158,0.9754385964912281,0.9771929824561404,0.9802631578947368,0.9802631578947368,0.9802631578947368,0.9800438596491228],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial39","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9066937119675457,0.9066937119675457,0.971501014198783,0.9764705882352941,0.9811359026369169,0.9853955375253549,0.982657200811359,0.9822515212981744,0.9844827586206897,0.9890466531440162,0.9879310344827587],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial40","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9798182586644125,0.9900676246830094,0.9908072696534235,0.9920752324598479,0.9914412510566357,0.9916525781910397,0.9928148774302621,0.9919695688926459,0.99270921386306,0.9931318681318682,0.9943998309382924],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial41","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9708677685950413,0.9683884297520661,0.9692148760330579,0.9752066115702479,0.9817148760330578,0.9839876033057852,0.9891528925619835,0.9885330578512397,0.990599173553719,0.9891528925619835,0.9883264462809918],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial42","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.945124716553288,0.9692743764172336,0.9723356009070295,0.969954648526077,0.9727891156462585,0.973015873015873,0.9724489795918367,0.9706349206349206,0.969047619047619,0.9665532879818595,0.9660997732426304],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial43","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18],"y":[0.9819727891156462,0.9753968253968254,0.9947845804988662,0.9947845804988662,0.9941043083900227,0.9950113378684807,0.9959183673469387,0.9961451247165533,0.9956916099773243,0.9943310657596371,0.9956916099773243,0.9952380952380953,0.9952380952380953,0.9954648526077098,0.9959183673469387,0.9950113378684807,0.9950113378684807,0.9956916099773243,0.9956916099773243],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial44","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[0.9732182877633349,0.9863290004482295,0.9910354101299865,0.9890183774092335,0.9908112953832362,0.9917077543702376,0.9932765575974899,0.9928283281039892,0.9950694755714926,0.9968623935454953,0.9961900493052442,0.9970865082922457,0.997982967279247,0.997982967279247,0.9982070820259973,0.9982070820259973,0.9977588525324966,0.9984311967727476,0.9982070820259973,0.9982070820259973,0.997982967279247,0.9986553115194979,0.9988794262662484,0.9991035410129987,0.9988794262662484,0.9991035410129987,0.9991035410129987,0.9991035410129987,0.9991035410129987,0.9991035410129987,0.9986553115194979,0.9991035410129987,0.9988794262662484,0.9988794262662484,0.9991035410129987,0.9991035410129987,0.9991035410129987,0.9991035410129987,0.9991035410129987,0.9991035410129987,0.999327655759749,0.999327655759749,0.999327655759749,0.999327655759749,0.999327655759749,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.999327655759749,0.999327655759749,0.9995517705064993,0.999327655759749,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993,0.9995517705064993],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial45","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9444444444444444,0.9506064162754304,0.9663536776212832,0.9745696400625978,0.9728090766823161,0.977112676056338,0.9821987480438185,0.9839593114241002,0.9853286384976526,0.9843505477308294,0.9827856025039123],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial46","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9551362683438155,0.970859538784067,0.970125786163522,0.969706498951782,0.9716981132075472,0.9712788259958072,0.9772536687631027,0.9766247379454926,0.9783018867924528,0.9786163522012579,0.9781970649895179],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial47","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9615702479338843,0.9646694214876033,0.9702479338842975,0.9824380165289256,0.9806818181818182,0.9848140495867769,0.9879132231404959,0.9902892561983471,0.9890495867768595,0.9913223140495868,0.9917355371900827],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial48","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9259031198686372,0.9412972085385879,0.9727011494252874,0.9713669950738916,0.9711617405582923,0.9686986863711001,0.9734195402298851,0.9736247947454844,0.9753694581280788,0.9760878489326765,0.9813218390804598],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial49","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9630541871921182,0.9670566502463054,0.9757799671592775,0.9754720853858785,0.9770114942528736,0.979064039408867,0.979679802955665,0.9813218390804598,0.9831691297208539,0.9838875205254516,0.9846059113300493],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial50","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9389264581572274,0.9660819949281487,0.9562552831783601,0.963229078613694,0.9604818258664413,0.9647083685545224,0.963229078613694,0.9628064243448858,0.9648140321217245,0.9665046491969569,0.9656593406593407],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial51","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9144088669950738,0.9338054187192119,0.9615147783251231,0.9652093596059114,0.9657224958949097,0.9695197044334976,0.9698275862068966,0.9734195402298851,0.9758825944170771,0.9738300492610837,0.9769088669950738],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial52","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.971031746031746,0.9799603174603174,0.9798611111111111,0.9833333333333333,0.983829365079365,0.9834325396825396,0.9819444444444444,0.9829365079365079,0.9853174603174604,0.9878968253968254,0.9892857142857143],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial53","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9429006085192698,0.9852941176470589,0.9864097363083164,0.988133874239351,0.9896551724137931,0.9905679513184584,0.9907707910750507,0.9908722109533469,0.9906693711967546,0.9918864097363083,0.9918864097363083],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial54","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9554507337526206,0.9654088050314465,0.9626834381551362,0.9621593291404612,0.9724318658280923,0.9748427672955975,0.9792452830188679,0.980503144654088,0.9825995807127883,0.980293501048218,0.979874213836478],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial55","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[0.9811075569772091,0.9890043982407037,0.9919032387045182,0.9936025589764095,0.9967013194722111,0.9965013994402239,0.9972011195521792,0.9954018392642943,0.9974010395841664,0.9972011195521792,0.997001199520192,0.9962015193922431,0.9960015993602559,0.9956017592962815,0.9964014394242303,0.9964014394242303,0.9972011195521792,0.9974010395841664,0.997001199520192,0.9974010395841664,0.9982007197121151,0.9986005597760895,0.9988004798080767,0.9986005597760895,0.9984006397441023,0.9984006397441023,0.9986005597760895,0.9986005597760895,0.9986005597760895,0.9988004798080767,0.9988004798080767,0.999000399840064,0.999000399840064,0.999000399840064,0.999000399840064,0.999000399840064,0.9992003198720512,0.999000399840064,0.9992003198720512,0.9994002399040384,0.9996001599360256,0.9994002399040384,0.9994002399040384,0.9994002399040384,0.9996001599360256,0.9996001599360256,0.9996001599360256,0.9998000799680128,1.0,1.0,1.0,1.0,1.0,1.0,0.9998000799680128,0.9998000799680128,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial56","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9509127789046653,0.9535496957403651,0.957606490872211,0.9578093306288032,0.9609533468559838,0.9609533468559838,0.9628803245436105,0.961764705882353,0.9656186612576065,0.9614604462474645,0.9611561866125761],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial57","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9496569814366425,0.9677158999192897,0.9666061339790153,0.9649919289749799,0.9674132364810331,0.9689265536723164,0.9693301049233253,0.9759887005649718,0.9753833736884584,0.9798224374495561,0.9808313155770783],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial58","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9028147163120568,0.9688608156028369,0.9700797872340425,0.9685283687943262,0.9700797872340425,0.9736258865248227,0.9738475177304965,0.9725177304964538,0.9730718085106383,0.972406914893617,0.9728501773049646],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial59","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9656462585034014,0.9714285714285714,0.9812925170068028,0.9886621315192744,0.9892290249433107,0.9893424036281179,0.9850340136054422,0.9848072562358277,0.9848072562358277,0.9852607709750567,0.9861678004535147],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial60","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9721852836879432,0.9863696808510638,0.9888076241134752,0.990802304964539,0.9917996453900709,0.993572695035461,0.9940159574468085,0.9937943262411347,0.993572695035461,0.9933510638297872,0.9940159574468085],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial61","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.984400826446281,0.9837809917355372,0.9879132231404959,0.9873966942148761,0.9880165289256199,0.9878099173553719,0.9883264462809918,0.9884297520661157,0.9890495867768595,0.9890495867768595,0.9890495867768595],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial62","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9353325173398613,0.9356385148918809,0.9425744594043247,0.941656466748266,0.9452264381884945,0.9511423908608732,0.9521623827009384,0.9575683394532843,0.9587923296613627,0.9577723378212974,0.9557323541411669],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial63","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9175191815856778,0.9347826086956522,0.9539641943734015,0.9542838874680307,0.9557757885763001,0.956308610400682,0.9568414322250639,0.9564151747655584,0.9552429667519181,0.9552429667519181,0.9565217391304348],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial64","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9666739036039947,0.9706904038211029,0.97405557967868,0.9813287016934433,0.9833912288319583,0.9823056882327399,0.9841511072514112,0.9832826747720365,0.9802431610942249,0.9807859313938341,0.9814372557533652],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial65","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9278559249786871,0.9337169650468883,0.9337169650468883,0.9576939471440751,0.9591858482523444,0.9598252344416027,0.9591858482523444,0.9607843137254902,0.9597186700767263,0.9628090366581415,0.9602514919011083],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial66","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9173710904480136,0.9106086221470837,0.9467455621301775,0.9578402366863905,0.9572062552831784,0.9575232459847844,0.9584742180896028,0.9602704987320372,0.9584742180896028,0.9600591715976331,0.9604818258664413],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial67","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9760230179028133,0.9844416027280477,0.986466325660699,0.9879582267689685,0.9884910485933504,0.9876385336743393,0.987531969309463,0.9866794543904518,0.9876385336743393,0.9884910485933504,0.9874254049445865],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial68","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9117647058823529,0.9595334685598377,0.9768762677484787,0.9842799188640974,0.9835699797160243,0.986815415821501,0.9836713995943205,0.9842799188640974,0.9859026369168357,0.986105476673428,0.9869168356997972],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial69","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9869735128093791,0.9913156752062527,0.992509769865393,0.9946808510638298,0.9928354320451585,0.9924012158054711,0.991098567086409,0.991098567086409,0.9919669995657837,0.9945722970039079,0.9946808510638298],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial70","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9537943696450428,0.9928600571195431,0.9946960424316605,0.9938800489596084,0.992452060383517,0.99265605875153,0.9929620563035496,0.994390044879641,0.9929620563035496,0.9925540595675234,0.9933700530395757],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial71","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.932258064516129,0.9451612903225807,0.9582795698924731,0.9582795698924731,0.9615053763440861,0.9601075268817204,0.9687096774193549,0.9687096774193549,0.9747311827956989,0.9770967741935483,0.9802150537634409],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial72","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.8869892473118279,0.9549462365591398,0.9639784946236559,0.9674193548387097,0.9654838709677419,0.968494623655914,0.9670967741935483,0.9704301075268817,0.969247311827957,0.9760215053763441,0.9783870967741936],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial73","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9532182438192668,0.9751705029838023,0.9751705029838023,0.9751705029838023,0.9845481670929241,0.9845481670929241,0.9836956521739131,0.9839087809036658,0.9843350383631714,0.9844416027280477,0.985080988917306],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial74","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9010989010989011,0.9010989010989011,0.9624894336432798,0.9680896027049873,0.9680896027049873,0.9787616229923922,0.9791842772612004,0.9804522400676247,0.981825866441251,0.981614539306847,0.9807692307692307],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial75","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9734784446322908,0.9792899408284024,0.9825655114116653,0.9876373626373627,0.9878486897717667,0.9921808960270498,0.9937658495350803,0.9939771766694844,0.9933431952662722,0.9943998309382924,0.9939771766694844],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial76","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9706486042692939,0.9828612479474549,0.9888136288998358,0.9886083743842364,0.9902504105090312,0.9901477832512315,0.9914819376026273,0.9916871921182266,0.9920977011494253,0.993123973727422,0.9919950738916257],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial77","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9608555286521389,0.9815375302663438,0.9822437449556094,0.981638418079096,0.9824455205811138,0.981638418079096,0.9856739305891848,0.9854721549636803,0.9822437449556094,0.9830508474576272,0.9828490718321227],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial78","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9392543859649123,0.969078947368421,0.968421052631579,0.9707236842105263,0.9709429824561403,0.9707236842105263,0.9791666666666666,0.9799342105263158,0.980701754385965,0.9802631578947368,0.9763157894736842],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial79","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9758635039533916,0.9858510195588848,0.9854348730753225,0.987411568872243,0.9878277153558053,0.9882438618393674,0.9897003745318352,0.9915730337078652,0.9929255097794424,0.9929255097794424,0.9927174365376612],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial80","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9267554479418886,0.9591404358353511,0.9534907183212268,0.9579297820823245,0.9584342211460856,0.9598466505246166,0.9621670702179177,0.9620661824051655,0.9624697336561744,0.9633777239709443,0.9653954802259888],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial81","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9863801452784504,0.9887005649717514,0.9952582728006457,0.9943502824858758,0.9941485068603713,0.9933414043583535,0.9937449556093624,0.994955609362389,0.9943502824858758,0.9933414043583535,0.9943502824858758],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial82","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99],"y":[0.9745283018867924,0.9791404612159329,0.9875262054507338,0.9882599580712789,0.990880503144654,0.9929769392033543,0.9954926624737945,0.9968553459119497,0.9970649895178197,0.9962264150943396,0.9962264150943396,0.9964360587002097,0.9972746331236897,0.9974842767295597,0.9972746331236897,0.9976939203354298,0.9981132075471698,0.9981132075471698,0.9983228511530399,0.9983228511530399,0.9985324947589098,0.9985324947589098,0.9989517819706499,0.9989517819706499,0.9987421383647799,0.9989517819706499,0.9989517819706499,0.9993710691823899,1.0,1.0,1.0,1.0,1.0,0.9997903563941299,0.9997903563941299,0.9997903563941299,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.9997903563941299,0.9997903563941299,0.9997903563941299,1.0,0.9997903563941299,0.9997903563941299,0.9997903563941299,0.9997903563941299,0.9997903563941299,0.9997903563941299,0.9997903563941299,0.9997903563941299,0.9997903563941299,0.9997903563941299,0.9997903563941299,0.9997903563941299,0.9997903563941299,0.9997903563941299,0.9997903563941299,0.99958071278826,0.99958071278826,0.9991614255765199,0.9991614255765199,0.9993710691823899,0.9991614255765199,0.9991614255765199,0.9991614255765199,0.9993710691823899,0.9993710691823899,0.99958071278826,0.99958071278826,0.99958071278826,0.99958071278826,0.9997903563941299,1.0,0.9997903563941299,1.0,0.9997903563941299,0.9997903563941299,0.9997903563941299,0.99958071278826,0.99958071278826,0.99958071278826,0.99958071278826,0.9997903563941299,0.9997903563941299,1.0,1.0,1.0,1.0],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial83","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9916142557651991,0.9946540880503144,0.9946540880503144,0.9892033542976939,0.9881551362683438,0.9935010482180293,0.9953878406708595,0.9958071278825996,0.9958071278825996,0.9955974842767296,0.9955974842767296],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial84","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9517263427109974,0.9689897698209718,0.9760230179028133,0.9815643648763853,0.9764492753623188,0.9819906223358909,0.9766624040920716,0.9770886615515771,0.9794330775788577,0.9792199488491049,0.9820971867007673],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial85","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9631944444444445,0.9634920634920635,0.9638888888888889,0.9625992063492064,0.9734126984126984,0.9738095238095238,0.9680555555555556,0.9677579365079365,0.9683531746031746,0.9675595238095238,0.9679563492063492],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial86","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9538177339901478,0.9742405582922824,0.9761904761904762,0.9743431855500821,0.9743431855500821,0.9737274220032841,0.9758825944170771,0.9736247947454844,0.9756773399014779,0.9786535303776683,0.979064039408867],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial87","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9634646962233169,0.9682881773399015,0.9817323481116584,0.9910714285714286,0.9890188834154351,0.993431855500821,0.9940476190476191,0.9942528735632183,0.993431855500821,0.9932266009852216,0.9919950738916257],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial88","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9797052154195012,0.9870748299319728,0.9918367346938776,0.992517006802721,0.9929705215419501,0.992517006802721,0.9934240362811791,0.9929705215419501,0.9927437641723356,0.9920634920634921,0.9947845804988662],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial89","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9327655759748992,0.9438592559390407,0.9398251904975348,0.9406095921111609,0.9468848050201704,0.9536082474226805,0.9463245181532944,0.9418422232182878,0.9514791573285523,0.9530479605558045,0.9685118780815778],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial90","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9681647940074907,0.9694132334581773,0.9860590928006658,0.9893882646691635,0.992093216812318,0.992093216812318,0.9933416562630045,0.9942779858510196,0.9945900957136912,0.9937578027465668,0.9947981689554724],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial91","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9278530377668309,0.9363711001642037,0.950636288998358,0.9499178981937603,0.9493021346469622,0.9499178981937603,0.9516625615763546,0.9510467980295566,0.9623357963875205,0.9627463054187192,0.964696223316913],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial92","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9581572273879966,0.9658706677937448,0.9683009298393914,0.9749577345731192,0.9737954353338969,0.970625528317836,0.9766483516483516,0.9802409129332206,0.9838334742180896,0.985207100591716,0.9859467455621301],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial93","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9621593291404612,0.9582809224318658,0.9858490566037735,0.9861635220125786,0.9886792452830189,0.9897274633123689,0.9890985324947589,0.9880503144654088,0.9874213836477987,0.9876310272536688,0.9886792452830189],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial94","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9784090909090909,0.9852272727272727,0.984607438016529,0.9849173553719008,0.9889462809917355,0.9886363636363636,0.9829545454545454,0.9933884297520661,0.9940082644628099,0.993595041322314,0.9946280991735538],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial95","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.8545771756978654,0.9349343185550082,0.944068144499179,0.9529967159277504,0.9623357963875205,0.9631568144499179,0.9760878489326765,0.9760878489326765,0.9789614121510674,0.9829638752052545,0.9848111658456487],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial96","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21],"y":[0.9693877551020408,0.9859965262700825,0.9888189318280504,0.9905557967867998,0.990447242726878,0.9915327833260964,0.9977203647416414,0.9975032566217976,0.9964177160225792,0.997286148501954,0.9976118106817194,0.9971775944420321,0.996526270082501,0.9967433782023448,0.9969604863221885,0.9971775944420321,0.9973947025618758,0.9971775944420321,0.9973947025618758,0.9976118106817194,0.9982631350412505,0.9976118106817194],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial97","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9546703296703297,0.9646027049873204,0.9714708368554522,0.9762256973795436,0.977916314454776,0.9804522400676247,0.9810862214708369,0.9803465765004227,0.9811918850380389,0.9807692307692307,0.9826711749788672],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial98","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9726544082979727,0.9799622819424799,0.9829090051862329,0.9818481848184818,0.9837340876944838,0.9846770391324847,0.9836162187647336,0.9833804809052333,0.9839698255539839,0.9856199905704857,0.9851485148514851],"type":"scatter"},{"marker":{"maxdisplayed":10},"mode":"lines+markers","name":"Trial99","x":[0,1,2,3,4,5,6,7,8,9,10],"y":[0.9492324561403509,0.9611842105263158,0.9598684210526316,0.95625,0.9747807017543859,0.9787280701754386,0.9848684210526316,0.9857456140350878,0.9875,0.9899122807017544,0.9890350877192983],"type":"scatter"}],                        {"showlegend":false,"title":{"text":"Intermediate Values Plot"},"xaxis":{"title":{"text":"Step"}},"yaxis":{"title":{"text":"Intermediate Value"}},"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}}},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
<br />
<br /><p>Visualize high-dimensional parameter relationships. See <a class="reference internal" href="index.html#optuna.visualization.plot_parallel_coordinate" title="optuna.visualization.plot_parallel_coordinate"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_parallel_coordinate()</span></code></a> for the details.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_parallel_coordinate</span><span class="p">(</span><span class="n">study</span><span class="p">)</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-2.18.2.min.js"></script>                <div id="aef84f11-6e1e-4db5-9886-91edf174bceb" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("aef84f11-6e1e-4db5-9886-91edf174bceb")) {                    Plotly.newPlot(                        "aef84f11-6e1e-4db5-9886-91edf174bceb",                        [{"dimensions":[{"label":"Objective Value","range":[0.958041958041958,0.993006993006993],"values":[0.972027972027972,0.972027972027972,0.958041958041958,0.9790209790209791,0.958041958041958,0.993006993006993,0.986013986013986,0.986013986013986,0.9790209790209791,0.986013986013986,0.986013986013986,0.9790209790209791]},{"label":"bagging_fraction","range":[0.4348501673009197,0.9905077333938093],"values":[0.6247240713084175,0.759195090518222,0.4348501673009197,0.8248435466776274,0.899465584480253,0.5100427059120604,0.9733907188988407,0.9905077333938093,0.9539760625736883,0.8823409487656904,0.973380947872035,0.8183457327801615]},{"label":"bagging_freq","range":[1,7],"values":[7,2,7,1,2,3,1,2,1,1,2,3]},{"label":"min_child_samples","range":[5,98],"values":[75,19,62,98,22,55,98,54,5,48,39,22]}],"labelangle":30,"labelside":"bottom","line":{"color":[0.972027972027972,0.972027972027972,0.958041958041958,0.9790209790209791,0.958041958041958,0.993006993006993,0.986013986013986,0.986013986013986,0.9790209790209791,0.986013986013986,0.986013986013986,0.9790209790209791],"colorbar":{"title":{"text":"Objective Value"}},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"reversescale":false,"showscale":true},"type":"parcoords"}],                        {"title":{"text":"Parallel Coordinate Plot"},"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}}},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
<br />
<br /><p>Select parameters to visualize.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_parallel_coordinate</span><span class="p">(</span><span class="n">study</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;bagging_freq&quot;</span><span class="p">,</span> <span class="s2">&quot;bagging_fraction&quot;</span><span class="p">])</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-2.18.2.min.js"></script>                <div id="8db760f5-0258-4602-b173-8acef29d09c5" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("8db760f5-0258-4602-b173-8acef29d09c5")) {                    Plotly.newPlot(                        "8db760f5-0258-4602-b173-8acef29d09c5",                        [{"dimensions":[{"label":"Objective Value","range":[0.958041958041958,0.993006993006993],"values":[0.972027972027972,0.972027972027972,0.958041958041958,0.9790209790209791,0.958041958041958,0.993006993006993,0.986013986013986,0.986013986013986,0.9790209790209791,0.986013986013986,0.986013986013986,0.9790209790209791]},{"label":"bagging_fraction","range":[0.4348501673009197,0.9905077333938093],"values":[0.6247240713084175,0.759195090518222,0.4348501673009197,0.8248435466776274,0.899465584480253,0.5100427059120604,0.9733907188988407,0.9905077333938093,0.9539760625736883,0.8823409487656904,0.973380947872035,0.8183457327801615]},{"label":"bagging_freq","range":[1,7],"values":[7,2,7,1,2,3,1,2,1,1,2,3]}],"labelangle":30,"labelside":"bottom","line":{"color":[0.972027972027972,0.972027972027972,0.958041958041958,0.9790209790209791,0.958041958041958,0.993006993006993,0.986013986013986,0.986013986013986,0.9790209790209791,0.986013986013986,0.986013986013986,0.9790209790209791],"colorbar":{"title":{"text":"Objective Value"}},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"reversescale":false,"showscale":true},"type":"parcoords"}],                        {"title":{"text":"Parallel Coordinate Plot"},"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}}},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
<br />
<br /><p>Visualize hyperparameter relationships. See <a class="reference internal" href="index.html#optuna.visualization.plot_contour" title="optuna.visualization.plot_contour"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_contour()</span></code></a> for the details.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_contour</span><span class="p">(</span><span class="n">study</span><span class="p">)</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-2.18.2.min.js"></script>                <div id="00e10e74-bcbc-4976-a3d5-7ba6b3165fe1" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("00e10e74-bcbc-4976-a3d5-7ba6b3165fe1")) {                    Plotly.newPlot(                        "00e10e74-bcbc-4976-a3d5-7ba6b3165fe1",                        [{"type":"scatter","xaxis":"x","yaxis":"y"},{"colorbar":{"title":{"text":"Objective Value"}},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"connectgaps":true,"contours":{"coloring":"heatmap"},"hoverinfo":"none","line":{"smoothing":1.3},"reversescale":false,"showscale":true,"x":[0.4070672889962752,0.4348501673009197,0.5100427059120604,0.6247240713084175,0.759195090518222,0.8183457327801615,0.8248435466776274,0.8823409487656904,0.899465584480253,0.9539760625736883,0.973380947872035,0.9733907188988407,0.9905077333938093,1.0182906116984538],"y":[0.7,1,2,3,7,7.3],"z":[[null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,0.9790209790209791,0.986013986013986,null,0.9790209790209791,null,0.986013986013986,null,null],[null,null,null,null,0.972027972027972,null,null,null,0.958041958041958,null,0.986013986013986,null,0.986013986013986,null],[null,null,0.993006993006993,null,null,0.9790209790209791,null,null,null,null,null,null,null,null],[null,0.958041958041958,null,0.972027972027972,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"type":"contour","xaxis":"x4","yaxis":"y4"},{"marker":{"color":"black","line":{"color":"Grey","width":2.0}},"mode":"markers","showlegend":false,"x":[0.6247240713084175,0.759195090518222,0.4348501673009197,0.8248435466776274,0.899465584480253,0.5100427059120604,0.9733907188988407,0.9905077333938093,0.9539760625736883,0.8823409487656904,0.973380947872035,0.8183457327801615],"y":[7,2,7,1,2,3,1,2,1,1,2,3],"type":"scatter","xaxis":"x4","yaxis":"y4"},{"colorbar":{"title":{"text":"Objective Value"}},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"connectgaps":true,"contours":{"coloring":"heatmap"},"hoverinfo":"none","line":{"smoothing":1.3},"reversescale":false,"showscale":false,"x":[0.4070672889962752,0.4348501673009197,0.5100427059120604,0.6247240713084175,0.759195090518222,0.8183457327801615,0.8248435466776274,0.8823409487656904,0.899465584480253,0.9539760625736883,0.973380947872035,0.9733907188988407,0.9905077333938093,1.0182906116984538],"y":[0.34999999999999964,5,19,22,39,48,54,55,62,75,98,102.65],"z":[[null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,0.9790209790209791,null,null,null,null],[null,null,null,null,0.972027972027972,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,0.9790209790209791,null,null,0.958041958041958,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,0.986013986013986,null,null,null],[null,null,null,null,null,null,null,0.986013986013986,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,0.986013986013986,null],[null,null,0.993006993006993,null,null,null,null,null,null,null,null,null,null,null],[null,0.958041958041958,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,0.972027972027972,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,0.9790209790209791,null,null,null,null,0.986013986013986,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"type":"contour","xaxis":"x7","yaxis":"y7"},{"marker":{"color":"black","line":{"color":"Grey","width":2.0}},"mode":"markers","showlegend":false,"x":[0.6247240713084175,0.759195090518222,0.4348501673009197,0.8248435466776274,0.899465584480253,0.5100427059120604,0.9733907188988407,0.9905077333938093,0.9539760625736883,0.8823409487656904,0.973380947872035,0.8183457327801615],"y":[75,19,62,98,22,55,98,54,5,48,39,22],"type":"scatter","xaxis":"x7","yaxis":"y7"},{"colorbar":{"title":{"text":"Objective Value"}},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"connectgaps":true,"contours":{"coloring":"heatmap"},"hoverinfo":"none","line":{"smoothing":1.3},"reversescale":false,"showscale":false,"x":[0.7,1,2,3,7,7.3],"y":[0.4070672889962752,0.4348501673009197,0.5100427059120604,0.6247240713084175,0.759195090518222,0.8183457327801615,0.8248435466776274,0.8823409487656904,0.899465584480253,0.9539760625736883,0.973380947872035,0.9733907188988407,0.9905077333938093,1.0182906116984538],"z":[[null,null,null,null,null,null],[null,null,null,null,0.958041958041958,null],[null,null,null,0.993006993006993,null,null],[null,null,null,null,0.972027972027972,null],[null,null,0.972027972027972,null,null,null],[null,null,null,0.9790209790209791,null,null],[null,0.9790209790209791,null,null,null,null],[null,0.986013986013986,null,null,null,null],[null,null,0.958041958041958,null,null,null],[null,0.9790209790209791,null,null,null,null],[null,null,0.986013986013986,null,null,null],[null,0.986013986013986,null,null,null,null],[null,null,0.986013986013986,null,null,null],[null,null,null,null,null,null]],"type":"contour","xaxis":"x2","yaxis":"y2"},{"marker":{"color":"black","line":{"color":"Grey","width":2.0}},"mode":"markers","showlegend":false,"x":[7,2,7,1,2,3,1,2,1,1,2,3],"y":[0.6247240713084175,0.759195090518222,0.4348501673009197,0.8248435466776274,0.899465584480253,0.5100427059120604,0.9733907188988407,0.9905077333938093,0.9539760625736883,0.8823409487656904,0.973380947872035,0.8183457327801615],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"type":"scatter","xaxis":"x5","yaxis":"y5"},{"colorbar":{"title":{"text":"Objective Value"}},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"connectgaps":true,"contours":{"coloring":"heatmap"},"hoverinfo":"none","line":{"smoothing":1.3},"reversescale":false,"showscale":false,"x":[0.7,1,2,3,7,7.3],"y":[0.34999999999999964,5,19,22,39,48,54,55,62,75,98,102.65],"z":[[null,null,null,null,null,null],[null,0.9790209790209791,null,null,null,null],[null,null,0.972027972027972,null,null,null],[null,null,0.958041958041958,0.9790209790209791,null,null],[null,null,0.986013986013986,null,null,null],[null,0.986013986013986,null,null,null,null],[null,null,0.986013986013986,null,null,null],[null,null,null,0.993006993006993,null,null],[null,null,null,null,0.958041958041958,null],[null,null,null,null,0.972027972027972,null],[null,0.986013986013986,null,null,null,null],[null,null,null,null,null,null]],"type":"contour","xaxis":"x8","yaxis":"y8"},{"marker":{"color":"black","line":{"color":"Grey","width":2.0}},"mode":"markers","showlegend":false,"x":[7,2,7,1,2,3,1,2,1,1,2,3],"y":[75,19,62,98,22,55,98,54,5,48,39,22],"type":"scatter","xaxis":"x8","yaxis":"y8"},{"colorbar":{"title":{"text":"Objective Value"}},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"connectgaps":true,"contours":{"coloring":"heatmap"},"hoverinfo":"none","line":{"smoothing":1.3},"reversescale":false,"showscale":false,"x":[0.34999999999999964,5,19,22,39,48,54,55,62,75,98,102.65],"y":[0.4070672889962752,0.4348501673009197,0.5100427059120604,0.6247240713084175,0.759195090518222,0.8183457327801615,0.8248435466776274,0.8823409487656904,0.899465584480253,0.9539760625736883,0.973380947872035,0.9733907188988407,0.9905077333938093,1.0182906116984538],"z":[[null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,0.958041958041958,null,null,null],[null,null,null,null,null,null,null,0.993006993006993,null,null,null,null],[null,null,null,null,null,null,null,null,null,0.972027972027972,null,null],[null,null,0.972027972027972,null,null,null,null,null,null,null,null,null],[null,null,null,0.9790209790209791,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,0.9790209790209791,null],[null,null,null,null,null,0.986013986013986,null,null,null,null,null,null],[null,null,null,0.958041958041958,null,null,null,null,null,null,null,null],[null,0.9790209790209791,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,0.986013986013986,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,0.986013986013986,null],[null,null,null,null,null,null,0.986013986013986,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null]],"type":"contour","xaxis":"x3","yaxis":"y3"},{"marker":{"color":"black","line":{"color":"Grey","width":2.0}},"mode":"markers","showlegend":false,"x":[75,19,62,98,22,55,98,54,5,48,39,22],"y":[0.6247240713084175,0.759195090518222,0.4348501673009197,0.8248435466776274,0.899465584480253,0.5100427059120604,0.9733907188988407,0.9905077333938093,0.9539760625736883,0.8823409487656904,0.973380947872035,0.8183457327801615],"type":"scatter","xaxis":"x3","yaxis":"y3"},{"colorbar":{"title":{"text":"Objective Value"}},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"connectgaps":true,"contours":{"coloring":"heatmap"},"hoverinfo":"none","line":{"smoothing":1.3},"reversescale":false,"showscale":false,"x":[0.34999999999999964,5,19,22,39,48,54,55,62,75,98,102.65],"y":[0.7,1,2,3,7,7.3],"z":[[null,null,null,null,null,null,null,null,null,null,null,null],[null,0.9790209790209791,null,null,null,0.986013986013986,null,null,null,null,0.986013986013986,null],[null,null,0.972027972027972,0.958041958041958,0.986013986013986,null,0.986013986013986,null,null,null,null,null],[null,null,null,0.9790209790209791,null,null,null,0.993006993006993,null,null,null,null],[null,null,null,null,null,null,null,null,0.958041958041958,0.972027972027972,null,null],[null,null,null,null,null,null,null,null,null,null,null,null]],"type":"contour","xaxis":"x6","yaxis":"y6"},{"marker":{"color":"black","line":{"color":"Grey","width":2.0}},"mode":"markers","showlegend":false,"x":[75,19,62,98,22,55,98,54,5,48,39,22],"y":[7,2,7,1,2,3,1,2,1,1,2,3],"type":"scatter","xaxis":"x6","yaxis":"y6"},{"type":"scatter","xaxis":"x9","yaxis":"y9"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,0.2888888888888889],"matches":"x7","showticklabels":false,"range":[0.4070672889962752,1.0182906116984538]},"yaxis":{"anchor":"x","domain":[0.7333333333333333,1.0],"range":[0.4070672889962752,1.0182906116984538],"title":{"text":"bagging_fraction"}},"xaxis2":{"anchor":"y2","domain":[0.35555555555555557,0.6444444444444445],"matches":"x8","showticklabels":false,"range":[0.7,7.3]},"yaxis2":{"anchor":"x2","domain":[0.7333333333333333,1.0],"matches":"y","showticklabels":false,"range":[0.4070672889962752,1.0182906116984538]},"xaxis3":{"anchor":"y3","domain":[0.7111111111111111,1.0],"matches":"x9","showticklabels":false,"range":[0.34999999999999964,102.65]},"yaxis3":{"anchor":"x3","domain":[0.7333333333333333,1.0],"matches":"y","showticklabels":false,"range":[0.4070672889962752,1.0182906116984538]},"xaxis4":{"anchor":"y4","domain":[0.0,0.2888888888888889],"matches":"x7","showticklabels":false,"range":[0.4070672889962752,1.0182906116984538]},"yaxis4":{"anchor":"x4","domain":[0.36666666666666664,0.6333333333333333],"range":[0.7,7.3],"title":{"text":"bagging_freq"}},"xaxis5":{"anchor":"y5","domain":[0.35555555555555557,0.6444444444444445],"matches":"x8","showticklabels":false,"range":[0.7,7.3]},"yaxis5":{"anchor":"x5","domain":[0.36666666666666664,0.6333333333333333],"matches":"y4","showticklabels":false,"range":[0.7,7.3]},"xaxis6":{"anchor":"y6","domain":[0.7111111111111111,1.0],"matches":"x9","showticklabels":false,"range":[0.34999999999999964,102.65]},"yaxis6":{"anchor":"x6","domain":[0.36666666666666664,0.6333333333333333],"matches":"y4","showticklabels":false,"range":[0.7,7.3]},"xaxis7":{"anchor":"y7","domain":[0.0,0.2888888888888889],"range":[0.4070672889962752,1.0182906116984538],"title":{"text":"bagging_fraction"}},"yaxis7":{"anchor":"x7","domain":[0.0,0.26666666666666666],"range":[0.34999999999999964,102.65],"title":{"text":"min_child_samples"}},"xaxis8":{"anchor":"y8","domain":[0.35555555555555557,0.6444444444444445],"range":[0.7,7.3],"title":{"text":"bagging_freq"}},"yaxis8":{"anchor":"x8","domain":[0.0,0.26666666666666666],"matches":"y7","showticklabels":false,"range":[0.34999999999999964,102.65]},"xaxis9":{"anchor":"y9","domain":[0.7111111111111111,1.0],"range":[0.34999999999999964,102.65],"title":{"text":"min_child_samples"}},"yaxis9":{"anchor":"x9","domain":[0.0,0.26666666666666666],"matches":"y7","showticklabels":false,"range":[0.34999999999999964,102.65]},"title":{"text":"Contour Plot"}},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
<br />
<br /><p>Select parameters to visualize.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_contour</span><span class="p">(</span><span class="n">study</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;bagging_freq&quot;</span><span class="p">,</span> <span class="s2">&quot;bagging_fraction&quot;</span><span class="p">])</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-2.18.2.min.js"></script>                <div id="d6f0251a-6771-4f72-9a7b-5420bda83fe1" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("d6f0251a-6771-4f72-9a7b-5420bda83fe1")) {                    Plotly.newPlot(                        "d6f0251a-6771-4f72-9a7b-5420bda83fe1",                        [{"colorbar":{"title":{"text":"Objective Value"}},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"connectgaps":true,"contours":{"coloring":"heatmap"},"hoverinfo":"none","line":{"smoothing":1.3},"reversescale":false,"x":[0.4070672889962752,0.4348501673009197,0.5100427059120604,0.6247240713084175,0.759195090518222,0.8183457327801615,0.8248435466776274,0.8823409487656904,0.899465584480253,0.9539760625736883,0.973380947872035,0.9733907188988407,0.9905077333938093,1.0182906116984538],"y":[0.7,1,2,3,7,7.3],"z":[[null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,0.9790209790209791,0.986013986013986,null,0.9790209790209791,null,0.986013986013986,null,null],[null,null,null,null,0.972027972027972,null,null,null,0.958041958041958,null,0.986013986013986,null,0.986013986013986,null],[null,null,0.993006993006993,null,null,0.9790209790209791,null,null,null,null,null,null,null,null],[null,0.958041958041958,null,0.972027972027972,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null]],"type":"contour"},{"marker":{"color":"black","line":{"color":"Grey","width":2.0}},"mode":"markers","showlegend":false,"x":[0.6247240713084175,0.759195090518222,0.4348501673009197,0.8248435466776274,0.899465584480253,0.5100427059120604,0.9733907188988407,0.9905077333938093,0.9539760625736883,0.8823409487656904,0.973380947872035,0.8183457327801615],"y":[7,2,7,1,2,3,1,2,1,1,2,3],"type":"scatter"}],                        {"title":{"text":"Contour Plot"},"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"title":{"text":"bagging_fraction"},"range":[0.4070672889962752,1.0182906116984538]},"yaxis":{"title":{"text":"bagging_freq"},"range":[0.7,7.3]}},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
<br />
<br /><p>Visualize individual hyperparameters as slice plot. See <a class="reference internal" href="index.html#optuna.visualization.plot_slice" title="optuna.visualization.plot_slice"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_slice()</span></code></a> for the details.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_slice</span><span class="p">(</span><span class="n">study</span><span class="p">)</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-2.18.2.min.js"></script>                <div id="b230ef7a-dd2d-4733-bd6c-f2793809ddb2" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("b230ef7a-dd2d-4733-bd6c-f2793809ddb2")) {                    Plotly.newPlot(                        "b230ef7a-dd2d-4733-bd6c-f2793809ddb2",                        [{"marker":{"color":[0,1,2,3,4,5,12,18,25,44,55,82],"colorbar":{"title":{"text":"Trial"},"x":1.0,"xpad":40},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"line":{"color":"Grey","width":0.5},"showscale":true},"mode":"markers","showlegend":false,"x":[0.6247240713084175,0.759195090518222,0.4348501673009197,0.8248435466776274,0.899465584480253,0.5100427059120604,0.9733907188988407,0.9905077333938093,0.9539760625736883,0.8823409487656904,0.973380947872035,0.8183457327801615],"y":[0.972027972027972,0.972027972027972,0.958041958041958,0.9790209790209791,0.958041958041958,0.993006993006993,0.986013986013986,0.986013986013986,0.9790209790209791,0.986013986013986,0.986013986013986,0.9790209790209791],"type":"scatter","xaxis":"x","yaxis":"y"},{"marker":{"color":[0,1,2,3,4,5,12,18,25,44,55,82],"colorbar":{"title":{"text":"Trial"},"x":1.0,"xpad":40},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"line":{"color":"Grey","width":0.5},"showscale":false},"mode":"markers","showlegend":false,"x":[7,2,7,1,2,3,1,2,1,1,2,3],"y":[0.972027972027972,0.972027972027972,0.958041958041958,0.9790209790209791,0.958041958041958,0.993006993006993,0.986013986013986,0.986013986013986,0.9790209790209791,0.986013986013986,0.986013986013986,0.9790209790209791],"type":"scatter","xaxis":"x2","yaxis":"y2"},{"marker":{"color":[0,1,2,3,4,5,12,18,25,44,55,82],"colorbar":{"title":{"text":"Trial"},"x":1.0,"xpad":40},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"line":{"color":"Grey","width":0.5},"showscale":false},"mode":"markers","showlegend":false,"x":[75,19,62,98,22,55,98,54,5,48,39,22],"y":[0.972027972027972,0.972027972027972,0.958041958041958,0.9790209790209791,0.958041958041958,0.993006993006993,0.986013986013986,0.986013986013986,0.9790209790209791,0.986013986013986,0.986013986013986,0.9790209790209791],"type":"scatter","xaxis":"x3","yaxis":"y3"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,0.2888888888888889],"title":{"text":"bagging_fraction"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Objective Value"}},"xaxis2":{"anchor":"y2","domain":[0.35555555555555557,0.6444444444444445],"title":{"text":"bagging_freq"}},"yaxis2":{"anchor":"x2","domain":[0.0,1.0],"matches":"y","showticklabels":false},"xaxis3":{"anchor":"y3","domain":[0.7111111111111111,1.0],"title":{"text":"min_child_samples"}},"yaxis3":{"anchor":"x3","domain":[0.0,1.0],"matches":"y","showticklabels":false},"title":{"text":"Slice Plot"}},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
<br />
<br /><p>Select parameters to visualize.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_slice</span><span class="p">(</span><span class="n">study</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;bagging_freq&quot;</span><span class="p">,</span> <span class="s2">&quot;bagging_fraction&quot;</span><span class="p">])</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-2.18.2.min.js"></script>                <div id="5aa784f2-3573-43a6-817e-06b43dfbf60f" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("5aa784f2-3573-43a6-817e-06b43dfbf60f")) {                    Plotly.newPlot(                        "5aa784f2-3573-43a6-817e-06b43dfbf60f",                        [{"marker":{"color":[0,1,2,3,4,5,12,18,25,44,55,82],"colorbar":{"title":{"text":"Trial"},"x":1.0,"xpad":40},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"line":{"color":"Grey","width":0.5},"showscale":true},"mode":"markers","showlegend":false,"x":[0.6247240713084175,0.759195090518222,0.4348501673009197,0.8248435466776274,0.899465584480253,0.5100427059120604,0.9733907188988407,0.9905077333938093,0.9539760625736883,0.8823409487656904,0.973380947872035,0.8183457327801615],"y":[0.972027972027972,0.972027972027972,0.958041958041958,0.9790209790209791,0.958041958041958,0.993006993006993,0.986013986013986,0.986013986013986,0.9790209790209791,0.986013986013986,0.986013986013986,0.9790209790209791],"type":"scatter","xaxis":"x","yaxis":"y"},{"marker":{"color":[0,1,2,3,4,5,12,18,25,44,55,82],"colorbar":{"title":{"text":"Trial"},"x":1.0,"xpad":40},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"line":{"color":"Grey","width":0.5},"showscale":false},"mode":"markers","showlegend":false,"x":[7,2,7,1,2,3,1,2,1,1,2,3],"y":[0.972027972027972,0.972027972027972,0.958041958041958,0.9790209790209791,0.958041958041958,0.993006993006993,0.986013986013986,0.986013986013986,0.9790209790209791,0.986013986013986,0.986013986013986,0.9790209790209791],"type":"scatter","xaxis":"x2","yaxis":"y2"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"xaxis":{"anchor":"y","domain":[0.0,0.45],"title":{"text":"bagging_fraction"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"Objective Value"}},"xaxis2":{"anchor":"y2","domain":[0.55,1.0],"title":{"text":"bagging_freq"}},"yaxis2":{"anchor":"x2","domain":[0.0,1.0],"matches":"y","showticklabels":false},"title":{"text":"Slice Plot"}},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
<br />
<br /><p>Visualize parameter importances. See <a class="reference internal" href="index.html#optuna.visualization.plot_param_importances" title="optuna.visualization.plot_param_importances"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_param_importances()</span></code></a> for the details.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_param_importances</span><span class="p">(</span><span class="n">study</span><span class="p">)</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-2.18.2.min.js"></script>                <div id="447d57bc-83c5-422f-8310-9612fd63db27" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("447d57bc-83c5-422f-8310-9612fd63db27")) {                    Plotly.newPlot(                        "447d57bc-83c5-422f-8310-9612fd63db27",                        [{"cliponaxis":false,"hovertemplate":["bagging_freq (IntDistribution): 0.2573919908384002<extra></extra>","min_child_samples (IntDistribution): 0.27920131238824286<extra></extra>","bagging_fraction (FloatDistribution): 0.46340669677335694<extra></extra>"],"marker":{"color":"rgb(66,146,198)"},"orientation":"h","text":["0.26","0.28","0.46"],"textposition":"outside","x":[0.2573919908384002,0.27920131238824286,0.46340669677335694],"y":["bagging_freq","min_child_samples","bagging_fraction"],"type":"bar"}],                        {"showlegend":false,"title":{"text":"Hyperparameter Importances"},"xaxis":{"title":{"text":"Importance for Objective Value"}},"yaxis":{"title":{"text":"Hyperparameter"}},"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}}},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
<br />
<br /><p>Learn which hyperparameters are affecting the trial duration with hyperparameter importance.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">optuna</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">plot_param_importances</span><span class="p">(</span>
    <span class="n">study</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">duration</span><span class="o">.</span><span class="n">total_seconds</span><span class="p">(),</span> <span class="n">target_name</span><span class="o">=</span><span class="s2">&quot;duration&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-2.18.2.min.js"></script>                <div id="ce22f225-c2c7-4984-bac2-a73052d01db7" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("ce22f225-c2c7-4984-bac2-a73052d01db7")) {                    Plotly.newPlot(                        "ce22f225-c2c7-4984-bac2-a73052d01db7",                        [{"cliponaxis":false,"hovertemplate":["bagging_freq (IntDistribution): 0.07614684898496271<extra></extra>","bagging_fraction (FloatDistribution): 0.08012570206522159<extra></extra>","min_child_samples (IntDistribution): 0.8437274489498158<extra></extra>"],"marker":{"color":"rgb(66,146,198)"},"orientation":"h","text":["0.08","0.08","0.84"],"textposition":"outside","x":[0.07614684898496271,0.08012570206522159,0.8437274489498158],"y":["bagging_freq","bagging_fraction","min_child_samples"],"type":"bar"}],                        {"showlegend":false,"title":{"text":"Hyperparameter Importances"},"xaxis":{"title":{"text":"Importance for duration"}},"yaxis":{"title":{"text":"Hyperparameter"}},"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}}},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
<br />
<br /><p>Visualize empirical distribution function. See <a class="reference internal" href="index.html#optuna.visualization.plot_edf" title="optuna.visualization.plot_edf"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_edf()</span></code></a> for the details.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plot_edf</span><span class="p">(</span><span class="n">study</span><span class="p">)</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-2.18.2.min.js"></script>                <div id="399ef993-8262-48cd-add0-d79b5aaa0aaa" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("399ef993-8262-48cd-add0-d79b5aaa0aaa")) {                    Plotly.newPlot(                        "399ef993-8262-48cd-add0-d79b5aaa0aaa",                        [{"mode":"lines","name":"no-name-d38d90de-775f-44c7-99ed-eb43c9471091","x":[0.958041958041958,0.9583951402133221,0.958748322384686,0.95910150455605,0.959454686727414,0.959807868898778,0.9601610510701419,0.960514233241506,0.9608674154128699,0.961220597584234,0.9615737797555979,0.9619269619269619,0.9622801440983259,0.9626333262696899,0.9629865084410538,0.9633396906124179,0.9636928727837819,0.9640460549551458,0.9643992371265099,0.9647524192978738,0.9651056014692379,0.9654587836406018,0.9658119658119658,0.9661651479833298,0.9665183301546938,0.9668715123260577,0.9672246944974218,0.9675778766687857,0.9679310588401497,0.9682842410115138,0.9686374231828777,0.9689906053542418,0.9693437875256057,0.9696969696969697,0.9700501518683337,0.9704033340396977,0.9707565162110616,0.9711096983824257,0.9714628805537896,0.9718160627251536,0.9721692448965176,0.9725224270678816,0.9728756092392455,0.9732287914106096,0.9735819735819736,0.9739351557533376,0.9742883379247016,0.9746415200960655,0.9749947022674296,0.9753478844387935,0.9757010666101575,0.9760542487815215,0.9764074309528855,0.9767606131242494,0.9771137952956135,0.9774669774669774,0.9778201596383415,0.9781733418097054,0.9785265239810694,0.9788797061524335,0.9792328883237974,0.9795860704951614,0.9799392526665254,0.9802924348378894,0.9806456170092533,0.9809987991806174,0.9813519813519813,0.9817051635233454,0.9820583456947093,0.9824115278660733,0.9827647100374373,0.9831178922088013,0.9834710743801653,0.9838242565515293,0.9841774387228933,0.9845306208942572,0.9848838030656213,0.9852369852369852,0.9855901674083493,0.9859433495797132,0.9862965317510772,0.9866497139224412,0.9870028960938052,0.9873560782651691,0.9877092604365332,0.9880624426078972,0.9884156247792611,0.9887688069506252,0.9891219891219891,0.9894751712933532,0.9898283534647171,0.9901815356360811,0.9905347178074451,0.9908878999788091,0.991241082150173,0.9915942643215371,0.991947446492901,0.992300628664265,0.992653810835629,0.993006993006993],"y":[0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.16666666666666666,0.3333333333333333,0.3333333333333333,0.3333333333333333,0.3333333333333333,0.3333333333333333,0.3333333333333333,0.3333333333333333,0.3333333333333333,0.3333333333333333,0.3333333333333333,0.3333333333333333,0.3333333333333333,0.3333333333333333,0.3333333333333333,0.3333333333333333,0.3333333333333333,0.3333333333333333,0.3333333333333333,0.3333333333333333,0.3333333333333333,0.5833333333333334,0.5833333333333334,0.5833333333333334,0.5833333333333334,0.5833333333333334,0.5833333333333334,0.5833333333333334,0.5833333333333334,0.5833333333333334,0.5833333333333334,0.5833333333333334,0.5833333333333334,0.5833333333333334,0.5833333333333334,0.5833333333333334,0.5833333333333334,0.5833333333333334,0.5833333333333334,0.5833333333333334,0.5833333333333334,0.9166666666666666,0.9166666666666666,0.9166666666666666,0.9166666666666666,0.9166666666666666,0.9166666666666666,0.9166666666666666,0.9166666666666666,0.9166666666666666,0.9166666666666666,0.9166666666666666,0.9166666666666666,0.9166666666666666,0.9166666666666666,0.9166666666666666,0.9166666666666666,0.9166666666666666,0.9166666666666666,0.9166666666666666,1.0],"type":"scatter"}],                        {"title":{"text":"Empirical Distribution Function Plot"},"xaxis":{"title":{"text":"Objective Value"}},"yaxis":{"title":{"text":"Cumulative Probability"},"range":[0,1]},"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}}},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
<br />
<br /><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  5.446 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-tutorial-10-key-features-005-visualization-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="_downloads/254ea7c8c90be4a81448b957579b796c/005_visualization.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">005_visualization.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="_downloads/1f693b2e373774312e66b0c8f033b8a9/005_visualization.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">005_visualization.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>
</div>
</section>
<span id="document-tutorial/20_recipes/index"></span><section id="recipes">
<span id="sphx-glr-tutorial-20-recipes"></span><span id="id1"></span><h5>Recipes<a class="headerlink" href="#recipes" title="Permalink to this heading"></a></h5>
<p>Showcases the recipes that might help you using Optuna with comfort.</p>
<div class="sphx-glr-thumbnails"><div class="sphx-glr-thumbcontainer" tooltip="An RDB backend enables persistent experiments (i.e., to save and resume a study) as well as acc..."><img alt="" src="_images/sphx_glr_001_rdb_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-20-recipes-001-rdb-py"><span class="std std-ref">Saving/Resuming Study with RDB Backend</span></a></p>
  <div class="sphx-glr-thumbnail-title">Saving/Resuming Study with RDB Backend</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This tutorial showcases Optuna&#x27;s multi-objective optimization feature by optimizing the validat..."><img alt="" src="_images/sphx_glr_002_multi_objective_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-20-recipes-002-multi-objective-py"><span class="std std-ref">Multi-objective Optimization with Optuna</span></a></p>
  <div class="sphx-glr-thumbnail-title">Multi-objective Optimization with Optuna</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This feature is to annotate experiments with user-defined attributes."><img alt="" src="_images/sphx_glr_003_attributes_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-20-recipes-003-attributes-py"><span class="std std-ref">User Attributes</span></a></p>
  <div class="sphx-glr-thumbnail-title">User Attributes</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="    ask, Create a new trial and suggest parameters.     best-trial, Show the best trial.     be..."><img alt="" src="_images/sphx_glr_004_cli_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-20-recipes-004-cli-py"><span class="std std-ref">Command-Line Interface</span></a></p>
  <div class="sphx-glr-thumbnail-title">Command-Line Interface</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Thanks to user-defined samplers, you can:"><img alt="" src="_images/sphx_glr_005_user_defined_sampler_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-20-recipes-005-user-defined-sampler-py"><span class="std std-ref">User-Defined Sampler</span></a></p>
  <div class="sphx-glr-thumbnail-title">User-Defined Sampler</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="In optuna.pruners, we described how an objective function can optionally include calls to a pru..."><img alt="" src="_images/sphx_glr_006_user_defined_pruner_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-20-recipes-006-user-defined-pruner-py"><span class="std std-ref">User-Defined Pruner</span></a></p>
  <div class="sphx-glr-thumbnail-title">User-Defined Pruner</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="This tutorial showcases how to use &amp; implement Optuna Callback for optimize."><img alt="" src="_images/sphx_glr_007_optuna_callback_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-20-recipes-007-optuna-callback-py"><span class="std std-ref">Callback for Study.optimize</span></a></p>
  <div class="sphx-glr-thumbnail-title">Callback for Study.optimize</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="It&#x27;s natural that you have some specific sets of hyperparameters to try first such as initial l..."><img alt="" src="_images/sphx_glr_008_specify_params_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-20-recipes-008-specify-params-py"><span class="std std-ref">Specify Hyperparameters Manually</span></a></p>
  <div class="sphx-glr-thumbnail-title">Specify Hyperparameters Manually</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="Optuna has an Ask-and-Tell interface, which provides a more flexible interface for hyperparamet..."><img alt="" src="_images/sphx_glr_009_ask_and_tell_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-20-recipes-009-ask-and-tell-py"><span class="std std-ref">Ask-and-Tell Interface</span></a></p>
  <div class="sphx-glr-thumbnail-title">Ask-and-Tell Interface</div>
</div><div class="sphx-glr-thumbcontainer" tooltip="In some cases, you may want to re-evaluate the objective function with the best hyperparameters..."><img alt="" src="_images/sphx_glr_010_reuse_best_trial_thumb.png" />
<p><a class="reference internal" href="index.html#sphx-glr-tutorial-20-recipes-010-reuse-best-trial-py"><span class="std std-ref">Re-use the best trial</span></a></p>
  <div class="sphx-glr-thumbnail-title">Re-use the best trial</div>
</div></div><div class="toctree-wrapper compound">
<span id="document-tutorial/20_recipes/001_rdb"></span><div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-tutorial-20-recipes-001-rdb-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="saving-resuming-study-with-rdb-backend">
<span id="rdb"></span><span id="sphx-glr-tutorial-20-recipes-001-rdb-py"></span><h6>Saving/Resuming Study with RDB Backend<a class="headerlink" href="#saving-resuming-study-with-rdb-backend" title="Permalink to this heading"></a></h6>
<p>An RDB backend enables persistent experiments (i.e., to save and resume a study) as well as access to history of studies.
In addition, we can run multi-node optimization tasks with this feature, which is described in <a class="reference internal" href="index.html#distributed"><span class="std std-ref">4. Easy Parallelization</span></a>.</p>
<p>In this section, let’s try simple examples running on a local environment with SQLite DB.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can also utilize other RDB backends, e.g., PostgreSQL or MySQL, by setting the storage argument to the DB’s URL.
Please refer to <a class="reference external" href="https://docs.sqlalchemy.org/en/latest/core/engines.html#database-urls">SQLAlchemy’s document</a> for how to set up the URL.</p>
</div>
<section id="new-study">
<h6 aria-level="7">New Study<a class="headerlink" href="#new-study" title="Permalink to this heading"></a></h6>
<p>We can create a persistent study by calling <a class="reference internal" href="index.html#optuna.study.create_study" title="optuna.study.create_study"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_study()</span></code></a> function as follows.
An SQLite file <code class="docutils literal notranslate"><span class="pre">example.db</span></code> is automatically initialized with a new study record.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="kn">import</span> <span class="nn">optuna</span>

<span class="c1"># Add stream handler of stdout to show the messages</span>
<span class="n">optuna</span><span class="o">.</span><span class="n">logging</span><span class="o">.</span><span class="n">get_logger</span><span class="p">(</span><span class="s2">&quot;optuna&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">))</span>
<span class="n">study_name</span> <span class="o">=</span> <span class="s2">&quot;example-study&quot;</span>  <span class="c1"># Unique identifier of the study.</span>
<span class="n">storage_name</span> <span class="o">=</span> <span class="s2">&quot;sqlite:///</span><span class="si">{}</span><span class="s2">.db&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">study_name</span><span class="p">)</span>
<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">study_name</span><span class="o">=</span><span class="n">study_name</span><span class="p">,</span> <span class="n">storage</span><span class="o">=</span><span class="n">storage_name</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>A new study created in RDB with name: example-study
</pre></div>
</div>
<p>To run a study, call <a class="reference internal" href="index.html#optuna.study.Study.optimize" title="optuna.study.Study.optimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">optimize()</span></code></a> method passing an objective function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>


<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Trial 0 finished with value: 14.907776705038987 and parameters: {&#39;x&#39;: 5.861059013410568}. Best is trial 0 with value: 14.907776705038987.
Trial 1 finished with value: 54.878085558884706 and parameters: {&#39;x&#39;: -5.407974457224101}. Best is trial 0 with value: 14.907776705038987.
Trial 2 finished with value: 78.8695625971453 and parameters: {&#39;x&#39;: -6.880853708802173}. Best is trial 0 with value: 14.907776705038987.
</pre></div>
</div>
</section>
<section id="resume-study">
<h6 aria-level="7">Resume Study<a class="headerlink" href="#resume-study" title="Permalink to this heading"></a></h6>
<p>To resume a study, instantiate a <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a> object
passing the study name <code class="docutils literal notranslate"><span class="pre">example-study</span></code> and the DB URL <code class="docutils literal notranslate"><span class="pre">sqlite:///example-study.db</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">study_name</span><span class="o">=</span><span class="n">study_name</span><span class="p">,</span> <span class="n">storage</span><span class="o">=</span><span class="n">storage_name</span><span class="p">,</span> <span class="n">load_if_exists</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Using an existing study with name &#39;example-study&#39; instead of creating a new one.
Trial 3 finished with value: 7.560499556743378 and parameters: {&#39;x&#39;: 4.749636258988337}. Best is trial 3 with value: 7.560499556743378.
Trial 4 finished with value: 9.302773679706686 and parameters: {&#39;x&#39;: -1.050044865195705}. Best is trial 3 with value: 7.560499556743378.
Trial 5 finished with value: 57.32185662762797 and parameters: {&#39;x&#39;: 9.571119905775365}. Best is trial 3 with value: 7.560499556743378.
</pre></div>
</div>
<p>Note that the storage doesn’t store the state of the instance of <a class="reference internal" href="index.html#module-optuna.samplers" title="optuna.samplers"><code class="xref py py-mod docutils literal notranslate"><span class="pre">samplers</span></code></a>.
When we resume a study with a sampler whose <code class="docutils literal notranslate"><span class="pre">seed</span></code> argument is specified for
reproducibility, you need to restore the sampler with using <code class="docutils literal notranslate"><span class="pre">pickle</span></code> as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pickle</span>

<span class="c1"># Save the sampler with pickle to be loaded later.</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;sampler.pkl&quot;</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fout</span><span class="p">:</span>
    <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">study</span><span class="o">.</span><span class="n">sampler</span><span class="p">,</span> <span class="n">fout</span><span class="p">)</span>

<span class="n">restored_sampler</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;sampler.pkl&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span><span class="p">))</span>
<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span>
    <span class="n">study_name</span><span class="o">=</span><span class="n">study_name</span><span class="p">,</span> <span class="n">storage</span><span class="o">=</span><span class="n">storage_name</span><span class="p">,</span> <span class="n">load_if_exists</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">sampler</span><span class="o">=</span><span class="n">restored_sampler</span>
<span class="p">)</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="experimental-history">
<h6 aria-level="7">Experimental History<a class="headerlink" href="#experimental-history" title="Permalink to this heading"></a></h6>
<p>We can access histories of studies and trials via the <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a> class.
For example, we can get all trials of <code class="docutils literal notranslate"><span class="pre">example-study</span></code> as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">study_name</span><span class="o">=</span><span class="n">study_name</span><span class="p">,</span> <span class="n">storage</span><span class="o">=</span><span class="n">storage_name</span><span class="p">,</span> <span class="n">load_if_exists</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">trials_dataframe</span><span class="p">(</span><span class="n">attrs</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;number&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">,</span> <span class="s2">&quot;params&quot;</span><span class="p">,</span> <span class="s2">&quot;state&quot;</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Using an existing study with name &#39;example-study&#39; instead of creating a new one.
</pre></div>
</div>
<p>The method <a class="reference internal" href="index.html#optuna.study.Study.trials_dataframe" title="optuna.study.Study.trials_dataframe"><code class="xref py py-func docutils literal notranslate"><span class="pre">trials_dataframe()</span></code></a> returns a pandas dataframe like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>   number      value  params_x     state
0       0  14.907777  5.861059  COMPLETE
1       1  54.878086 -5.407974  COMPLETE
2       2  78.869563 -6.880854  COMPLETE
3       3   7.560500  4.749636  COMPLETE
4       4   9.302774 -1.050045  COMPLETE
5       5  57.321857  9.571120  COMPLETE
</pre></div>
</div>
<p>A <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a> object also provides properties
such as <a class="reference internal" href="index.html#optuna.study.Study.trials" title="optuna.study.Study.trials"><code class="xref py py-attr docutils literal notranslate"><span class="pre">trials</span></code></a>, <a class="reference internal" href="index.html#optuna.study.Study.best_value" title="optuna.study.Study.best_value"><code class="xref py py-attr docutils literal notranslate"><span class="pre">best_value</span></code></a>,
<a class="reference internal" href="index.html#optuna.study.Study.best_params" title="optuna.study.Study.best_params"><code class="xref py py-attr docutils literal notranslate"><span class="pre">best_params</span></code></a> (see also <a class="reference internal" href="index.html#first"><span class="std std-ref">1. Lightweight, versatile, and platform agnostic architecture</span></a>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best params: &quot;</span><span class="p">,</span> <span class="n">study</span><span class="o">.</span><span class="n">best_params</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best value: &quot;</span><span class="p">,</span> <span class="n">study</span><span class="o">.</span><span class="n">best_value</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best Trial: &quot;</span><span class="p">,</span> <span class="n">study</span><span class="o">.</span><span class="n">best_trial</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Trials: &quot;</span><span class="p">,</span> <span class="n">study</span><span class="o">.</span><span class="n">trials</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Best params:  {&#39;x&#39;: 4.749636258988337}
Best value:  7.560499556743378
Best Trial:  FrozenTrial(number=3, state=TrialState.COMPLETE, values=[7.560499556743378], datetime_start=datetime.datetime(2023, 3, 17, 6, 24, 10, 299327), datetime_complete=datetime.datetime(2023, 3, 17, 6, 24, 10, 319682), params={&#39;x&#39;: 4.749636258988337}, user_attrs={}, system_attrs={}, intermediate_values={}, distributions={&#39;x&#39;: FloatDistribution(high=10.0, log=False, low=-10.0, step=None)}, trial_id=4, value=None)
Trials:  [FrozenTrial(number=0, state=TrialState.COMPLETE, values=[14.907776705038987], datetime_start=datetime.datetime(2023, 3, 17, 6, 24, 10, 140343), datetime_complete=datetime.datetime(2023, 3, 17, 6, 24, 10, 164035), params={&#39;x&#39;: 5.861059013410568}, user_attrs={}, system_attrs={}, intermediate_values={}, distributions={&#39;x&#39;: FloatDistribution(high=10.0, log=False, low=-10.0, step=None)}, trial_id=1, value=None), FrozenTrial(number=1, state=TrialState.COMPLETE, values=[54.878085558884706], datetime_start=datetime.datetime(2023, 3, 17, 6, 24, 10, 188037), datetime_complete=datetime.datetime(2023, 3, 17, 6, 24, 10, 205672), params={&#39;x&#39;: -5.407974457224101}, user_attrs={}, system_attrs={}, intermediate_values={}, distributions={&#39;x&#39;: FloatDistribution(high=10.0, log=False, low=-10.0, step=None)}, trial_id=2, value=None), FrozenTrial(number=2, state=TrialState.COMPLETE, values=[78.8695625971453], datetime_start=datetime.datetime(2023, 3, 17, 6, 24, 10, 221964), datetime_complete=datetime.datetime(2023, 3, 17, 6, 24, 10, 236920), params={&#39;x&#39;: -6.880853708802173}, user_attrs={}, system_attrs={}, intermediate_values={}, distributions={&#39;x&#39;: FloatDistribution(high=10.0, log=False, low=-10.0, step=None)}, trial_id=3, value=None), FrozenTrial(number=3, state=TrialState.COMPLETE, values=[7.560499556743378], datetime_start=datetime.datetime(2023, 3, 17, 6, 24, 10, 299327), datetime_complete=datetime.datetime(2023, 3, 17, 6, 24, 10, 319682), params={&#39;x&#39;: 4.749636258988337}, user_attrs={}, system_attrs={}, intermediate_values={}, distributions={&#39;x&#39;: FloatDistribution(high=10.0, log=False, low=-10.0, step=None)}, trial_id=4, value=None), FrozenTrial(number=4, state=TrialState.COMPLETE, values=[9.302773679706686], datetime_start=datetime.datetime(2023, 3, 17, 6, 24, 10, 339756), datetime_complete=datetime.datetime(2023, 3, 17, 6, 24, 10, 356084), params={&#39;x&#39;: -1.050044865195705}, user_attrs={}, system_attrs={}, intermediate_values={}, distributions={&#39;x&#39;: FloatDistribution(high=10.0, log=False, low=-10.0, step=None)}, trial_id=5, value=None), FrozenTrial(number=5, state=TrialState.COMPLETE, values=[57.32185662762797], datetime_start=datetime.datetime(2023, 3, 17, 6, 24, 10, 372161), datetime_complete=datetime.datetime(2023, 3, 17, 6, 24, 10, 388040), params={&#39;x&#39;: 9.571119905775365}, user_attrs={}, system_attrs={}, intermediate_values={}, distributions={&#39;x&#39;: FloatDistribution(high=10.0, log=False, low=-10.0, step=None)}, trial_id=6, value=None)]
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.660 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-tutorial-20-recipes-001-rdb-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="_downloads/b73c661c07098863641f4ba78170b234/001_rdb.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">001_rdb.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="_downloads/29dc01fa0a6cc866899e95e53fbf9e2f/001_rdb.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">001_rdb.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>
<span id="document-tutorial/20_recipes/002_multi_objective"></span><div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-tutorial-20-recipes-002-multi-objective-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="multi-objective-optimization-with-optuna">
<span id="multi-objective"></span><span id="sphx-glr-tutorial-20-recipes-002-multi-objective-py"></span><h6>Multi-objective Optimization with Optuna<a class="headerlink" href="#multi-objective-optimization-with-optuna" title="Permalink to this heading"></a></h6>
<p>This tutorial showcases Optuna’s multi-objective optimization feature by
optimizing the validation accuracy of Fashion MNIST dataset and the FLOPS of the model implemented in PyTorch.</p>
<p>We use <a class="reference external" href="https://github.com/facebookresearch/fvcore">fvcore</a> to measure FLOPS.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="kn">import</span> <span class="nn">torchvision</span>
<span class="kn">from</span> <span class="nn">fvcore.nn</span> <span class="kn">import</span> <span class="n">FlopCountAnalysis</span>

<span class="kn">import</span> <span class="nn">optuna</span>


<span class="n">DEVICE</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cuda&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s2">&quot;cpu&quot;</span><span class="p">)</span>
<span class="n">DIR</span> <span class="o">=</span> <span class="s2">&quot;..&quot;</span>
<span class="n">BATCHSIZE</span> <span class="o">=</span> <span class="mi">128</span>
<span class="n">N_TRAIN_EXAMPLES</span> <span class="o">=</span> <span class="n">BATCHSIZE</span> <span class="o">*</span> <span class="mi">30</span>
<span class="n">N_VALID_EXAMPLES</span> <span class="o">=</span> <span class="n">BATCHSIZE</span> <span class="o">*</span> <span class="mi">10</span>


<span class="k">def</span> <span class="nf">define_model</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="n">n_layers</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_int</span><span class="p">(</span><span class="s2">&quot;n_layers&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="n">layers</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="n">in_features</span> <span class="o">=</span> <span class="mi">28</span> <span class="o">*</span> <span class="mi">28</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_layers</span><span class="p">):</span>
        <span class="n">out_features</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_int</span><span class="p">(</span><span class="s2">&quot;n_units_l</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="p">,</span> <span class="n">out_features</span><span class="p">))</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">())</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;dropout_</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
        <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Dropout</span><span class="p">(</span><span class="n">p</span><span class="p">))</span>

        <span class="n">in_features</span> <span class="o">=</span> <span class="n">out_features</span>

    <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
    <span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">LogSoftmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span><span class="o">*</span><span class="n">layers</span><span class="p">)</span>


<span class="c1"># Defines training and evaluation.</span>
<span class="k">def</span> <span class="nf">train_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">train_loader</span><span class="p">):</span>
    <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">train_loader</span><span class="p">):</span>
        <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span> <span class="o">*</span> <span class="mi">28</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">),</span> <span class="n">target</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
        <span class="n">F</span><span class="o">.</span><span class="n">nll_loss</span><span class="p">(</span><span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">target</span><span class="p">)</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
        <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>


<span class="k">def</span> <span class="nf">eval_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">valid_loader</span><span class="p">):</span>
    <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
        <span class="k">for</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">valid_loader</span><span class="p">):</span>
            <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span> <span class="o">*</span> <span class="mi">28</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">),</span> <span class="n">target</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>
            <span class="n">pred</span> <span class="o">=</span> <span class="n">model</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">correct</span> <span class="o">+=</span> <span class="n">pred</span><span class="o">.</span><span class="n">eq</span><span class="p">(</span><span class="n">target</span><span class="o">.</span><span class="n">view_as</span><span class="p">(</span><span class="n">pred</span><span class="p">))</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">correct</span> <span class="o">/</span> <span class="n">N_VALID_EXAMPLES</span>

    <span class="n">flops</span> <span class="o">=</span> <span class="n">FlopCountAnalysis</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">inputs</span><span class="o">=</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span> <span class="o">*</span> <span class="mi">28</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">),))</span><span class="o">.</span><span class="n">total</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">flops</span><span class="p">,</span> <span class="n">accuracy</span>
</pre></div>
</div>
<p>Define multi-objective objective function.
Objectives are FLOPS and accuracy.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="n">train_dataset</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">FashionMNIST</span><span class="p">(</span>
        <span class="n">DIR</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">torchvision</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">train_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Subset</span><span class="p">(</span><span class="n">train_dataset</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">N_TRAIN_EXAMPLES</span><span class="p">))),</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCHSIZE</span><span class="p">,</span>
        <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">val_dataset</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">FashionMNIST</span><span class="p">(</span>
        <span class="n">DIR</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">torchvision</span><span class="o">.</span><span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">val_loader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
        <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Subset</span><span class="p">(</span><span class="n">val_dataset</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">N_VALID_EXAMPLES</span><span class="p">))),</span>
        <span class="n">batch_size</span><span class="o">=</span><span class="n">BATCHSIZE</span><span class="p">,</span>
        <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">define_model</span><span class="p">(</span><span class="n">trial</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">DEVICE</span><span class="p">)</span>

    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span>
        <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;lr&quot;</span><span class="p">,</span> <span class="mf">1e-5</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="p">)</span>

    <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">train_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">train_loader</span><span class="p">)</span>
    <span class="n">flops</span><span class="p">,</span> <span class="n">accuracy</span> <span class="o">=</span> <span class="n">eval_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">val_loader</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">flops</span><span class="p">,</span> <span class="n">accuracy</span>
</pre></div>
</div>
<section id="run-multi-objective-optimization">
<h6 aria-level="7">Run multi-objective optimization<a class="headerlink" href="#run-multi-objective-optimization" title="Permalink to this heading"></a></h6>
<p>If your optimization problem is multi-objective,
Optuna assumes that you will specify the optimization direction for each objective.
Specifically, in this example, we want to minimize the FLOPS (we want a faster model)
and maximize the accuracy. So we set <code class="docutils literal notranslate"><span class="pre">directions</span></code> to <code class="docutils literal notranslate"><span class="pre">[&quot;minimize&quot;,</span> <span class="pre">&quot;maximize&quot;]</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">directions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;minimize&quot;</span><span class="p">,</span> <span class="s2">&quot;maximize&quot;</span><span class="p">])</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">300</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of finished trials: &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">study</span><span class="o">.</span><span class="n">trials</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/train-images-idx3-ubyte.gz
Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/train-images-idx3-ubyte.gz to ../FashionMNIST/raw/train-images-idx3-ubyte.gz

  0%|          | 0/26421880 [00:00&lt;?, ?it/s]
  0%|          | 40960/26421880 [00:00&lt;01:14, 355859.59it/s]
  0%|          | 92160/26421880 [00:00&lt;00:59, 441427.32it/s]
  1%|          | 200704/26421880 [00:00&lt;00:36, 724131.73it/s]
  2%|1         | 418816/26421880 [00:00&lt;00:20, 1284893.11it/s]
  3%|3         | 849920/26421880 [00:00&lt;00:10, 2356005.41it/s]
  6%|6         | 1704960/26421880 [00:00&lt;00:05, 4433630.19it/s]
 12%|#2        | 3283968/26421880 [00:00&lt;00:02, 8105174.65it/s]
 18%|#8        | 4831232/26421880 [00:00&lt;00:02, 10417265.98it/s]
 24%|##4       | 6377472/26421880 [00:00&lt;00:01, 11970333.50it/s]
 30%|##9       | 7923712/26421880 [00:01&lt;00:01, 13024979.80it/s]
 36%|###5      | 9470976/26421880 [00:01&lt;00:01, 13750596.78it/s]
 42%|####1     | 11017216/26421880 [00:01&lt;00:01, 14250878.57it/s]
 48%|####7     | 12563456/26421880 [00:01&lt;00:00, 14597701.46it/s]
 53%|#####3    | 14109696/26421880 [00:01&lt;00:00, 14839467.62it/s]
 60%|#####9    | 15721472/26421880 [00:01&lt;00:00, 15190469.62it/s]
 66%|######5   | 17332224/26421880 [00:01&lt;00:00, 15449324.10it/s]
 72%|#######1  | 18942976/26421880 [00:01&lt;00:00, 15626175.24it/s]
 78%|#######7  | 20553728/26421880 [00:01&lt;00:00, 15748963.56it/s]
 84%|########3 | 22165504/26421880 [00:01&lt;00:00, 15838718.75it/s]
 90%|########9 | 23776256/26421880 [00:02&lt;00:00, 15899940.22it/s]
 96%|#########6| 25387008/26421880 [00:02&lt;00:00, 15942373.00it/s]
26422272it [00:02, 11929102.17it/s]
Extracting ../FashionMNIST/raw/train-images-idx3-ubyte.gz to ../FashionMNIST/raw

Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/train-labels-idx1-ubyte.gz
Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/train-labels-idx1-ubyte.gz to ../FashionMNIST/raw/train-labels-idx1-ubyte.gz

  0%|          | 0/29515 [00:00&lt;?, ?it/s]
 42%|####1     | 12288/29515 [00:00&lt;00:00, 122856.98it/s]
29696it [00:00, 295351.95it/s]
Extracting ../FashionMNIST/raw/train-labels-idx1-ubyte.gz to ../FashionMNIST/raw

Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/t10k-images-idx3-ubyte.gz
Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/t10k-images-idx3-ubyte.gz to ../FashionMNIST/raw/t10k-images-idx3-ubyte.gz

  0%|          | 0/4422102 [00:00&lt;?, ?it/s]
  0%|          | 19456/4422102 [00:00&lt;00:22, 194555.55it/s]
  1%|          | 44032/4422102 [00:00&lt;00:19, 224194.90it/s]
  2%|2         | 104448/4422102 [00:00&lt;00:10, 396729.64it/s]
  5%|4         | 212992/4422102 [00:00&lt;00:06, 667000.74it/s]
 10%|#         | 442368/4422102 [00:00&lt;00:03, 1250276.95it/s]
 20%|##        | 900096/4422102 [00:00&lt;00:01, 2374886.49it/s]
 41%|####1     | 1816576/4422102 [00:00&lt;00:00, 4582806.52it/s]
 77%|#######7  | 3411968/4422102 [00:00&lt;00:00, 8182346.76it/s]
4422656it [00:00, 5387818.79it/s]
Extracting ../FashionMNIST/raw/t10k-images-idx3-ubyte.gz to ../FashionMNIST/raw

Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/t10k-labels-idx1-ubyte.gz
Downloading http://fashion-mnist.s3-website.eu-central-1.amazonaws.com/t10k-labels-idx1-ubyte.gz to ../FashionMNIST/raw/t10k-labels-idx1-ubyte.gz

  0%|          | 0/5148 [00:00&lt;?, ?it/s]
6144it [00:00, 32051994.75it/s]
Extracting ../FashionMNIST/raw/t10k-labels-idx1-ubyte.gz to ../FashionMNIST/raw

Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Unsupported operator aten::log_softmax encountered 1 time(s)
Number of finished trials:  30
</pre></div>
</div>
<p>Check trials on Pareto front visually.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">optuna</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">plot_pareto_front</span><span class="p">(</span><span class="n">study</span><span class="p">,</span> <span class="n">target_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;FLOPS&quot;</span><span class="p">,</span> <span class="s2">&quot;accuracy&quot;</span><span class="p">])</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-2.18.2.min.js"></script>                <div id="57b8c979-ef12-4b24-8f50-2867d8353523" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("57b8c979-ef12-4b24-8f50-2867d8353523")) {                    Plotly.newPlot(                        "57b8c979-ef12-4b24-8f50-2867d8353523",                        [{"hovertemplate":"%{text}<extra>Trial</extra>","marker":{"color":[0,1,2,3,4,5,6,9,10,11,12,13,15,16,17,18,19,21,23,24,25,26,28,29],"colorbar":{"title":{"text":"Trial"}},"colorscale":[[0.0,"rgb(247,251,255)"],[0.125,"rgb(222,235,247)"],[0.25,"rgb(198,219,239)"],[0.375,"rgb(158,202,225)"],[0.5,"rgb(107,174,214)"],[0.625,"rgb(66,146,198)"],[0.75,"rgb(33,113,181)"],[0.875,"rgb(8,81,156)"],[1.0,"rgb(8,48,107)"]],"line":{"color":"Grey","width":0.5}},"mode":"markers","showlegend":false,"text":["{<br>  \"number\": 0,<br>  \"values\": [<br>    50051.0,<br>    0.7640625<br>  ],<br>  \"params\": {<br>    \"n_layers\": 2,<br>    \"n_units_l0\": 59,<br>    \"dropout_0\": 0.48650556646240417,<br>    \"n_units_l1\": 55,<br>    \"dropout_1\": 0.4484979767042558,<br>    \"lr\": 0.0009038135532775867<br>  }<br>}","{<br>  \"number\": 1,<br>  \"values\": [<br>    80900.0,<br>    0.759375<br>  ],<br>  \"params\": {<br>    \"n_layers\": 2,<br>    \"n_units_l0\": 92,<br>    \"dropout_0\": 0.32804688594585085,<br>    \"n_units_l1\": 86,<br>    \"dropout_1\": 0.2630018667077296,<br>    \"lr\": 0.0003923119898333376<br>  }<br>}","{<br>  \"number\": 2,<br>  \"values\": [<br>    47640.0,<br>    0.78125<br>  ],<br>  \"params\": {<br>    \"n_layers\": 1,<br>    \"n_units_l0\": 60,<br>    \"dropout_0\": 0.2084678761021624,<br>    \"lr\": 0.0004143235592749655<br>  }<br>}","{<br>  \"number\": 3,<br>  \"values\": [<br>    26480.0,<br>    0.7765625<br>  ],<br>  \"params\": {<br>    \"n_layers\": 2,<br>    \"n_units_l0\": 29,<br>    \"dropout_0\": 0.41904021317308715,<br>    \"n_units_l1\": 96,<br>    \"dropout_1\": 0.39280905472387734,<br>    \"lr\": 0.007790774452319139<br>  }<br>}","{<br>  \"number\": 4,<br>  \"values\": [<br>    70162.0,<br>    0.459375<br>  ],<br>  \"params\": {<br>    \"n_layers\": 2,<br>    \"n_units_l0\": 76,<br>    \"dropout_0\": 0.20957901450935776,<br>    \"n_units_l1\": 123,<br>    \"dropout_1\": 0.3137679782483646,<br>    \"lr\": 1.4593125626605677e-05<br>  }<br>}","{<br>  \"number\": 5,<br>  \"values\": [<br>    115965.0,<br>    0.45703125<br>  ],<br>  \"params\": {<br>    \"n_layers\": 3,<br>    \"n_units_l0\": 118,<br>    \"dropout_0\": 0.3240467913989897,<br>    \"n_units_l1\": 109,<br>    \"dropout_1\": 0.4107708632394591,<br>    \"n_units_l2\": 89,<br>    \"dropout_2\": 0.29063130091803535,<br>    \"lr\": 3.872396249818108e-05<br>  }<br>}","{<br>  \"number\": 6,<br>  \"values\": [<br>    101620.0,<br>    0.8234375<br>  ],<br>  \"params\": {<br>    \"n_layers\": 2,<br>    \"n_units_l0\": 120,<br>    \"dropout_0\": 0.3578489505609102,<br>    \"n_units_l1\": 58,<br>    \"dropout_1\": 0.2783622972706656,<br>    \"lr\": 0.0021573442732569347<br>  }<br>}","{<br>  \"number\": 9,<br>  \"values\": [<br>    91944.0,<br>    0.09296875<br>  ],<br>  \"params\": {<br>    \"n_layers\": 3,<br>    \"n_units_l0\": 106,<br>    \"dropout_0\": 0.32576835170333196,<br>    \"n_units_l1\": 80,<br>    \"dropout_1\": 0.24157325724418896,<br>    \"n_units_l2\": 4,<br>    \"dropout_2\": 0.39064073710359626,<br>    \"lr\": 0.04810420235659839<br>  }<br>}","{<br>  \"number\": 10,<br>  \"values\": [<br>    38906.0,<br>    0.77109375<br>  ],<br>  \"params\": {<br>    \"n_layers\": 1,<br>    \"n_units_l0\": 49,<br>    \"dropout_0\": 0.2788959387804356,<br>    \"lr\": 0.00048001947411738987<br>  }<br>}","{<br>  \"number\": 11,<br>  \"values\": [<br>    103285.0,<br>    0.68828125<br>  ],<br>  \"params\": {<br>    \"n_layers\": 2,<br>    \"n_units_l0\": 117,<br>    \"dropout_0\": 0.4035133848207272,<br>    \"n_units_l1\": 91,<br>    \"dropout_1\": 0.46410133715279817,<br>    \"lr\": 0.028939854173765423<br>  }<br>}","{<br>  \"number\": 12,<br>  \"values\": [<br>    69078.0,<br>    0.825<br>  ],<br>  \"params\": {<br>    \"n_layers\": 1,<br>    \"n_units_l0\": 87,<br>    \"dropout_0\": 0.4402113193650293,<br>    \"lr\": 0.00947864024060773<br>  }<br>}","{<br>  \"number\": 13,<br>  \"values\": [<br>    99092.0,<br>    0.4328125<br>  ],<br>  \"params\": {<br>    \"n_layers\": 3,<br>    \"n_units_l0\": 114,<br>    \"dropout_0\": 0.41458943486643973,<br>    \"n_units_l1\": 49,<br>    \"dropout_1\": 0.39907418452037974,<br>    \"n_units_l2\": 70,<br>    \"dropout_2\": 0.3031484517535574,<br>    \"lr\": 0.045509697331146945<br>  }<br>}","{<br>  \"number\": 15,<br>  \"values\": [<br>    104360.0,<br>    0.7796875<br>  ],<br>  \"params\": {<br>    \"n_layers\": 2,<br>    \"n_units_l0\": 122,<br>    \"dropout_0\": 0.46465759819321917,<br>    \"n_units_l1\": 66,<br>    \"dropout_1\": 0.390308654784718,<br>    \"lr\": 0.01424023912992027<br>  }<br>}","{<br>  \"number\": 16,<br>  \"values\": [<br>    18496.0,<br>    0.48046875<br>  ],<br>  \"params\": {<br>    \"n_layers\": 2,<br>    \"n_units_l0\": 22,<br>    \"dropout_0\": 0.2978854657077904,<br>    \"n_units_l1\": 39,<br>    \"dropout_1\": 0.4000857403925646,<br>    \"lr\": 8.519317519978271e-05<br>  }<br>}","{<br>  \"number\": 17,<br>  \"values\": [<br>    67490.0,<br>    0.7796875<br>  ],<br>  \"params\": {<br>    \"n_layers\": 1,<br>    \"n_units_l0\": 85,<br>    \"dropout_0\": 0.39034135210900345,<br>    \"lr\": 0.00043628484814751457<br>  }<br>}","{<br>  \"number\": 18,<br>  \"values\": [<br>    72657.0,<br>    0.37265625<br>  ],<br>  \"params\": {<br>    \"n_layers\": 3,<br>    \"n_units_l0\": 78,<br>    \"dropout_0\": 0.4960134338635441,<br>    \"n_units_l1\": 53,<br>    \"dropout_1\": 0.24074306072747195,<br>    \"n_units_l2\": 117,<br>    \"dropout_2\": 0.44148772026443645,<br>    \"lr\": 5.268905180458328e-05<br>  }<br>}","{<br>  \"number\": 19,<br>  \"values\": [<br>    91310.0,<br>    0.5984375<br>  ],<br>  \"params\": {<br>    \"n_layers\": 1,<br>    \"n_units_l0\": 115,<br>    \"dropout_0\": 0.2968013873723431,<br>    \"lr\": 1.0117127733997394e-05<br>  }<br>}","{<br>  \"number\": 21,<br>  \"values\": [<br>    63042.0,<br>    0.7703125<br>  ],<br>  \"params\": {<br>    \"n_layers\": 2,<br>    \"n_units_l0\": 73,<br>    \"dropout_0\": 0.2578573569218159,<br>    \"n_units_l1\": 70,<br>    \"dropout_1\": 0.27540898681827175,<br>    \"lr\": 0.0004998964918328488<br>  }<br>}","{<br>  \"number\": 23,<br>  \"values\": [<br>    34248.0,<br>    0.08984375<br>  ],<br>  \"params\": {<br>    \"n_layers\": 3,<br>    \"n_units_l0\": 36,<br>    \"dropout_0\": 0.47496990366039826,<br>    \"n_units_l1\": 74,<br>    \"dropout_1\": 0.3684049897189099,<br>    \"n_units_l2\": 40,<br>    \"dropout_2\": 0.3638059233356884,<br>    \"lr\": 0.07981238473460664<br>  }<br>}","{<br>  \"number\": 24,<br>  \"values\": [<br>    66466.0,<br>    0.24296875<br>  ],<br>  \"params\": {<br>    \"n_layers\": 3,<br>    \"n_units_l0\": 83,<br>    \"dropout_0\": 0.49455471808503443,<br>    \"n_units_l1\": 6,<br>    \"dropout_1\": 0.3808458850163623,<br>    \"n_units_l2\": 56,<br>    \"dropout_2\": 0.35611813558515903,<br>    \"lr\": 2.003792780424968e-05<br>  }<br>}","{<br>  \"number\": 25,<br>  \"values\": [<br>    55451.0,<br>    0.8140625<br>  ],<br>  \"params\": {<br>    \"n_layers\": 2,<br>    \"n_units_l0\": 63,<br>    \"dropout_0\": 0.37951779827982224,<br>    \"n_units_l1\": 83,<br>    \"dropout_1\": 0.29633297880513954,<br>    \"lr\": 0.011028229650470529<br>  }<br>}","{<br>  \"number\": 26,<br>  \"values\": [<br>    84958.0,<br>    0.5265625<br>  ],<br>  \"params\": {<br>    \"n_layers\": 1,<br>    \"n_units_l0\": 107,<br>    \"dropout_0\": 0.30756898135120275,<br>    \"lr\": 0.0727157102369272<br>  }<br>}","{<br>  \"number\": 28,<br>  \"values\": [<br>    88604.0,<br>    0.64609375<br>  ],<br>  \"params\": {<br>    \"n_layers\": 2,<br>    \"n_units_l0\": 98,<br>    \"dropout_0\": 0.4521082052088059,<br>    \"n_units_l1\": 109,<br>    \"dropout_1\": 0.42965813846742085,<br>    \"lr\": 9.291523192287709e-05<br>  }<br>}","{<br>  \"number\": 29,<br>  \"values\": [<br>    36524.0,<br>    0.75078125<br>  ],<br>  \"params\": {<br>    \"n_layers\": 1,<br>    \"n_units_l0\": 46,<br>    \"dropout_0\": 0.26095332556453754,<br>    \"lr\": 0.0003275298903760039<br>  }<br>}"],"x":[50051.0,80900.0,47640.0,26480.0,70162.0,115965.0,101620.0,91944.0,38906.0,103285.0,69078.0,99092.0,104360.0,18496.0,67490.0,72657.0,91310.0,63042.0,34248.0,66466.0,55451.0,84958.0,88604.0,36524.0],"y":[0.7640625,0.759375,0.78125,0.7765625,0.459375,0.45703125,0.8234375,0.09296875,0.77109375,0.68828125,0.825,0.4328125,0.7796875,0.48046875,0.7796875,0.37265625,0.5984375,0.7703125,0.08984375,0.24296875,0.8140625,0.5265625,0.64609375,0.75078125],"type":"scatter"},{"hovertemplate":"%{text}<extra>Best Trial</extra>","marker":{"color":[7,8,14,20,22,27],"colorbar":{"title":{"text":"Best Trial"},"x":1.1,"xpad":40},"colorscale":[[0.0,"rgb(255,245,240)"],[0.125,"rgb(254,224,210)"],[0.25,"rgb(252,187,161)"],[0.375,"rgb(252,146,114)"],[0.5,"rgb(251,106,74)"],[0.625,"rgb(239,59,44)"],[0.75,"rgb(203,24,29)"],[0.875,"rgb(165,15,21)"],[1.0,"rgb(103,0,13)"]],"line":{"color":"Grey","width":0.5}},"mode":"markers","showlegend":false,"text":["{<br>  \"number\": 7,<br>  \"values\": [<br>    40494.0,<br>    0.80859375<br>  ],<br>  \"params\": {<br>    \"n_layers\": 1,<br>    \"n_units_l0\": 51,<br>    \"dropout_0\": 0.3128557360914351,<br>    \"lr\": 0.009959463763649899<br>  }<br>}","{<br>  \"number\": 8,<br>  \"values\": [<br>    45258.0,<br>    0.8171875<br>  ],<br>  \"params\": {<br>    \"n_layers\": 1,<br>    \"n_units_l0\": 57,<br>    \"dropout_0\": 0.22679027212962596,<br>    \"lr\": 0.0010094428910387462<br>  }<br>}","{<br>  \"number\": 14,<br>  \"values\": [<br>    17468.0,<br>    0.8046875<br>  ],<br>  \"params\": {<br>    \"n_layers\": 1,<br>    \"n_units_l0\": 22,<br>    \"dropout_0\": 0.2656536048698705,<br>    \"lr\": 0.011826575095575952<br>  }<br>}","{<br>  \"number\": 20,<br>  \"values\": [<br>    46846.0,<br>    0.8203125<br>  ],<br>  \"params\": {<br>    \"n_layers\": 1,<br>    \"n_units_l0\": 59,<br>    \"dropout_0\": 0.25196443225495113,<br>    \"lr\": 0.005343950533750113<br>  }<br>}","{<br>  \"number\": 22,<br>  \"values\": [<br>    66696.0,<br>    0.8296875<br>  ],<br>  \"params\": {<br>    \"n_layers\": 1,<br>    \"n_units_l0\": 84,<br>    \"dropout_0\": 0.3017067645967913,<br>    \"lr\": 0.0014660184656720171<br>  }<br>}","{<br>  \"number\": 27,<br>  \"values\": [<br>    13498.0,<br>    0.32109375<br>  ],<br>  \"params\": {<br>    \"n_layers\": 1,<br>    \"n_units_l0\": 17,<br>    \"dropout_0\": 0.48608680341072247,<br>    \"lr\": 5.849897531850647e-05<br>  }<br>}"],"x":[40494.0,45258.0,17468.0,46846.0,66696.0,13498.0],"y":[0.80859375,0.8171875,0.8046875,0.8203125,0.8296875,0.32109375],"type":"scatter"}],                        {"title":{"text":"Pareto-front Plot"},"xaxis":{"title":{"text":"FLOPS"}},"yaxis":{"title":{"text":"accuracy"}},"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}}},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
<br />
<br /><p>Fetch the list of trials on the Pareto front with <a class="reference internal" href="index.html#optuna.study.Study.best_trials" title="optuna.study.Study.best_trials"><code class="xref py py-attr docutils literal notranslate"><span class="pre">best_trials</span></code></a>.</p>
<p>For example, the following code shows the number of trials on the Pareto front and picks the trial with the highest accuracy.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of trials on the Pareto front: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">study</span><span class="o">.</span><span class="n">best_trials</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">trial_with_highest_accuracy</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">study</span><span class="o">.</span><span class="n">best_trials</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Trial with highest accuracy: &quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">number: </span><span class="si">{</span><span class="n">trial_with_highest_accuracy</span><span class="o">.</span><span class="n">number</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">params: </span><span class="si">{</span><span class="n">trial_with_highest_accuracy</span><span class="o">.</span><span class="n">params</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">values: </span><span class="si">{</span><span class="n">trial_with_highest_accuracy</span><span class="o">.</span><span class="n">values</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Number of trials on the Pareto front: 6
Trial with highest accuracy:
        number: 22
        params: {&#39;n_layers&#39;: 1, &#39;n_units_l0&#39;: 84, &#39;dropout_0&#39;: 0.3017067645967913, &#39;lr&#39;: 0.0014660184656720171}
        values: [66696.0, 0.8296875]
</pre></div>
</div>
<p>Learn which hyperparameters are affecting the flops most with hyperparameter importance.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">optuna</span><span class="o">.</span><span class="n">visualization</span><span class="o">.</span><span class="n">plot_param_importances</span><span class="p">(</span>
    <span class="n">study</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">target_name</span><span class="o">=</span><span class="s2">&quot;flops&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="output_subarea output_html rendered_html output_result">
<div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-2.18.2.min.js"></script>                <div id="56bd8e6a-1c8a-414d-ab59-19c6e4acf4ea" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("56bd8e6a-1c8a-414d-ab59-19c6e4acf4ea")) {                    Plotly.newPlot(                        "56bd8e6a-1c8a-414d-ab59-19c6e4acf4ea",                        [{"cliponaxis":false,"hovertemplate":["n_layers (IntDistribution): 0.0006432880830848733<extra></extra>","dropout_0 (FloatDistribution): 0.0011462575409900047<extra></extra>","lr (FloatDistribution): 0.0014260166982268056<extra></extra>","n_units_l0 (IntDistribution): 0.9967844376776983<extra></extra>"],"marker":{"color":"rgb(66,146,198)"},"orientation":"h","text":["<0.01","<0.01","<0.01","1.00"],"textposition":"outside","x":[0.0006432880830848733,0.0011462575409900047,0.0014260166982268056,0.9967844376776983],"y":["n_layers","dropout_0","lr","n_units_l0"],"type":"bar"}],                        {"showlegend":false,"title":{"text":"Hyperparameter Importances"},"xaxis":{"title":{"text":"Importance for flops"}},"yaxis":{"title":{"text":"Hyperparameter"}},"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}}},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
<br />
<br /><p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 1 minutes  58.695 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-tutorial-20-recipes-002-multi-objective-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="_downloads/82aa5c7e2a8d8749f9f6f65a6172eb9f/002_multi_objective.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">002_multi_objective.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="_downloads/a4ea522762978cb29312e091bc523c7a/002_multi_objective.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">002_multi_objective.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>
<span id="document-tutorial/20_recipes/003_attributes"></span><div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-tutorial-20-recipes-003-attributes-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="user-attributes">
<span id="attributes"></span><span id="sphx-glr-tutorial-20-recipes-003-attributes-py"></span><h6>User Attributes<a class="headerlink" href="#user-attributes" title="Permalink to this heading"></a></h6>
<p>This feature is to annotate experiments with user-defined attributes.</p>
<section id="adding-user-attributes-to-studies">
<h6 aria-level="7">Adding User Attributes to Studies<a class="headerlink" href="#adding-user-attributes-to-studies" title="Permalink to this heading"></a></h6>
<p>A <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a> object provides <a class="reference internal" href="index.html#optuna.study.Study.set_user_attr" title="optuna.study.Study.set_user_attr"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_user_attr()</span></code></a> method
to register a pair of key and value as an user-defined attribute.
A key is supposed to be a <code class="docutils literal notranslate"><span class="pre">str</span></code>, and a value be any object serializable with <code class="docutils literal notranslate"><span class="pre">json.dumps</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sklearn.datasets</span>
<span class="kn">import</span> <span class="nn">sklearn.model_selection</span>
<span class="kn">import</span> <span class="nn">sklearn.svm</span>

<span class="kn">import</span> <span class="nn">optuna</span>


<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">storage</span><span class="o">=</span><span class="s2">&quot;sqlite:///example.db&quot;</span><span class="p">)</span>
<span class="n">study</span><span class="o">.</span><span class="n">set_user_attr</span><span class="p">(</span><span class="s2">&quot;contributors&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;Akiba&quot;</span><span class="p">,</span> <span class="s2">&quot;Sano&quot;</span><span class="p">])</span>
<span class="n">study</span><span class="o">.</span><span class="n">set_user_attr</span><span class="p">(</span><span class="s2">&quot;dataset&quot;</span><span class="p">,</span> <span class="s2">&quot;MNIST&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>We can access annotated attributes with <a class="reference internal" href="index.html#optuna.study.Study.user_attrs" title="optuna.study.Study.user_attrs"><code class="xref py py-attr docutils literal notranslate"><span class="pre">user_attrs</span></code></a> property.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">study</span><span class="o">.</span><span class="n">user_attrs</span>  <span class="c1"># {&#39;contributors&#39;: [&#39;Akiba&#39;, &#39;Sano&#39;], &#39;dataset&#39;: &#39;MNIST&#39;}</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;contributors&#39;: [&#39;Akiba&#39;, &#39;Sano&#39;], &#39;dataset&#39;: &#39;MNIST&#39;}
</pre></div>
</div>
<p><a class="reference internal" href="index.html#optuna.study.StudySummary" title="optuna.study.StudySummary"><code class="xref py py-class docutils literal notranslate"><span class="pre">StudySummary</span></code></a> object, which can be retrieved by
<a class="reference internal" href="index.html#optuna.study.get_all_study_summaries" title="optuna.study.get_all_study_summaries"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_all_study_summaries()</span></code></a>, also contains user-defined attributes.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">study_summaries</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">get_all_study_summaries</span><span class="p">(</span><span class="s2">&quot;sqlite:///example.db&quot;</span><span class="p">)</span>
<span class="n">study_summaries</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">user_attrs</span>  <span class="c1"># {&quot;contributors&quot;: [&quot;Akiba&quot;, &quot;Sano&quot;], &quot;dataset&quot;: &quot;MNIST&quot;}</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;contributors&#39;: [&#39;Akiba&#39;, &#39;Sano&#39;], &#39;dataset&#39;: &#39;MNIST&#39;}
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><code class="docutils literal notranslate"><span class="pre">optuna</span> <span class="pre">study</span> <span class="pre">set-user-attr</span></code> command, which sets an attribute via command line interface.</p>
</div>
</section>
<section id="adding-user-attributes-to-trials">
<h6 aria-level="7">Adding User Attributes to Trials<a class="headerlink" href="#adding-user-attributes-to-trials" title="Permalink to this heading"></a></h6>
<p>As with <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a>, a <a class="reference internal" href="index.html#optuna.trial.Trial" title="optuna.trial.Trial"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trial</span></code></a> object provides
<a class="reference internal" href="index.html#optuna.trial.Trial.set_user_attr" title="optuna.trial.Trial.set_user_attr"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_user_attr()</span></code></a> method.
Attributes are set inside an objective function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="n">iris</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">()</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span>

    <span class="n">svc_c</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;svc_c&quot;</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="mf">1e10</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="n">svc_c</span><span class="p">)</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">model_selection</span><span class="o">.</span><span class="n">cross_val_score</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

    <span class="n">trial</span><span class="o">.</span><span class="n">set_user_attr</span><span class="p">(</span><span class="s2">&quot;accuracy&quot;</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">)</span>

    <span class="k">return</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">accuracy</span>  <span class="c1"># return error for minimization</span>


<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>We can access annotated attributes as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">study</span><span class="o">.</span><span class="n">trials</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">user_attrs</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>{&#39;accuracy&#39;: 0.9266666666666667}
</pre></div>
</div>
<p>Note that, in this example, the attribute is not annotated to a <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a>
but a single <a class="reference internal" href="index.html#optuna.trial.Trial" title="optuna.trial.Trial"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trial</span></code></a>.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.301 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-tutorial-20-recipes-003-attributes-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="_downloads/c35683c66b20dcba1d2aa07f68edae4e/003_attributes.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">003_attributes.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="_downloads/615af6c73e889b2527294f0b9ca50c3f/003_attributes.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">003_attributes.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>
<span id="document-tutorial/20_recipes/004_cli"></span><div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-tutorial-20-recipes-004-cli-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="command-line-interface">
<span id="cli"></span><span id="sphx-glr-tutorial-20-recipes-004-cli-py"></span><h6>Command-Line Interface<a class="headerlink" href="#command-line-interface" title="Permalink to this heading"></a></h6>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 67%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Command</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ask</p></td>
<td><p>Create a new trial and suggest parameters.</p></td>
</tr>
<tr class="row-odd"><td><p>best-trial</p></td>
<td><p>Show the best trial.</p></td>
</tr>
<tr class="row-even"><td><p>best-trials</p></td>
<td><p>Show a list of trials located at the Pareto front.</p></td>
</tr>
<tr class="row-odd"><td><p>create-study</p></td>
<td><p>Create a new study.</p></td>
</tr>
<tr class="row-even"><td><p>delete-study</p></td>
<td><p>Delete a specified study.</p></td>
</tr>
<tr class="row-odd"><td><p>storage upgrade</p></td>
<td><p>Upgrade the schema of a storage.</p></td>
</tr>
<tr class="row-even"><td><p>studies</p></td>
<td><p>Show a list of studies.</p></td>
</tr>
<tr class="row-odd"><td><p>study optimize</p></td>
<td><p>Start optimization of a study.</p></td>
</tr>
<tr class="row-even"><td><p>study set-user-attr</p></td>
<td><p>Set a user attribute to a study.</p></td>
</tr>
<tr class="row-odd"><td><p>tell</p></td>
<td><p>Finish a trial, which was created by the ask command.</p></td>
</tr>
<tr class="row-even"><td><p>trials</p></td>
<td><p>Show a list of trials.</p></td>
</tr>
</tbody>
</table>
<p>Optuna provides command-line interface as shown in the above table.</p>
<p>Let us assume you are not in IPython shell and writing Python script files instead.
It is totally fine to write scripts like the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">optuna</span>


<span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">()</span>
    <span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best value: </span><span class="si">{}</span><span class="s2"> (params: </span><span class="si">{}</span><span class="s2">)</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">study</span><span class="o">.</span><span class="n">best_value</span><span class="p">,</span> <span class="n">study</span><span class="o">.</span><span class="n">best_params</span><span class="p">))</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Best value: 0.00039197643671292016 (params: {&#39;x&#39;: 2.0197983948014206})
</pre></div>
</div>
<p>However, if we cannot write <code class="docutils literal notranslate"><span class="pre">objective</span></code> explicitly in Python code such as developing a new
drug in a lab, an interactive way is suitable.
In Optuna CLI, <a class="reference internal" href="index.html#ask-and-tell"><span class="std std-ref">Ask-and-Tell Interface</span></a> style commands provide such an interactive and flexible interface.</p>
<p>Let us assume we minimize the objective value depending on a parameter <code class="docutils literal notranslate"><span class="pre">x</span></code> in <span class="math notranslate nohighlight">\([-10, 10]\)</span>
and objective value is calculated via some experiments by hand.
Even so, we can invoke the optimization as follows.
Don’t care about <code class="docutils literal notranslate"><span class="pre">--storage</span> <span class="pre">sqlite:///example.db</span></code> for now, which is described in <a class="reference internal" href="index.html#rdb"><span class="std std-ref">Saving/Resuming Study with RDB Backend</span></a>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span><span class="nv">STUDY_NAME</span><span class="o">=</span><span class="sb">`</span>optuna<span class="w"> </span>create-study<span class="w"> </span>--storage<span class="w"> </span>sqlite:///example.db<span class="sb">`</span>
$<span class="w"> </span>optuna<span class="w"> </span>ask<span class="w"> </span>--storage<span class="w"> </span>sqlite:///example.db<span class="w"> </span>--study-name<span class="w"> </span><span class="nv">$STUDY_NAME</span><span class="w"> </span>--sampler<span class="w"> </span>TPESampler<span class="w"> </span><span class="se">\</span>
<span class="w">     </span>--search-space<span class="w"> </span><span class="s1">&#39;{&quot;x&quot;: {&quot;name&quot;: &quot;FloatDistribution&quot;, &quot;attributes&quot;: {&quot;step&quot;: null, &quot;low&quot;: -10.0, &quot;high&quot;: 10.0, &quot;log&quot;: false}}}&#39;</span>


<span class="o">[</span>I<span class="w"> </span><span class="m">2022</span>-08-20<span class="w"> </span><span class="m">06</span>:08:53,158<span class="o">]</span><span class="w"> </span>Asked<span class="w"> </span>trial<span class="w"> </span><span class="m">0</span><span class="w"> </span>with<span class="w"> </span>parameters<span class="w"> </span><span class="o">{</span><span class="s1">&#39;x&#39;</span>:<span class="w"> </span><span class="m">2</span>.512238141966016<span class="o">}</span>.
<span class="o">{</span><span class="s2">&quot;number&quot;</span>:<span class="w"> </span><span class="m">0</span>,<span class="w"> </span><span class="s2">&quot;params&quot;</span>:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;x&quot;</span>:<span class="w"> </span><span class="m">2</span>.512238141966016<span class="o">}}</span>
</pre></div>
</div>
<p>The argument of <code class="docutils literal notranslate"><span class="pre">--search-space</span></code> option can be generated by using
<a class="reference internal" href="index.html#optuna.distributions.distribution_to_json" title="optuna.distributions.distribution_to_json"><code class="xref py py-func docutils literal notranslate"><span class="pre">optuna.distributions.distribution_to_json()</span></code></a>, for example,
<code class="docutils literal notranslate"><span class="pre">optuna.distributions.distribution_to_json(optuna.distributions.FloatDistribution(-10,</span> <span class="pre">10))</span></code>.
Please refer to <a class="reference internal" href="index.html#optuna.distributions.FloatDistribution" title="optuna.distributions.FloatDistribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">optuna.distributions.FloatDistribution</span></code></a> and
<a class="reference internal" href="index.html#optuna.distributions.IntDistribution" title="optuna.distributions.IntDistribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">optuna.distributions.IntDistribution</span></code></a> for detailed explanations of their arguments.</p>
<p>After conducting an experiment using the suggested parameter in the lab,
we store the result to Optuna’s study as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>optuna<span class="w"> </span>tell<span class="w"> </span>--storage<span class="w"> </span>sqlite:///example.db<span class="w"> </span>--study-name<span class="w"> </span><span class="nv">$STUDY_NAME</span><span class="w"> </span>--trial-number<span class="w"> </span><span class="m">0</span><span class="w"> </span>--values<span class="w"> </span><span class="m">0</span>.7<span class="w"> </span>--state<span class="w"> </span><span class="nb">complete</span>
<span class="o">[</span>I<span class="w"> </span><span class="m">2022</span>-08-20<span class="w"> </span><span class="m">06</span>:22:50,888<span class="o">]</span><span class="w"> </span>Told<span class="w"> </span>trial<span class="w"> </span><span class="m">0</span><span class="w"> </span>with<span class="w"> </span>values<span class="w"> </span><span class="o">[</span><span class="m">0</span>.7<span class="o">]</span><span class="w"> </span>and<span class="w"> </span>state<span class="w"> </span>TrialState.COMPLETE.
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.503 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-tutorial-20-recipes-004-cli-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="_downloads/75b68bc13be06f294f7ba501c0410fe0/004_cli.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">004_cli.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="_downloads/d1bddf5b39c9f90932947a22a3164d8d/004_cli.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">004_cli.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
<span id="document-tutorial/20_recipes/005_user_defined_sampler"></span><div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-tutorial-20-recipes-005-user-defined-sampler-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="user-defined-sampler">
<span id="sphx-glr-tutorial-20-recipes-005-user-defined-sampler-py"></span><span id="id1"></span><h6>User-Defined Sampler<a class="headerlink" href="#user-defined-sampler" title="Permalink to this heading"></a></h6>
<p>Thanks to user-defined samplers, you can:</p>
<ul class="simple">
<li><p>experiment your own sampling algorithms,</p></li>
<li><p>implement task-specific algorithms to refine the optimization performance, or</p></li>
<li><p>wrap other optimization libraries to integrate them into Optuna pipelines (e.g., <a class="reference internal" href="index.html#optuna.integration.SkoptSampler" title="optuna.integration.SkoptSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">SkoptSampler</span></code></a>).</p></li>
</ul>
<p>This section describes the internal behavior of sampler classes and shows an example of implementing a user-defined sampler.</p>
<section id="overview-of-sampler">
<h6 aria-level="7">Overview of Sampler<a class="headerlink" href="#overview-of-sampler" title="Permalink to this heading"></a></h6>
<p>A sampler has the responsibility to determine the parameter values to be evaluated in a trial.
When a <cite>suggest</cite> API (e.g., <a class="reference internal" href="index.html#optuna.trial.Trial.suggest_float" title="optuna.trial.Trial.suggest_float"><code class="xref py py-func docutils literal notranslate"><span class="pre">suggest_float()</span></code></a>) is called inside an objective function, the corresponding distribution object (e.g., <a class="reference internal" href="index.html#optuna.distributions.FloatDistribution" title="optuna.distributions.FloatDistribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">FloatDistribution</span></code></a>) is created internally. A sampler samples a parameter value from the distribution. The sampled value is returned to the caller of the <cite>suggest</cite> API and evaluated in the objective function.</p>
<p>To create a new sampler, you need to define a class that inherits <a class="reference internal" href="index.html#optuna.samplers.BaseSampler" title="optuna.samplers.BaseSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSampler</span></code></a>.
The base class has three abstract methods;
<a class="reference internal" href="index.html#optuna.samplers.BaseSampler.infer_relative_search_space" title="optuna.samplers.BaseSampler.infer_relative_search_space"><code class="xref py py-meth docutils literal notranslate"><span class="pre">infer_relative_search_space()</span></code></a>,
<a class="reference internal" href="index.html#optuna.samplers.BaseSampler.sample_relative" title="optuna.samplers.BaseSampler.sample_relative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample_relative()</span></code></a>, and
<a class="reference internal" href="index.html#optuna.samplers.BaseSampler.sample_independent" title="optuna.samplers.BaseSampler.sample_independent"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample_independent()</span></code></a>.</p>
<p>As the method names imply, Optuna supports two types of sampling: one is <strong>relative sampling</strong> that can consider the correlation of the parameters in a trial, and the other is <strong>independent sampling</strong> that samples each parameter independently.</p>
<p>At the beginning of a trial, <a class="reference internal" href="index.html#optuna.samplers.BaseSampler.infer_relative_search_space" title="optuna.samplers.BaseSampler.infer_relative_search_space"><code class="xref py py-meth docutils literal notranslate"><span class="pre">infer_relative_search_space()</span></code></a> is called to provide the relative search space for the trial. Then, <a class="reference internal" href="index.html#optuna.samplers.BaseSampler.sample_relative" title="optuna.samplers.BaseSampler.sample_relative"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample_relative()</span></code></a> is invoked to sample relative parameters from the search space. During the execution of the objective function, <a class="reference internal" href="index.html#optuna.samplers.BaseSampler.sample_independent" title="optuna.samplers.BaseSampler.sample_independent"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample_independent()</span></code></a> is used to sample parameters that don’t belong to the relative search space.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please refer to the document of <a class="reference internal" href="index.html#optuna.samplers.BaseSampler" title="optuna.samplers.BaseSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSampler</span></code></a> for further details.</p>
</div>
</section>
<section id="an-example-implementing-simulatedannealingsampler">
<h6 aria-level="7">An Example: Implementing SimulatedAnnealingSampler<a class="headerlink" href="#an-example-implementing-simulatedannealingsampler" title="Permalink to this heading"></a></h6>
<p>For example, the following code defines a sampler based on
<a class="reference external" href="https://en.wikipedia.org/wiki/Simulated_annealing">Simulated Annealing (SA)</a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">optuna</span>


<span class="k">class</span> <span class="nc">SimulatedAnnealingSampler</span><span class="p">(</span><span class="n">optuna</span><span class="o">.</span><span class="n">samplers</span><span class="o">.</span><span class="n">BaseSampler</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">temperature</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">RandomState</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_temperature</span> <span class="o">=</span> <span class="n">temperature</span>  <span class="c1"># Current temperature.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_current_trial</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Current state.</span>

    <span class="k">def</span> <span class="nf">sample_relative</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">study</span><span class="p">,</span> <span class="n">trial</span><span class="p">,</span> <span class="n">search_space</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">search_space</span> <span class="o">==</span> <span class="p">{}:</span>
            <span class="k">return</span> <span class="p">{}</span>

        <span class="c1"># Simulated Annealing algorithm.</span>
        <span class="c1"># 1. Calculate transition probability.</span>
        <span class="n">prev_trial</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">trials</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_trial</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">prev_trial</span><span class="o">.</span><span class="n">value</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_trial</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">probability</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">probability</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
                <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_current_trial</span><span class="o">.</span><span class="n">value</span> <span class="o">-</span> <span class="n">prev_trial</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">_temperature</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_temperature</span> <span class="o">*=</span> <span class="mf">0.9</span>  <span class="c1"># Decrease temperature.</span>

        <span class="c1"># 2. Transit the current state if the previous result is accepted.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">probability</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_current_trial</span> <span class="o">=</span> <span class="n">prev_trial</span>

        <span class="c1"># 3. Sample parameters from the neighborhood of the current point.</span>
        <span class="c1"># The sampled parameters will be used during the next execution of</span>
        <span class="c1"># the objective function passed to the study.</span>
        <span class="n">params</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">param_name</span><span class="p">,</span> <span class="n">param_distribution</span> <span class="ow">in</span> <span class="n">search_space</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">param_distribution</span><span class="p">,</span> <span class="n">optuna</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">FloatDistribution</span><span class="p">)</span>
                <span class="ow">or</span> <span class="p">(</span><span class="n">param_distribution</span><span class="o">.</span><span class="n">step</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">param_distribution</span><span class="o">.</span><span class="n">step</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span>
                <span class="ow">or</span> <span class="n">param_distribution</span><span class="o">.</span><span class="n">log</span>
            <span class="p">):</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s2">&quot;Only suggest_float() with `step` `None` or 1.0 and&quot;</span>
                    <span class="s2">&quot; `log` `False` is supported&quot;</span>
                <span class="p">)</span>
                <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

            <span class="n">current_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_current_trial</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">param_name</span><span class="p">]</span>
            <span class="n">width</span> <span class="o">=</span> <span class="p">(</span><span class="n">param_distribution</span><span class="o">.</span><span class="n">high</span> <span class="o">-</span> <span class="n">param_distribution</span><span class="o">.</span><span class="n">low</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.1</span>
            <span class="n">neighbor_low</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">current_value</span> <span class="o">-</span> <span class="n">width</span><span class="p">,</span> <span class="n">param_distribution</span><span class="o">.</span><span class="n">low</span><span class="p">)</span>
            <span class="n">neighbor_high</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">current_value</span> <span class="o">+</span> <span class="n">width</span><span class="p">,</span> <span class="n">param_distribution</span><span class="o">.</span><span class="n">high</span><span class="p">)</span>
            <span class="n">params</span><span class="p">[</span><span class="n">param_name</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">neighbor_low</span><span class="p">,</span> <span class="n">neighbor_high</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">params</span>

    <span class="c1"># The rest are unrelated to SA algorithm: boilerplate</span>
    <span class="k">def</span> <span class="nf">infer_relative_search_space</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">study</span><span class="p">,</span> <span class="n">trial</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">optuna</span><span class="o">.</span><span class="n">search_space</span><span class="o">.</span><span class="n">intersection_search_space</span><span class="p">(</span><span class="n">study</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">sample_independent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">study</span><span class="p">,</span> <span class="n">trial</span><span class="p">,</span> <span class="n">param_name</span><span class="p">,</span> <span class="n">param_distribution</span><span class="p">):</span>
        <span class="n">independent_sampler</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">samplers</span><span class="o">.</span><span class="n">RandomSampler</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">independent_sampler</span><span class="o">.</span><span class="n">sample_independent</span><span class="p">(</span><span class="n">study</span><span class="p">,</span> <span class="n">trial</span><span class="p">,</span> <span class="n">param_name</span><span class="p">,</span> <span class="n">param_distribution</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In favor of code simplicity, the above implementation doesn’t support some features (e.g., maximization).
If you’re interested in how to support those features, please see
<a class="reference external" href="https://github.com/optuna/optuna-examples/blob/main/samplers/simulated_annealing_sampler.py">examples/samplers/simulated_annealing.py</a>.</p>
</div>
<p>You can use <code class="docutils literal notranslate"><span class="pre">SimulatedAnnealingSampler</span></code> in the same way as built-in samplers as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">y</span>


<span class="n">sampler</span> <span class="o">=</span> <span class="n">SimulatedAnnealingSampler</span><span class="p">()</span>
<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">sampler</span><span class="o">=</span><span class="n">sampler</span><span class="p">)</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="n">best_trial</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">best_trial</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best value: &quot;</span><span class="p">,</span> <span class="n">best_trial</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parameters that achieve the best value: &quot;</span><span class="p">,</span> <span class="n">best_trial</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Best value:  -4.970764963581132
Parameters that achieve the best value:  {&#39;x&#39;: -0.14985998818796276, &#39;y&#39;: -4.993222979640828}
</pre></div>
</div>
<p>In this optimization, the values of <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> parameters are sampled by using
<code class="docutils literal notranslate"><span class="pre">SimulatedAnnealingSampler.sample_relative</span></code> method.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Strictly speaking, in the first trial,
<code class="docutils literal notranslate"><span class="pre">SimulatedAnnealingSampler.sample_independent</span></code> method is used to sample parameter values.
Because <a class="reference internal" href="index.html#optuna.search_space.intersection_search_space" title="optuna.search_space.intersection_search_space"><code class="xref py py-func docutils literal notranslate"><span class="pre">intersection_search_space()</span></code></a> used in
<code class="docutils literal notranslate"><span class="pre">SimulatedAnnealingSampler.infer_relative_search_space</span></code> cannot infer the search space
if there are no complete trials.</p>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.341 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-tutorial-20-recipes-005-user-defined-sampler-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="_downloads/313887734fbc4aba626c945cd2d75115/005_user_defined_sampler.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">005_user_defined_sampler.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="_downloads/cda8e12074841c2e6e632b6eacb74def/005_user_defined_sampler.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">005_user_defined_sampler.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>
<span id="document-tutorial/20_recipes/006_user_defined_pruner"></span><div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-tutorial-20-recipes-006-user-defined-pruner-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="user-defined-pruner">
<span id="sphx-glr-tutorial-20-recipes-006-user-defined-pruner-py"></span><span id="id1"></span><h6>User-Defined Pruner<a class="headerlink" href="#user-defined-pruner" title="Permalink to this heading"></a></h6>
<p>In <a class="reference internal" href="index.html#module-optuna.pruners" title="optuna.pruners"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optuna.pruners</span></code></a>, we described how an objective function can optionally include
calls to a pruning feature which allows Optuna to terminate an optimization
trial when intermediate results do not appear promising. In this document, we
describe how to implement your own pruner, i.e., a custom strategy for
determining when to stop a trial.</p>
<section id="overview-of-pruning-interface">
<h6 aria-level="7">Overview of Pruning Interface<a class="headerlink" href="#overview-of-pruning-interface" title="Permalink to this heading"></a></h6>
<p>The <a class="reference internal" href="index.html#optuna.study.create_study" title="optuna.study.create_study"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_study()</span></code></a> constructor takes, as an optional
argument, a pruner inheriting from <a class="reference internal" href="index.html#optuna.pruners.BasePruner" title="optuna.pruners.BasePruner"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePruner</span></code></a>. The
pruner should implement the abstract method
<a class="reference internal" href="index.html#optuna.pruners.BasePruner.prune" title="optuna.pruners.BasePruner.prune"><code class="xref py py-func docutils literal notranslate"><span class="pre">prune()</span></code></a>, which takes arguments for the
associated <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a> and <a class="reference internal" href="index.html#optuna.trial.Trial" title="optuna.trial.Trial"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trial</span></code></a> and
returns a boolean value: <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> if the trial should be pruned and <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>
otherwise. Using the Study and Trial objects, you can access all other trials
through the <a class="reference internal" href="index.html#optuna.study.Study.get_trials" title="optuna.study.Study.get_trials"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_trials()</span></code></a> method and, and from a trial,
its reported intermediate values through the
<a class="reference internal" href="index.html#optuna.trial.FrozenTrial.intermediate_values" title="optuna.trial.FrozenTrial.intermediate_values"><code class="xref py py-func docutils literal notranslate"><span class="pre">intermediate_values()</span></code></a> (a
dictionary which maps an integer <code class="docutils literal notranslate"><span class="pre">step</span></code> to a float value).</p>
<p>You can refer to the source code of the built-in Optuna pruners as templates for
building your own. In this document, for illustration, we describe the
construction and usage of a simple (but aggressive) pruner which prunes trials
that are in last place compared to completed trials at the same step.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please refer to the documentation of <a class="reference internal" href="index.html#optuna.pruners.BasePruner" title="optuna.pruners.BasePruner"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePruner</span></code></a> or,
for example, <a class="reference internal" href="index.html#optuna.pruners.ThresholdPruner" title="optuna.pruners.ThresholdPruner"><code class="xref py py-class docutils literal notranslate"><span class="pre">ThresholdPruner</span></code></a> or
<a class="reference internal" href="index.html#optuna.pruners.PercentilePruner" title="optuna.pruners.PercentilePruner"><code class="xref py py-class docutils literal notranslate"><span class="pre">PercentilePruner</span></code></a> for more robust examples of pruner
implementation, including error checking and complex pruner-internal logic.</p>
</div>
</section>
<section id="an-example-implementing-lastplacepruner">
<h6 aria-level="7">An Example: Implementing <code class="docutils literal notranslate"><span class="pre">LastPlacePruner</span></code><a class="headerlink" href="#an-example-implementing-lastplacepruner" title="Permalink to this heading"></a></h6>
<p>We aim to optimize the <code class="docutils literal notranslate"><span class="pre">loss</span></code> and <code class="docutils literal notranslate"><span class="pre">alpha</span></code> hyperparameters for a stochastic
gradient descent classifier (<code class="docutils literal notranslate"><span class="pre">SGDClassifier</span></code>) run on the sklearn iris dataset. We
implement a pruner which terminates a trial at a certain step if it is in last
place compared to completed trials at the same step. We begin considering
pruning after a “warmup” of 1 training step and 5 completed trials. For
demonstration purposes, we <a class="reference external" href="https://docs.python.org/3/library/functions.html#print" title="(in Python v3.11)"><code class="xref py py-func docutils literal notranslate"><span class="pre">print()</span></code></a> a diagnostic message from <code class="docutils literal notranslate"><span class="pre">prune</span></code> when
it is about to return <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> (indicating pruning).</p>
<p>It may be important to note that the <code class="docutils literal notranslate"><span class="pre">SGDClassifier</span></code> score, as it is evaluated on
a holdout set, decreases with enough training steps due to overfitting. This
means that a trial could be pruned even if it had a favorable (high) value on a
previous training set. After pruning, Optuna will take the intermediate value
last reported as the value of the trial.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">SGDClassifier</span>

<span class="kn">import</span> <span class="nn">optuna</span>
<span class="kn">from</span> <span class="nn">optuna.pruners</span> <span class="kn">import</span> <span class="n">BasePruner</span>
<span class="kn">from</span> <span class="nn">optuna.trial._state</span> <span class="kn">import</span> <span class="n">TrialState</span>


<span class="k">class</span> <span class="nc">LastPlacePruner</span><span class="p">(</span><span class="n">BasePruner</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">warmup_steps</span><span class="p">,</span> <span class="n">warmup_trials</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_warmup_steps</span> <span class="o">=</span> <span class="n">warmup_steps</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_warmup_trials</span> <span class="o">=</span> <span class="n">warmup_trials</span>

    <span class="k">def</span> <span class="nf">prune</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">study</span><span class="p">:</span> <span class="s2">&quot;optuna.study.Study&quot;</span><span class="p">,</span> <span class="n">trial</span><span class="p">:</span> <span class="s2">&quot;optuna.trial.FrozenTrial&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="c1"># Get the latest score reported from this trial</span>
        <span class="n">step</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">last_step</span>

        <span class="k">if</span> <span class="n">step</span><span class="p">:</span>  <span class="c1"># trial.last_step == None when no scores have been reported yet</span>
            <span class="n">this_score</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">intermediate_values</span><span class="p">[</span><span class="n">step</span><span class="p">]</span>

            <span class="c1"># Get scores from other trials in the study reported at the same step</span>
            <span class="n">completed_trials</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">get_trials</span><span class="p">(</span><span class="n">deepcopy</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="p">(</span><span class="n">TrialState</span><span class="o">.</span><span class="n">COMPLETE</span><span class="p">,))</span>
            <span class="n">other_scores</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">t</span><span class="o">.</span><span class="n">intermediate_values</span><span class="p">[</span><span class="n">step</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">completed_trials</span>
                <span class="k">if</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">t</span><span class="o">.</span><span class="n">intermediate_values</span>
            <span class="p">]</span>
            <span class="n">other_scores</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">other_scores</span><span class="p">)</span>

            <span class="c1"># Prune if this trial at this step has a lower value than all completed trials</span>
            <span class="c1"># at the same step. Note that steps will begin numbering at 0 in the objective</span>
            <span class="c1"># function definition below.</span>
            <span class="k">if</span> <span class="n">step</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warmup_steps</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">other_scores</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">_warmup_trials</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">this_score</span> <span class="o">&lt;</span> <span class="n">other_scores</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;prune() True: Trial </span><span class="si">{</span><span class="n">trial</span><span class="o">.</span><span class="n">number</span><span class="si">}</span><span class="s2">, Step </span><span class="si">{</span><span class="n">step</span><span class="si">}</span><span class="s2">, Score </span><span class="si">{</span><span class="n">this_score</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                    <span class="k">return</span> <span class="kc">True</span>

        <span class="k">return</span> <span class="kc">False</span>
</pre></div>
</div>
<p>Lastly, let’s confirm the implementation is correct with the simple hyperparameter optimization.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="n">iris</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">()</span>
    <span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="p">)</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
        <span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span><span class="p">,</span> <span class="n">train_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span>
    <span class="p">)</span>

    <span class="n">loss</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_categorical</span><span class="p">(</span><span class="s2">&quot;loss&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;hinge&quot;</span><span class="p">,</span> <span class="s2">&quot;log_loss&quot;</span><span class="p">,</span> <span class="s2">&quot;perceptron&quot;</span><span class="p">])</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="mf">0.00001</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">SGDClassifier</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="n">loss</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">score</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">):</span>
        <span class="n">clf</span><span class="o">.</span><span class="n">partial_fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="n">classes</span><span class="p">)</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_valid</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">)</span>

        <span class="n">trial</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">score</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">trial</span><span class="o">.</span><span class="n">should_prune</span><span class="p">():</span>
            <span class="k">raise</span> <span class="n">optuna</span><span class="o">.</span><span class="n">TrialPruned</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">score</span>


<span class="n">pruner</span> <span class="o">=</span> <span class="n">LastPlacePruner</span><span class="p">(</span><span class="n">warmup_steps</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">warmup_trials</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;maximize&quot;</span><span class="p">,</span> <span class="n">pruner</span><span class="o">=</span><span class="n">pruner</span><span class="p">)</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>prune() True: Trial 19, Step 2, Score 0.62
prune() True: Trial 31, Step 2, Score 0.36
prune() True: Trial 33, Step 4, Score 0.48
prune() True: Trial 34, Step 4, Score 0.64
prune() True: Trial 35, Step 1, Score 0.36
prune() True: Trial 36, Step 3, Score 0.52
prune() True: Trial 37, Step 1, Score 0.32
prune() True: Trial 40, Step 1, Score 0.42
prune() True: Trial 41, Step 2, Score 0.48
prune() True: Trial 43, Step 4, Score 0.68
prune() True: Trial 44, Step 1, Score 0.52
prune() True: Trial 45, Step 4, Score 0.68
prune() True: Trial 46, Step 1, Score 0.32
prune() True: Trial 47, Step 3, Score 0.64
prune() True: Trial 49, Step 4, Score 0.68
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.855 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-tutorial-20-recipes-006-user-defined-pruner-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="_downloads/367a7656d509bad6b4c2a664ffbc3653/006_user_defined_pruner.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">006_user_defined_pruner.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="_downloads/78587bcda498aafb5da0880193ba8ebe/006_user_defined_pruner.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">006_user_defined_pruner.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>
<span id="document-tutorial/20_recipes/007_optuna_callback"></span><div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-tutorial-20-recipes-007-optuna-callback-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="callback-for-study-optimize">
<span id="optuna-callback"></span><span id="sphx-glr-tutorial-20-recipes-007-optuna-callback-py"></span><h6>Callback for Study.optimize<a class="headerlink" href="#callback-for-study-optimize" title="Permalink to this heading"></a></h6>
<p>This tutorial showcases how to use &amp; implement Optuna <code class="docutils literal notranslate"><span class="pre">Callback</span></code> for <a class="reference internal" href="index.html#optuna.study.Study.optimize" title="optuna.study.Study.optimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">optimize()</span></code></a>.</p>
<p><code class="docutils literal notranslate"><span class="pre">Callback</span></code> is called after every evaluation of <code class="docutils literal notranslate"><span class="pre">objective</span></code>, and
it takes <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a> and <a class="reference internal" href="index.html#optuna.trial.FrozenTrial" title="optuna.trial.FrozenTrial"><code class="xref py py-class docutils literal notranslate"><span class="pre">FrozenTrial</span></code></a> as arguments, and does some work.</p>
<p><a class="reference internal" href="index.html#optuna.integration.MLflowCallback" title="optuna.integration.MLflowCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">MLflowCallback</span></code></a> is a great example.</p>
<section id="stop-optimization-after-some-trials-are-pruned-in-a-row">
<h6 aria-level="7">Stop optimization after some trials are pruned in a row<a class="headerlink" href="#stop-optimization-after-some-trials-are-pruned-in-a-row" title="Permalink to this heading"></a></h6>
<p>This example implements a stateful callback which stops the optimization
if a certain number of trials are pruned in a row.
The number of trials pruned in a row is specified by <code class="docutils literal notranslate"><span class="pre">threshold</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">optuna</span>


<span class="k">class</span> <span class="nc">StopWhenTrialKeepBeingPrunedCallback</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">threshold</span><span class="p">:</span> <span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span> <span class="o">=</span> <span class="n">threshold</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_consequtive_pruned_count</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">study</span><span class="p">:</span> <span class="n">optuna</span><span class="o">.</span><span class="n">study</span><span class="o">.</span><span class="n">Study</span><span class="p">,</span> <span class="n">trial</span><span class="p">:</span> <span class="n">optuna</span><span class="o">.</span><span class="n">trial</span><span class="o">.</span><span class="n">FrozenTrial</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">trial</span><span class="o">.</span><span class="n">state</span> <span class="o">==</span> <span class="n">optuna</span><span class="o">.</span><span class="n">trial</span><span class="o">.</span><span class="n">TrialState</span><span class="o">.</span><span class="n">PRUNED</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_consequtive_pruned_count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_consequtive_pruned_count</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_consequtive_pruned_count</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">threshold</span><span class="p">:</span>
            <span class="n">study</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</pre></div>
</div>
<p>This objective prunes all the trials except for the first 5 trials (<code class="docutils literal notranslate"><span class="pre">trial.number</span></code> starts with 0).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">trial</span><span class="o">.</span><span class="n">number</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">optuna</span><span class="o">.</span><span class="n">TrialPruned</span>

    <span class="k">return</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, we set the threshold to <code class="docutils literal notranslate"><span class="pre">2</span></code>: optimization finishes once two trials are pruned in a row.
So, we expect this study to stop after 7 trials.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c1"># Add stream handler of stdout to show the messages</span>
<span class="n">optuna</span><span class="o">.</span><span class="n">logging</span><span class="o">.</span><span class="n">get_logger</span><span class="p">(</span><span class="s2">&quot;optuna&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">))</span>

<span class="n">study_stop_cb</span> <span class="o">=</span> <span class="n">StopWhenTrialKeepBeingPrunedCallback</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">()</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">study_stop_cb</span><span class="p">])</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>A new study created in memory with name: no-name-7593a5d7-e09b-4e46-a969-6f3ea396be3f
Trial 0 finished with value: 0.7788992720766245 and parameters: {&#39;x&#39;: 0.7788992720766245}. Best is trial 0 with value: 0.7788992720766245.
Trial 1 finished with value: 0.1422889367725758 and parameters: {&#39;x&#39;: 0.1422889367725758}. Best is trial 1 with value: 0.1422889367725758.
Trial 2 finished with value: 0.18836720851360533 and parameters: {&#39;x&#39;: 0.18836720851360533}. Best is trial 1 with value: 0.1422889367725758.
Trial 3 finished with value: 0.7531297742713704 and parameters: {&#39;x&#39;: 0.7531297742713704}. Best is trial 1 with value: 0.1422889367725758.
Trial 4 finished with value: 0.7701368250973767 and parameters: {&#39;x&#39;: 0.7701368250973767}. Best is trial 1 with value: 0.1422889367725758.
Trial 5 pruned.
Trial 6 pruned.
</pre></div>
</div>
<p>As you can see in the log above, the study stopped after 7 trials as expected.</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.007 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-tutorial-20-recipes-007-optuna-callback-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="_downloads/69c9a8896808997c60d5d1879065fad2/007_optuna_callback.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">007_optuna_callback.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="_downloads/8a3b786e31e54819e53dfa737aebc72d/007_optuna_callback.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">007_optuna_callback.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>
<span id="document-tutorial/20_recipes/008_specify_params"></span><div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-tutorial-20-recipes-008-specify-params-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="specify-hyperparameters-manually">
<span id="specify-params"></span><span id="sphx-glr-tutorial-20-recipes-008-specify-params-py"></span><h6>Specify Hyperparameters Manually<a class="headerlink" href="#specify-hyperparameters-manually" title="Permalink to this heading"></a></h6>
<p>It’s natural that you have some specific sets of hyperparameters to try first such as initial learning rate
values and the number of leaves.
Also, it’s possible that you’ve already tried those sets before having Optuna find better
sets of hyperparameters.</p>
<p>Optuna provides two APIs to support such cases:</p>
<ol class="arabic simple">
<li><p>Passing those sets of hyperparameters and let Optuna evaluate them - <a class="reference internal" href="index.html#optuna.study.Study.enqueue_trial" title="optuna.study.Study.enqueue_trial"><code class="xref py py-func docutils literal notranslate"><span class="pre">enqueue_trial()</span></code></a></p></li>
<li><p>Adding the results of those sets as completed <code class="docutils literal notranslate"><span class="pre">Trial</span></code>s - <a class="reference internal" href="index.html#optuna.study.Study.add_trial" title="optuna.study.Study.add_trial"><code class="xref py py-func docutils literal notranslate"><span class="pre">add_trial()</span></code></a></p></li>
</ol>
<section id="first-scenario-have-optuna-evaluate-your-hyperparameters">
<span id="enqueue-trial-tutorial"></span><h6 aria-level="7">First Scenario: Have Optuna evaluate your hyperparameters<a class="headerlink" href="#first-scenario-have-optuna-evaluate-your-hyperparameters" title="Permalink to this heading"></a></h6>
<p>In this scenario, let’s assume you have some out-of-box sets of hyperparameters but have not
evaluated them yet and decided to use Optuna to find better sets of hyperparameters.</p>
<p>Optuna has <a class="reference internal" href="index.html#optuna.study.Study.enqueue_trial" title="optuna.study.Study.enqueue_trial"><code class="xref py py-func docutils literal notranslate"><span class="pre">optuna.study.Study.enqueue_trial()</span></code></a> which lets you pass those sets of
hyperparameters to Optuna and Optuna will evaluate them.</p>
<p>This section walks you through how to use this lit API with <a class="reference external" href="https://lightgbm.readthedocs.io/en/latest/">LightGBM</a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">lightgbm</span> <span class="k">as</span> <span class="nn">lgb</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sklearn.datasets</span>
<span class="kn">import</span> <span class="nn">sklearn.metrics</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="kn">import</span> <span class="nn">optuna</span>
</pre></div>
</div>
<p>Define the objective function.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="n">data</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">load_breast_cancer</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">train_x</span><span class="p">,</span> <span class="n">valid_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">valid_y</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.25</span><span class="p">)</span>
    <span class="n">dtrain</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">train_y</span><span class="p">)</span>
    <span class="n">dvalid</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">Dataset</span><span class="p">(</span><span class="n">valid_x</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">valid_y</span><span class="p">)</span>

    <span class="n">param</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;objective&quot;</span><span class="p">:</span> <span class="s2">&quot;binary&quot;</span><span class="p">,</span>
        <span class="s2">&quot;metric&quot;</span><span class="p">:</span> <span class="s2">&quot;auc&quot;</span><span class="p">,</span>
        <span class="s2">&quot;verbosity&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
        <span class="s2">&quot;boosting_type&quot;</span><span class="p">:</span> <span class="s2">&quot;gbdt&quot;</span><span class="p">,</span>
        <span class="s2">&quot;bagging_fraction&quot;</span><span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;bagging_fraction&quot;</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="mf">1e-12</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span>
        <span class="s2">&quot;bagging_freq&quot;</span><span class="p">:</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_int</span><span class="p">(</span><span class="s2">&quot;bagging_freq&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
        <span class="s2">&quot;min_child_samples&quot;</span><span class="p">:</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_int</span><span class="p">(</span><span class="s2">&quot;min_child_samples&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
    <span class="p">}</span>

    <span class="c1"># Add a callback for pruning.</span>
    <span class="n">pruning_callback</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">integration</span><span class="o">.</span><span class="n">LightGBMPruningCallback</span><span class="p">(</span><span class="n">trial</span><span class="p">,</span> <span class="s2">&quot;auc&quot;</span><span class="p">)</span>
    <span class="n">gbm</span> <span class="o">=</span> <span class="n">lgb</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">dtrain</span><span class="p">,</span> <span class="n">valid_sets</span><span class="o">=</span><span class="p">[</span><span class="n">dvalid</span><span class="p">],</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">pruning_callback</span><span class="p">])</span>

    <span class="n">preds</span> <span class="o">=</span> <span class="n">gbm</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">valid_x</span><span class="p">)</span>
    <span class="n">pred_labels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rint</span><span class="p">(</span><span class="n">preds</span><span class="p">)</span>
    <span class="n">accuracy</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">valid_y</span><span class="p">,</span> <span class="n">pred_labels</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">accuracy</span>
</pre></div>
</div>
<p>Then, construct <code class="docutils literal notranslate"><span class="pre">Study</span></code> for hyperparameter optimization.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;maximize&quot;</span><span class="p">,</span> <span class="n">pruner</span><span class="o">=</span><span class="n">optuna</span><span class="o">.</span><span class="n">pruners</span><span class="o">.</span><span class="n">MedianPruner</span><span class="p">())</span>
</pre></div>
</div>
<p>Here, we get Optuna evaluate some sets with larger <code class="docutils literal notranslate"><span class="pre">&quot;bagging_fraq&quot;</span></code> value and
the default values.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">study</span><span class="o">.</span><span class="n">enqueue_trial</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;bagging_fraction&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
        <span class="s2">&quot;bagging_freq&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s2">&quot;min_child_samples&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="n">study</span><span class="o">.</span><span class="n">enqueue_trial</span><span class="p">(</span>
    <span class="p">{</span>
        <span class="s2">&quot;bagging_fraction&quot;</span><span class="p">:</span> <span class="mf">0.75</span><span class="p">,</span>
        <span class="s2">&quot;bagging_freq&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
        <span class="s2">&quot;min_child_samples&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">)</span>

<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c1"># Add stream handler of stdout to show the messages to see Optuna works expectedly.</span>
<span class="n">optuna</span><span class="o">.</span><span class="n">logging</span><span class="o">.</span><span class="n">get_logger</span><span class="p">(</span><span class="s2">&quot;optuna&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">addHandler</span><span class="p">(</span><span class="n">logging</span><span class="o">.</span><span class="n">StreamHandler</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="p">))</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Trial 0 finished with value: 0.972027972027972 and parameters: {&#39;bagging_fraction&#39;: 1.0, &#39;bagging_freq&#39;: 0, &#39;min_child_samples&#39;: 20}. Best is trial 0 with value: 0.972027972027972.
Trial 1 finished with value: 0.986013986013986 and parameters: {&#39;bagging_fraction&#39;: 0.75, &#39;bagging_freq&#39;: 5, &#39;min_child_samples&#39;: 20}. Best is trial 1 with value: 0.986013986013986.
Trial 2 finished with value: 0.958041958041958 and parameters: {&#39;bagging_fraction&#39;: 0.541993021366169, &#39;bagging_freq&#39;: 7, &#39;min_child_samples&#39;: 64}. Best is trial 1 with value: 0.986013986013986.
Trial 3 finished with value: 0.965034965034965 and parameters: {&#39;bagging_fraction&#39;: 0.5780232341876168, &#39;bagging_freq&#39;: 3, &#39;min_child_samples&#39;: 72}. Best is trial 1 with value: 0.986013986013986.
Trial 4 finished with value: 0.951048951048951 and parameters: {&#39;bagging_fraction&#39;: 0.8242979116198806, &#39;bagging_freq&#39;: 2, &#39;min_child_samples&#39;: 46}. Best is trial 1 with value: 0.986013986013986.
Trial 5 pruned. Trial was pruned at iteration 0.
Trial 6 pruned. Trial was pruned at iteration 0.
Trial 7 pruned. Trial was pruned at iteration 0.
Trial 8 pruned. Trial was pruned at iteration 0.
Trial 9 pruned. Trial was pruned at iteration 0.
Trial 10 pruned. Trial was pruned at iteration 0.
Trial 11 pruned. Trial was pruned at iteration 0.
Trial 12 pruned. Trial was pruned at iteration 0.
Trial 13 pruned. Trial was pruned at iteration 0.
Trial 14 pruned. Trial was pruned at iteration 1.
Trial 15 finished with value: 0.9440559440559441 and parameters: {&#39;bagging_fraction&#39;: 0.899899990041094, &#39;bagging_freq&#39;: 5, &#39;min_child_samples&#39;: 24}. Best is trial 1 with value: 0.986013986013986.
Trial 16 pruned. Trial was pruned at iteration 48.
Trial 17 finished with value: 0.951048951048951 and parameters: {&#39;bagging_fraction&#39;: 0.8223150863533111, &#39;bagging_freq&#39;: 2, &#39;min_child_samples&#39;: 17}. Best is trial 1 with value: 0.986013986013986.
Trial 18 pruned. Trial was pruned at iteration 0.
Trial 19 pruned. Trial was pruned at iteration 0.
Trial 20 pruned. Trial was pruned at iteration 0.
Trial 21 pruned. Trial was pruned at iteration 0.
Trial 22 pruned. Trial was pruned at iteration 0.
Trial 23 pruned. Trial was pruned at iteration 0.
Trial 24 pruned. Trial was pruned at iteration 0.
Trial 25 finished with value: 0.9790209790209791 and parameters: {&#39;bagging_fraction&#39;: 0.7062522695808396, &#39;bagging_freq&#39;: 0, &#39;min_child_samples&#39;: 59}. Best is trial 1 with value: 0.986013986013986.
Trial 26 pruned. Trial was pruned at iteration 0.
Trial 27 pruned. Trial was pruned at iteration 0.
Trial 28 pruned. Trial was pruned at iteration 0.
Trial 29 pruned. Trial was pruned at iteration 0.
Trial 30 pruned. Trial was pruned at iteration 0.
Trial 31 pruned. Trial was pruned at iteration 0.
Trial 32 pruned. Trial was pruned at iteration 0.
Trial 33 pruned. Trial was pruned at iteration 0.
Trial 34 pruned. Trial was pruned at iteration 0.
Trial 35 pruned. Trial was pruned at iteration 0.
Trial 36 pruned. Trial was pruned at iteration 0.
Trial 37 pruned. Trial was pruned at iteration 0.
Trial 38 pruned. Trial was pruned at iteration 0.
Trial 39 pruned. Trial was pruned at iteration 0.
Trial 40 pruned. Trial was pruned at iteration 0.
Trial 41 pruned. Trial was pruned at iteration 0.
Trial 42 pruned. Trial was pruned at iteration 0.
Trial 43 pruned. Trial was pruned at iteration 0.
Trial 44 pruned. Trial was pruned at iteration 0.
Trial 45 pruned. Trial was pruned at iteration 1.
Trial 46 pruned. Trial was pruned at iteration 0.
Trial 47 finished with value: 0.9790209790209791 and parameters: {&#39;bagging_fraction&#39;: 0.6842639013558001, &#39;bagging_freq&#39;: 7, &#39;min_child_samples&#39;: 31}. Best is trial 1 with value: 0.986013986013986.
Trial 48 pruned. Trial was pruned at iteration 0.
Trial 49 pruned. Trial was pruned at iteration 0.
Trial 50 pruned. Trial was pruned at iteration 0.
Trial 51 pruned. Trial was pruned at iteration 0.
Trial 52 pruned. Trial was pruned at iteration 0.
Trial 53 pruned. Trial was pruned at iteration 0.
Trial 54 pruned. Trial was pruned at iteration 0.
Trial 55 finished with value: 0.9790209790209791 and parameters: {&#39;bagging_fraction&#39;: 0.6509034414743136, &#39;bagging_freq&#39;: 6, &#39;min_child_samples&#39;: 13}. Best is trial 1 with value: 0.986013986013986.
Trial 56 pruned. Trial was pruned at iteration 0.
Trial 57 pruned. Trial was pruned at iteration 0.
Trial 58 pruned. Trial was pruned at iteration 2.
Trial 59 pruned. Trial was pruned at iteration 0.
Trial 60 pruned. Trial was pruned at iteration 0.
Trial 61 pruned. Trial was pruned at iteration 0.
Trial 62 pruned. Trial was pruned at iteration 0.
Trial 63 pruned. Trial was pruned at iteration 0.
Trial 64 finished with value: 0.986013986013986 and parameters: {&#39;bagging_fraction&#39;: 0.7751901575156568, &#39;bagging_freq&#39;: 0, &#39;min_child_samples&#39;: 14}. Best is trial 1 with value: 0.986013986013986.
Trial 65 pruned. Trial was pruned at iteration 0.
Trial 66 pruned. Trial was pruned at iteration 0.
Trial 67 pruned. Trial was pruned at iteration 3.
Trial 68 pruned. Trial was pruned at iteration 0.
Trial 69 pruned. Trial was pruned at iteration 0.
Trial 70 pruned. Trial was pruned at iteration 0.
Trial 71 pruned. Trial was pruned at iteration 0.
Trial 72 pruned. Trial was pruned at iteration 0.
Trial 73 finished with value: 0.9790209790209791 and parameters: {&#39;bagging_fraction&#39;: 0.8686169000157249, &#39;bagging_freq&#39;: 0, &#39;min_child_samples&#39;: 50}. Best is trial 1 with value: 0.986013986013986.
Trial 74 pruned. Trial was pruned at iteration 0.
Trial 75 pruned. Trial was pruned at iteration 2.
Trial 76 pruned. Trial was pruned at iteration 0.
Trial 77 finished with value: 0.972027972027972 and parameters: {&#39;bagging_fraction&#39;: 0.7707450121261304, &#39;bagging_freq&#39;: 0, &#39;min_child_samples&#39;: 29}. Best is trial 1 with value: 0.986013986013986.
Trial 78 pruned. Trial was pruned at iteration 0.
Trial 79 pruned. Trial was pruned at iteration 0.
Trial 80 pruned. Trial was pruned at iteration 0.
Trial 81 pruned. Trial was pruned at iteration 0.
Trial 82 pruned. Trial was pruned at iteration 0.
Trial 83 pruned. Trial was pruned at iteration 0.
Trial 84 pruned. Trial was pruned at iteration 0.
Trial 85 pruned. Trial was pruned at iteration 4.
Trial 86 pruned. Trial was pruned at iteration 0.
Trial 87 pruned. Trial was pruned at iteration 0.
Trial 88 pruned. Trial was pruned at iteration 0.
Trial 89 pruned. Trial was pruned at iteration 0.
Trial 90 pruned. Trial was pruned at iteration 0.
Trial 91 pruned. Trial was pruned at iteration 0.
Trial 92 pruned. Trial was pruned at iteration 0.
Trial 93 pruned. Trial was pruned at iteration 0.
Trial 94 pruned. Trial was pruned at iteration 0.
Trial 95 pruned. Trial was pruned at iteration 0.
Trial 96 pruned. Trial was pruned at iteration 0.
Trial 97 pruned. Trial was pruned at iteration 0.
Trial 98 pruned. Trial was pruned at iteration 0.
Trial 99 pruned. Trial was pruned at iteration 0.
</pre></div>
</div>
</section>
<section id="second-scenario-have-optuna-utilize-already-evaluated-hyperparameters">
<span id="add-trial-tutorial"></span><h6 aria-level="7">Second scenario: Have Optuna utilize already evaluated hyperparameters<a class="headerlink" href="#second-scenario-have-optuna-utilize-already-evaluated-hyperparameters" title="Permalink to this heading"></a></h6>
<p>In this scenario, let’s assume you have some out-of-box sets of hyperparameters and
you have already evaluated them but the results are not desirable so that you are thinking of
using Optuna.</p>
<p>Optuna has <a class="reference internal" href="index.html#optuna.study.Study.add_trial" title="optuna.study.Study.add_trial"><code class="xref py py-func docutils literal notranslate"><span class="pre">optuna.study.Study.add_trial()</span></code></a> which lets you register those results
to Optuna and then Optuna will sample hyperparameters taking them into account.</p>
<p>In this section,  the <code class="docutils literal notranslate"><span class="pre">objective</span></code> is the same as the first scenario.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;maximize&quot;</span><span class="p">,</span> <span class="n">pruner</span><span class="o">=</span><span class="n">optuna</span><span class="o">.</span><span class="n">pruners</span><span class="o">.</span><span class="n">MedianPruner</span><span class="p">())</span>
<span class="n">study</span><span class="o">.</span><span class="n">add_trial</span><span class="p">(</span>
    <span class="n">optuna</span><span class="o">.</span><span class="n">trial</span><span class="o">.</span><span class="n">create_trial</span><span class="p">(</span>
        <span class="n">params</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;bagging_fraction&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span>
            <span class="s2">&quot;bagging_freq&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
            <span class="s2">&quot;min_child_samples&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="n">distributions</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;bagging_fraction&quot;</span><span class="p">:</span> <span class="n">optuna</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">FloatDistribution</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="mf">1e-12</span><span class="p">),</span>
            <span class="s2">&quot;bagging_freq&quot;</span><span class="p">:</span> <span class="n">optuna</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">IntDistribution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
            <span class="s2">&quot;min_child_samples&quot;</span><span class="p">:</span> <span class="n">optuna</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">IntDistribution</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
        <span class="p">},</span>
        <span class="n">value</span><span class="o">=</span><span class="mf">0.94</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">study</span><span class="o">.</span><span class="n">add_trial</span><span class="p">(</span>
    <span class="n">optuna</span><span class="o">.</span><span class="n">trial</span><span class="o">.</span><span class="n">create_trial</span><span class="p">(</span>
        <span class="n">params</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;bagging_fraction&quot;</span><span class="p">:</span> <span class="mf">0.75</span><span class="p">,</span>
            <span class="s2">&quot;bagging_freq&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
            <span class="s2">&quot;min_child_samples&quot;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span>
        <span class="p">},</span>
        <span class="n">distributions</span><span class="o">=</span><span class="p">{</span>
            <span class="s2">&quot;bagging_fraction&quot;</span><span class="p">:</span> <span class="n">optuna</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">FloatDistribution</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="mf">1e-12</span><span class="p">),</span>
            <span class="s2">&quot;bagging_freq&quot;</span><span class="p">:</span> <span class="n">optuna</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">IntDistribution</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">7</span><span class="p">),</span>
            <span class="s2">&quot;min_child_samples&quot;</span><span class="p">:</span> <span class="n">optuna</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">IntDistribution</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span>
        <span class="p">},</span>
        <span class="n">value</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>A new study created in memory with name: no-name-1a29add2-15f2-4a61-b6a9-a1f1947a3c3d
Trial 2 finished with value: 0.9370629370629371 and parameters: {&#39;bagging_fraction&#39;: 0.5362261318819717, &#39;bagging_freq&#39;: 1, &#39;min_child_samples&#39;: 68}. Best is trial 1 with value: 0.95.
Trial 3 finished with value: 0.986013986013986 and parameters: {&#39;bagging_fraction&#39;: 0.9019893102213383, &#39;bagging_freq&#39;: 7, &#39;min_child_samples&#39;: 65}. Best is trial 3 with value: 0.986013986013986.
Trial 4 finished with value: 0.965034965034965 and parameters: {&#39;bagging_fraction&#39;: 0.5095303460422256, &#39;bagging_freq&#39;: 5, &#39;min_child_samples&#39;: 54}. Best is trial 3 with value: 0.986013986013986.
Trial 5 pruned. Trial was pruned at iteration 1.
Trial 6 pruned. Trial was pruned at iteration 2.
Trial 7 pruned. Trial was pruned at iteration 1.
Trial 8 pruned. Trial was pruned at iteration 1.
Trial 9 pruned. Trial was pruned at iteration 0.
Trial 10 pruned. Trial was pruned at iteration 0.
Trial 11 pruned. Trial was pruned at iteration 1.
Trial 12 pruned. Trial was pruned at iteration 1.
Trial 13 pruned. Trial was pruned at iteration 0.
Trial 14 pruned. Trial was pruned at iteration 0.
Trial 15 pruned. Trial was pruned at iteration 2.
Trial 16 pruned. Trial was pruned at iteration 0.
Trial 17 pruned. Trial was pruned at iteration 1.
Trial 18 pruned. Trial was pruned at iteration 3.
Trial 19 pruned. Trial was pruned at iteration 0.
Trial 20 finished with value: 0.986013986013986 and parameters: {&#39;bagging_fraction&#39;: 0.9325282568253881, &#39;bagging_freq&#39;: 5, &#39;min_child_samples&#39;: 43}. Best is trial 3 with value: 0.986013986013986.
Trial 21 pruned. Trial was pruned at iteration 1.
Trial 22 pruned. Trial was pruned at iteration 0.
Trial 23 pruned. Trial was pruned at iteration 0.
Trial 24 pruned. Trial was pruned at iteration 1.
Trial 25 pruned. Trial was pruned at iteration 0.
Trial 26 finished with value: 0.972027972027972 and parameters: {&#39;bagging_fraction&#39;: 0.9551159014861489, &#39;bagging_freq&#39;: 5, &#39;min_child_samples&#39;: 48}. Best is trial 3 with value: 0.986013986013986.
Trial 27 pruned. Trial was pruned at iteration 1.
Trial 28 pruned. Trial was pruned at iteration 0.
Trial 29 pruned. Trial was pruned at iteration 0.
Trial 30 pruned. Trial was pruned at iteration 0.
Trial 31 pruned. Trial was pruned at iteration 0.
Trial 32 pruned. Trial was pruned at iteration 2.
Trial 33 pruned. Trial was pruned at iteration 0.
Trial 34 pruned. Trial was pruned at iteration 1.
Trial 35 pruned. Trial was pruned at iteration 1.
Trial 36 pruned. Trial was pruned at iteration 0.
Trial 37 pruned. Trial was pruned at iteration 1.
Trial 38 pruned. Trial was pruned at iteration 0.
Trial 39 pruned. Trial was pruned at iteration 0.
Trial 40 pruned. Trial was pruned at iteration 0.
Trial 41 pruned. Trial was pruned at iteration 9.
Trial 42 pruned. Trial was pruned at iteration 1.
Trial 43 pruned. Trial was pruned at iteration 0.
Trial 44 finished with value: 0.986013986013986 and parameters: {&#39;bagging_fraction&#39;: 0.8931031638375868, &#39;bagging_freq&#39;: 6, &#39;min_child_samples&#39;: 24}. Best is trial 3 with value: 0.986013986013986.
Trial 45 pruned. Trial was pruned at iteration 0.
Trial 46 pruned. Trial was pruned at iteration 0.
Trial 47 pruned. Trial was pruned at iteration 1.
Trial 48 pruned. Trial was pruned at iteration 1.
Trial 49 pruned. Trial was pruned at iteration 0.
Trial 50 pruned. Trial was pruned at iteration 0.
Trial 51 pruned. Trial was pruned at iteration 0.
Trial 52 pruned. Trial was pruned at iteration 1.
Trial 53 pruned. Trial was pruned at iteration 3.
Trial 54 pruned. Trial was pruned at iteration 0.
Trial 55 pruned. Trial was pruned at iteration 0.
Trial 56 pruned. Trial was pruned at iteration 0.
Trial 57 pruned. Trial was pruned at iteration 0.
Trial 58 pruned. Trial was pruned at iteration 0.
Trial 59 pruned. Trial was pruned at iteration 1.
Trial 60 pruned. Trial was pruned at iteration 1.
Trial 61 pruned. Trial was pruned at iteration 0.
Trial 62 finished with value: 0.9790209790209791 and parameters: {&#39;bagging_fraction&#39;: 0.9696261242634613, &#39;bagging_freq&#39;: 0, &#39;min_child_samples&#39;: 16}. Best is trial 3 with value: 0.986013986013986.
Trial 63 pruned. Trial was pruned at iteration 0.
Trial 64 pruned. Trial was pruned at iteration 0.
Trial 65 pruned. Trial was pruned at iteration 1.
Trial 66 pruned. Trial was pruned at iteration 1.
Trial 67 pruned. Trial was pruned at iteration 0.
Trial 68 pruned. Trial was pruned at iteration 1.
Trial 69 pruned. Trial was pruned at iteration 0.
Trial 70 pruned. Trial was pruned at iteration 0.
Trial 71 finished with value: 0.958041958041958 and parameters: {&#39;bagging_fraction&#39;: 0.9977593194421507, &#39;bagging_freq&#39;: 0, &#39;min_child_samples&#39;: 9}. Best is trial 3 with value: 0.986013986013986.
Trial 72 pruned. Trial was pruned at iteration 0.
Trial 73 pruned. Trial was pruned at iteration 0.
Trial 74 finished with value: 0.986013986013986 and parameters: {&#39;bagging_fraction&#39;: 0.9588189264559034, &#39;bagging_freq&#39;: 1, &#39;min_child_samples&#39;: 23}. Best is trial 3 with value: 0.986013986013986.
Trial 75 pruned. Trial was pruned at iteration 0.
Trial 76 finished with value: 0.986013986013986 and parameters: {&#39;bagging_fraction&#39;: 0.9798311271965396, &#39;bagging_freq&#39;: 0, &#39;min_child_samples&#39;: 8}. Best is trial 3 with value: 0.986013986013986.
Trial 77 pruned. Trial was pruned at iteration 0.
Trial 78 pruned. Trial was pruned at iteration 0.
Trial 79 pruned. Trial was pruned at iteration 0.
Trial 80 pruned. Trial was pruned at iteration 0.
Trial 81 pruned. Trial was pruned at iteration 1.
Trial 82 pruned. Trial was pruned at iteration 0.
Trial 83 pruned. Trial was pruned at iteration 0.
Trial 84 pruned. Trial was pruned at iteration 0.
Trial 85 pruned. Trial was pruned at iteration 0.
Trial 86 pruned. Trial was pruned at iteration 0.
Trial 87 pruned. Trial was pruned at iteration 0.
Trial 88 pruned. Trial was pruned at iteration 0.
Trial 89 pruned. Trial was pruned at iteration 0.
Trial 90 pruned. Trial was pruned at iteration 0.
Trial 91 pruned. Trial was pruned at iteration 0.
Trial 92 pruned. Trial was pruned at iteration 0.
Trial 93 pruned. Trial was pruned at iteration 0.
Trial 94 pruned. Trial was pruned at iteration 5.
Trial 95 pruned. Trial was pruned at iteration 0.
Trial 96 pruned. Trial was pruned at iteration 0.
Trial 97 pruned. Trial was pruned at iteration 0.
Trial 98 pruned. Trial was pruned at iteration 0.
Trial 99 pruned. Trial was pruned at iteration 0.
Trial 100 pruned. Trial was pruned at iteration 0.
Trial 101 pruned. Trial was pruned at iteration 0.
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  8.573 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-tutorial-20-recipes-008-specify-params-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="_downloads/96bd24c3b2da471da078487d5b29374f/008_specify_params.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">008_specify_params.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="_downloads/500d8afeaf8e808ed1a42064b3c9ea44/008_specify_params.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">008_specify_params.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>
<span id="document-tutorial/20_recipes/009_ask_and_tell"></span><div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-tutorial-20-recipes-009-ask-and-tell-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="ask-and-tell-interface">
<span id="ask-and-tell"></span><span id="sphx-glr-tutorial-20-recipes-009-ask-and-tell-py"></span><h6>Ask-and-Tell Interface<a class="headerlink" href="#ask-and-tell-interface" title="Permalink to this heading"></a></h6>
<p>Optuna has an <cite>Ask-and-Tell</cite> interface, which provides a more flexible interface for hyperparameter optimization.
This tutorial explains three use-cases when the ask-and-tell interface is beneficial:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#apply-optuna-to-an-existing-optimization-problem-with-minimum-modifications"><span class="std std-ref">Apply Optuna to an existing optimization problem with minimum modifications</span></a></p></li>
<li><p><a class="reference internal" href="#define-and-run"><span class="std std-ref">Define-and-Run</span></a></p></li>
<li><p><a class="reference internal" href="#batch-optimization"><span class="std std-ref">Batch Optimization</span></a></p></li>
</ul>
<section id="apply-optuna-to-an-existing-optimization-problem-with-minimum-modifications">
<span id="id1"></span><h6 aria-level="7">Apply Optuna to an existing optimization problem with minimum modifications<a class="headerlink" href="#apply-optuna-to-an-existing-optimization-problem-with-minimum-modifications" title="Permalink to this heading"></a></h6>
<p>Let’s consider the traditional supervised classification problem; you aim to maximize the validation accuracy.
To do so, you train <cite>LogisticRegression</cite> as a simple model.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_classification</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="kn">import</span> <span class="nn">optuna</span>


<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_classification</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">C</span> <span class="o">=</span> <span class="mf">0.01</span>
<span class="n">clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">val_accuracy</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>  <span class="c1"># the objective</span>
</pre></div>
</div>
<p>Then you try to optimize hyperparameters <code class="docutils literal notranslate"><span class="pre">C</span></code> and <code class="docutils literal notranslate"><span class="pre">solver</span></code> of the classifier by using optuna.
When you introduce optuna naively, you define an <code class="docutils literal notranslate"><span class="pre">objective</span></code> function
such that it takes <code class="docutils literal notranslate"><span class="pre">trial</span></code> and calls <code class="docutils literal notranslate"><span class="pre">suggest_*</span></code> methods of <code class="docutils literal notranslate"><span class="pre">trial</span></code> to sample the hyperparameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_classification</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="n">C</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="mf">1e-7</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_categorical</span><span class="p">(</span><span class="s2">&quot;solver&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;lbfgs&quot;</span><span class="p">,</span> <span class="s2">&quot;saga&quot;</span><span class="p">))</span>

    <span class="n">clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">solver</span><span class="p">)</span>
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">val_accuracy</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">val_accuracy</span>


<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;maximize&quot;</span><span class="p">)</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>This interface is not flexible enough.
For example, if <code class="docutils literal notranslate"><span class="pre">objective</span></code> requires additional arguments other than <code class="docutils literal notranslate"><span class="pre">trial</span></code>,
you need to define a class as in
<a class="reference external" href="../../faq.html#how-to-define-objective-functions-that-have-own-arguments">How to define objective functions that have own arguments?</a>.
The ask-and-tell interface provides a more flexible syntax to optimize hyperparameters.
The following example is equivalent to the previous code block.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;maximize&quot;</span><span class="p">)</span>

<span class="n">n_trials</span> <span class="o">=</span> <span class="mi">10</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_trials</span><span class="p">):</span>
    <span class="n">trial</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">ask</span><span class="p">()</span>  <span class="c1"># `trial` is a `Trial` and not a `FrozenTrial`.</span>

    <span class="n">C</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="mf">1e-7</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_categorical</span><span class="p">(</span><span class="s2">&quot;solver&quot;</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot;lbfgs&quot;</span><span class="p">,</span> <span class="s2">&quot;saga&quot;</span><span class="p">))</span>

    <span class="n">clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">solver</span><span class="p">)</span>
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">val_accuracy</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

    <span class="n">study</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">trial</span><span class="p">,</span> <span class="n">val_accuracy</span><span class="p">)</span>  <span class="c1"># tell the pair of trial and objective value</span>
</pre></div>
</div>
<p>The main difference is to use two methods: <a class="reference internal" href="index.html#optuna.study.Study.ask" title="optuna.study.Study.ask"><code class="xref py py-func docutils literal notranslate"><span class="pre">optuna.study.Study.ask()</span></code></a>
and <a class="reference internal" href="index.html#optuna.study.Study.tell" title="optuna.study.Study.tell"><code class="xref py py-func docutils literal notranslate"><span class="pre">optuna.study.Study.tell()</span></code></a>.
<a class="reference internal" href="index.html#optuna.study.Study.ask" title="optuna.study.Study.ask"><code class="xref py py-func docutils literal notranslate"><span class="pre">optuna.study.Study.ask()</span></code></a> creates a trial that can sample hyperparameters, and
<a class="reference internal" href="index.html#optuna.study.Study.tell" title="optuna.study.Study.tell"><code class="xref py py-func docutils literal notranslate"><span class="pre">optuna.study.Study.tell()</span></code></a> finishes the trial by passing <code class="docutils literal notranslate"><span class="pre">trial</span></code> and an objective value.
You can apply Optuna’s hyperparameter optimization to your original code
without an <code class="docutils literal notranslate"><span class="pre">objective</span></code> function.</p>
<p>If you want to make your optimization faster with a pruner, you need to explicitly pass the state of trial
to the argument of <a class="reference internal" href="index.html#optuna.study.Study.tell" title="optuna.study.Study.tell"><code class="xref py py-func docutils literal notranslate"><span class="pre">optuna.study.Study.tell()</span></code></a> method as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">load_iris</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">SGDClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="kn">import</span> <span class="nn">optuna</span>


<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">load_iris</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_valid</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_valid</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">classes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="n">n_train_iter</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># define study with hyperband pruner.</span>
<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span>
    <span class="n">direction</span><span class="o">=</span><span class="s2">&quot;maximize&quot;</span><span class="p">,</span>
    <span class="n">pruner</span><span class="o">=</span><span class="n">optuna</span><span class="o">.</span><span class="n">pruners</span><span class="o">.</span><span class="n">HyperbandPruner</span><span class="p">(</span>
        <span class="n">min_resource</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_resource</span><span class="o">=</span><span class="n">n_train_iter</span><span class="p">,</span> <span class="n">reduction_factor</span><span class="o">=</span><span class="mi">3</span>
    <span class="p">),</span>
<span class="p">)</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">20</span><span class="p">):</span>
    <span class="n">trial</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">ask</span><span class="p">()</span>

    <span class="n">alpha</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;alpha&quot;</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="n">clf</span> <span class="o">=</span> <span class="n">SGDClassifier</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">pruned_trial</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_train_iter</span><span class="p">):</span>
        <span class="n">clf</span><span class="o">.</span><span class="n">partial_fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">classes</span><span class="o">=</span><span class="n">classes</span><span class="p">)</span>

        <span class="n">intermediate_value</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_valid</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">)</span>
        <span class="n">trial</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="n">intermediate_value</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">trial</span><span class="o">.</span><span class="n">should_prune</span><span class="p">():</span>
            <span class="n">pruned_trial</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">break</span>

    <span class="k">if</span> <span class="n">pruned_trial</span><span class="p">:</span>
        <span class="n">study</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">trial</span><span class="p">,</span> <span class="n">state</span><span class="o">=</span><span class="n">optuna</span><span class="o">.</span><span class="n">trial</span><span class="o">.</span><span class="n">TrialState</span><span class="o">.</span><span class="n">PRUNED</span><span class="p">)</span>  <span class="c1"># tell the pruned state</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">score</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_valid</span><span class="p">,</span> <span class="n">y_valid</span><span class="p">)</span>
        <span class="n">study</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">trial</span><span class="p">,</span> <span class="n">score</span><span class="p">)</span>  <span class="c1"># tell objective value</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="index.html#optuna.study.Study.tell" title="optuna.study.Study.tell"><code class="xref py py-func docutils literal notranslate"><span class="pre">optuna.study.Study.tell()</span></code></a> method can take a trial number rather than the trial object.
<code class="docutils literal notranslate"><span class="pre">study.tell(trial.number,</span> <span class="pre">y)</span></code> is equivalent to <code class="docutils literal notranslate"><span class="pre">study.tell(trial,</span> <span class="pre">y)</span></code>.</p>
</div>
</section>
<section id="define-and-run">
<span id="id2"></span><h6 aria-level="7">Define-and-Run<a class="headerlink" href="#define-and-run" title="Permalink to this heading"></a></h6>
<p>The ask-and-tell interface supports both <cite>define-by-run</cite> and <cite>define-and-run</cite> APIs.
This section shows the example of the <cite>define-and-run</cite> API
in addition to the define-by-run example above.</p>
<p>Define distributions for the hyperparameters before calling the
<a class="reference internal" href="index.html#optuna.study.Study.ask" title="optuna.study.Study.ask"><code class="xref py py-func docutils literal notranslate"><span class="pre">optuna.study.Study.ask()</span></code></a> method for define-and-run API.
For example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">distributions</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;C&quot;</span><span class="p">:</span> <span class="n">optuna</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">FloatDistribution</span><span class="p">(</span><span class="mf">1e-7</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">),</span>
    <span class="s2">&quot;solver&quot;</span><span class="p">:</span> <span class="n">optuna</span><span class="o">.</span><span class="n">distributions</span><span class="o">.</span><span class="n">CategoricalDistribution</span><span class="p">((</span><span class="s2">&quot;lbfgs&quot;</span><span class="p">,</span> <span class="s2">&quot;saga&quot;</span><span class="p">)),</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Pass <code class="docutils literal notranslate"><span class="pre">distributions</span></code> to <a class="reference internal" href="index.html#optuna.study.Study.ask" title="optuna.study.Study.ask"><code class="xref py py-func docutils literal notranslate"><span class="pre">optuna.study.Study.ask()</span></code></a> method at each call.
The retuned <code class="docutils literal notranslate"><span class="pre">trial</span></code> contains the suggested hyperparameters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;maximize&quot;</span><span class="p">)</span>
<span class="n">n_trials</span> <span class="o">=</span> <span class="mi">10</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_trials</span><span class="p">):</span>
    <span class="n">trial</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="n">distributions</span><span class="p">)</span>  <span class="c1"># pass the pre-defined distributions.</span>

    <span class="c1"># two hyperparameters are already sampled from the pre-defined distributions</span>
    <span class="n">C</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;C&quot;</span><span class="p">]</span>
    <span class="n">solver</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;solver&quot;</span><span class="p">]</span>

    <span class="n">clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">,</span> <span class="n">solver</span><span class="o">=</span><span class="n">solver</span><span class="p">)</span>
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
    <span class="n">val_accuracy</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

    <span class="n">study</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">trial</span><span class="p">,</span> <span class="n">val_accuracy</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="batch-optimization">
<span id="id3"></span><h6 aria-level="7">Batch Optimization<a class="headerlink" href="#batch-optimization" title="Permalink to this heading"></a></h6>
<p>The ask-and-tell interface enables us to optimize a batched objective for faster optimization.
For example, parallelizable evaluation, operation over vectors, etc.</p>
<p>The following objective takes batched hyperparameters <code class="docutils literal notranslate"><span class="pre">xs</span></code> and <code class="docutils literal notranslate"><span class="pre">ys</span></code> instead of a single
pair of hyperparameters <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> and calculates the objective over the full vectors.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">batched_objective</span><span class="p">(</span><span class="n">xs</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">ys</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">xs</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">ys</span>
</pre></div>
</div>
<p>In the following example, the number of pairs of hyperparameters in a batch is <span class="math notranslate nohighlight">\(10\)</span>,
and <code class="docutils literal notranslate"><span class="pre">batched_objective</span></code> is evaluated three times.
Thus, the number of trials is <span class="math notranslate nohighlight">\(30\)</span>.
Note that you need to store either <code class="docutils literal notranslate"><span class="pre">trial_numbers</span></code> or <code class="docutils literal notranslate"><span class="pre">trial</span></code> to call
<a class="reference internal" href="index.html#optuna.study.Study.tell" title="optuna.study.Study.tell"><code class="xref py py-func docutils literal notranslate"><span class="pre">optuna.study.Study.tell()</span></code></a> method after the batched evaluations.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">sampler</span><span class="o">=</span><span class="n">optuna</span><span class="o">.</span><span class="n">samplers</span><span class="o">.</span><span class="n">CmaEsSampler</span><span class="p">())</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="c1"># create batch</span>
    <span class="n">trial_numbers</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">x_batch</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">y_batch</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">batch_size</span><span class="p">):</span>
        <span class="n">trial</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">ask</span><span class="p">()</span>
        <span class="n">trial_numbers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trial</span><span class="o">.</span><span class="n">number</span><span class="p">)</span>
        <span class="n">x_batch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
        <span class="n">y_batch</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="c1"># evaluate batched objective</span>
    <span class="n">x_batch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x_batch</span><span class="p">)</span>
    <span class="n">y_batch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y_batch</span><span class="p">)</span>
    <span class="n">objectives</span> <span class="o">=</span> <span class="n">batched_objective</span><span class="p">(</span><span class="n">x_batch</span><span class="p">,</span> <span class="n">y_batch</span><span class="p">)</span>

    <span class="c1"># finish all trials in the batch</span>
    <span class="k">for</span> <span class="n">trial_number</span><span class="p">,</span> <span class="n">objective</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">trial_numbers</span><span class="p">,</span> <span class="n">objectives</span><span class="p">):</span>
        <span class="n">study</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">trial_number</span><span class="p">,</span> <span class="n">objective</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.141 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-tutorial-20-recipes-009-ask-and-tell-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="_downloads/a6d16f5a7630e2042b959f18c4d3f2e5/009_ask_and_tell.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">009_ask_and_tell.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="_downloads/9e17bbf554dfa22e6c92f27c8c7df53d/009_ask_and_tell.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">009_ask_and_tell.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>
<span id="document-tutorial/20_recipes/010_reuse_best_trial"></span><div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-tutorial-20-recipes-010-reuse-best-trial-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="re-use-the-best-trial">
<span id="reuse-best-trial"></span><span id="sphx-glr-tutorial-20-recipes-010-reuse-best-trial-py"></span><h6>Re-use the best trial<a class="headerlink" href="#re-use-the-best-trial" title="Permalink to this heading"></a></h6>
<p>In some cases, you may want to re-evaluate the objective function with the best
hyperparameters again after the hyperparameter optimization.</p>
<p>For example,</p>
<ul class="simple">
<li><p>You have found good hyperparameters with Optuna and want to run a similar <cite>objective</cite> function using the best hyperparameters found so far to further analyze the results, or</p></li>
<li><p>You have optimized with Optuna using a partial dataset to reduce training time. After the hyperparameter tuning, you want to train the model using the whole dataset with the best hyperparameter values found.</p></li>
</ul>
<p><a class="reference internal" href="index.html#optuna.study.Study.best_trial" title="optuna.study.Study.best_trial"><code class="xref py py-class docutils literal notranslate"><span class="pre">best_trial</span></code></a> provides an interface to re-evaluate the objective function with the current best hyperparameter values.</p>
<p>This tutorial shows an example of how to re-run a different <cite>objective</cite> function with the current best values, like the first example above.</p>
<section id="investigating-the-best-model-further">
<h6 aria-level="7">Investigating the best model further<a class="headerlink" href="#investigating-the-best-model-further" title="Permalink to this heading"></a></h6>
<p>Let’s consider a classical supervised classification problem with Optuna as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_classification</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>


<span class="kn">import</span> <span class="nn">optuna</span>


<span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_classification</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">C</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="mf">1e-7</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">)</span>
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">clf</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>


<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">direction</span><span class="o">=</span><span class="s2">&quot;maximize&quot;</span><span class="p">)</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">study</span><span class="o">.</span><span class="n">best_trial</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>  <span class="c1"># Show the best value.</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>0.92
</pre></div>
</div>
<p>Suppose after the hyperparameter optimization, you want to calculate other evaluation metrics
such as recall, precision, and f1-score on the same dataset.
You can define another objective function that shares most of the <code class="docutils literal notranslate"><span class="pre">objective</span></code>
function to reproduce the model with the best hyperparameters.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">detailed_objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="c1"># Use same code objective to reproduce the best model</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">make_classification</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">C</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;C&quot;</span><span class="p">,</span> <span class="mf">1e-7</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="n">clf</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">)</span>
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="c1"># calculate more evaluation metrics</span>
    <span class="n">pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

    <span class="n">acc</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
    <span class="n">recall</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">recall_score</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
    <span class="n">precision</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">precision_score</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>
    <span class="n">f1</span> <span class="o">=</span> <span class="n">metrics</span><span class="o">.</span><span class="n">f1_score</span><span class="p">(</span><span class="n">pred</span><span class="p">,</span> <span class="n">y_test</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">acc</span><span class="p">,</span> <span class="n">f1</span><span class="p">,</span> <span class="n">recall</span><span class="p">,</span> <span class="n">precision</span>
</pre></div>
</div>
<p>Pass <code class="docutils literal notranslate"><span class="pre">study.best_trial</span></code> as the argument of <code class="docutils literal notranslate"><span class="pre">detailed_objective</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">detailed_objective</span><span class="p">(</span><span class="n">study</span><span class="o">.</span><span class="n">best_trial</span><span class="p">)</span>  <span class="c1"># calculate acc, f1, recall, and precision</span>
</pre></div>
</div>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>(0.92, 0.9285714285714286, 0.9285714285714286, 0.9285714285714286)
</pre></div>
</div>
</section>
<section id="the-difference-between-best-trial-and-ordinal-trials">
<h6 aria-level="7">The difference between <a class="reference internal" href="index.html#optuna.study.Study.best_trial" title="optuna.study.Study.best_trial"><code class="xref py py-class docutils literal notranslate"><span class="pre">best_trial</span></code></a> and ordinal trials<a class="headerlink" href="#the-difference-between-best-trial-and-ordinal-trials" title="Permalink to this heading"></a></h6>
<p>This uses <a class="reference internal" href="index.html#optuna.study.Study.best_trial" title="optuna.study.Study.best_trial"><code class="xref py py-class docutils literal notranslate"><span class="pre">best_trial</span></code></a>, which returns the <cite>best_trial</cite> as a
<a class="reference internal" href="index.html#optuna.trial.FrozenTrial" title="optuna.trial.FrozenTrial"><code class="xref py py-class docutils literal notranslate"><span class="pre">FrozenTrial</span></code></a>.
The <a class="reference internal" href="index.html#optuna.trial.FrozenTrial" title="optuna.trial.FrozenTrial"><code class="xref py py-class docutils literal notranslate"><span class="pre">FrozenTrial</span></code></a> is different from an active trial
and behaves differently from <a class="reference internal" href="index.html#optuna.trial.Trial" title="optuna.trial.Trial"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trial</span></code></a> in some situations.
For example, pruning does not work because <a class="reference internal" href="index.html#optuna.trial.FrozenTrial.should_prune" title="optuna.trial.FrozenTrial.should_prune"><code class="xref py py-class docutils literal notranslate"><span class="pre">should_prune</span></code></a>
always returns <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For multi-objective optimization as demonstrated by <a class="reference internal" href="index.html#multi-objective"><span class="std std-ref">Multi-objective Optimization with Optuna</span></a>,
<a class="reference internal" href="index.html#optuna.study.Study.best_trials" title="optuna.study.Study.best_trials"><code class="xref py py-attr docutils literal notranslate"><span class="pre">best_trials</span></code></a> returns a list of <a class="reference internal" href="index.html#optuna.trial.FrozenTrial" title="optuna.trial.FrozenTrial"><code class="xref py py-class docutils literal notranslate"><span class="pre">FrozenTrial</span></code></a>
on Pareto front. So we can re-use each trial in the list by the similar way above.</p>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.056 seconds)</p>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-tutorial-20-recipes-010-reuse-best-trial-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="_downloads/ae616d9a7a740c0b0d5df3ce2f1219c0/010_reuse_best_trial.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">010_reuse_best_trial.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="_downloads/cb03e4a8270496c3706a219bb148c889/010_reuse_best_trial.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">010_reuse_best_trial.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>
</div>
</section>
</div>
<div class="sphx-glr-footer sphx-glr-footer-gallery docutils container">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="_downloads/b5394b2bc43b85d45d21e95bba7fb498/tutorial_python.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">all</span> <span class="pre">examples</span> <span class="pre">in</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">tutorial_python.zip</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="_downloads/4566546f202d36219678b14214cd9a0a/tutorial_jupyter.zip"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">all</span> <span class="pre">examples</span> <span class="pre">in</span> <span class="pre">Jupyter</span> <span class="pre">notebooks:</span> <span class="pre">tutorial_jupyter.zip</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>
</section>
<span id="document-reference/index"></span><section id="api-reference">
<h3>API Reference<a class="headerlink" href="#api-reference" title="Permalink to this heading"></a></h3>
<div class="toctree-wrapper compound">
<span id="document-reference/optuna"></span><span class="target" id="module-optuna"></span><section id="optuna">
<h4>optuna<a class="headerlink" href="#optuna" title="Permalink to this heading"></a></h4>
<p>The <a class="reference internal" href="#module-optuna" title="optuna"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optuna</span></code></a> module is primarily used as an alias for basic Optuna functionality coded in other modules. Currently, two modules are aliased: (1) from <a class="reference internal" href="index.html#module-optuna.study" title="optuna.study"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optuna.study</span></code></a>, functions regarding the Study lifecycle, and (2) from <a class="reference internal" href="index.html#module-optuna.exceptions" title="optuna.exceptions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optuna.exceptions</span></code></a>, the TrialPruned Exception raised when a trial is pruned.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.create_study" title="optuna.create_study"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.create_study</span></code></a></p></td>
<td><p>Create a new <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.load_study" title="optuna.load_study"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.load_study</span></code></a></p></td>
<td><p>Load the existing <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a> that has the specified name.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.delete_study" title="optuna.delete_study"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.delete_study</span></code></a></p></td>
<td><p>Delete a <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a> object.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.copy_study" title="optuna.copy_study"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.copy_study</span></code></a></p></td>
<td><p>Copy study from one storage to another.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.get_all_study_summaries" title="optuna.get_all_study_summaries"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.get_all_study_summaries</span></code></a></p></td>
<td><p>Get all history of studies stored in a specified storage.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.TrialPruned" title="optuna.TrialPruned"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.TrialPruned</span></code></a></p></td>
<td><p>Exception for pruned trials.</p></td>
</tr>
</tbody>
</table>
</section>
<span id="document-reference/cli"></span><span class="target" id="module-optuna.cli"></span><section id="optuna-cli">
<h4>optuna.cli<a class="headerlink" href="#optuna-cli" title="Permalink to this heading"></a></h4>
<p>The <a class="reference internal" href="#module-optuna.cli" title="optuna.cli"><code class="xref py py-mod docutils literal notranslate"><span class="pre">cli</span></code></a> module implements Optuna’s command-line functionality.</p>
<p>For detail, please see the result of</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>optuna<span class="w"> </span>--help
</pre></div>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>The <a class="reference internal" href="index.html#cli"><span class="std std-ref">Command-Line Interface</span></a> tutorial provides use-cases with examples.</p>
</div>
</section>
<span id="document-reference/distributions"></span><span class="target" id="module-optuna.distributions"></span><section id="optuna-distributions">
<h4>optuna.distributions<a class="headerlink" href="#optuna-distributions" title="Permalink to this heading"></a></h4>
<p>The <a class="reference internal" href="#module-optuna.distributions" title="optuna.distributions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">distributions</span></code></a> module defines various classes representing probability distributions, mainly used to suggest initial hyperparameter values for an optimization trial. Distribution classes inherit from a library-internal <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseDistribution</span></code>, and is initialized with specific parameters, such as the <code class="docutils literal notranslate"><span class="pre">low</span></code> and <code class="docutils literal notranslate"><span class="pre">high</span></code> endpoints for a <a class="reference internal" href="index.html#optuna.distributions.IntDistribution" title="optuna.distributions.IntDistribution"><code class="xref py py-class docutils literal notranslate"><span class="pre">IntDistribution</span></code></a>.</p>
<p>Optuna users should not use distribution classes directly, but instead use utility functions provided by <a class="reference internal" href="index.html#optuna.trial.Trial" title="optuna.trial.Trial"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trial</span></code></a> such as <a class="reference internal" href="index.html#optuna.trial.Trial.suggest_int" title="optuna.trial.Trial.suggest_int"><code class="xref py py-meth docutils literal notranslate"><span class="pre">suggest_int()</span></code></a>.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.distributions.FloatDistribution" title="optuna.distributions.FloatDistribution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.distributions.FloatDistribution</span></code></a></p></td>
<td><p>A distribution on floats.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.distributions.IntDistribution" title="optuna.distributions.IntDistribution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.distributions.IntDistribution</span></code></a></p></td>
<td><p>A distribution on integers.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.distributions.UniformDistribution" title="optuna.distributions.UniformDistribution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.distributions.UniformDistribution</span></code></a></p></td>
<td><p>A uniform distribution in the linear domain.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.distributions.LogUniformDistribution" title="optuna.distributions.LogUniformDistribution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.distributions.LogUniformDistribution</span></code></a></p></td>
<td><p>A uniform distribution in the log domain.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.distributions.DiscreteUniformDistribution" title="optuna.distributions.DiscreteUniformDistribution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.distributions.DiscreteUniformDistribution</span></code></a></p></td>
<td><p>A discretized uniform distribution in the linear domain.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.distributions.IntUniformDistribution" title="optuna.distributions.IntUniformDistribution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.distributions.IntUniformDistribution</span></code></a></p></td>
<td><p>A uniform distribution on integers.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.distributions.IntLogUniformDistribution" title="optuna.distributions.IntLogUniformDistribution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.distributions.IntLogUniformDistribution</span></code></a></p></td>
<td><p>A uniform distribution on integers in the log domain.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.distributions.CategoricalDistribution" title="optuna.distributions.CategoricalDistribution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.distributions.CategoricalDistribution</span></code></a></p></td>
<td><p>A categorical distribution.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.distributions.distribution_to_json" title="optuna.distributions.distribution_to_json"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.distributions.distribution_to_json</span></code></a></p></td>
<td><p>Serialize a distribution to JSON format.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.distributions.json_to_distribution" title="optuna.distributions.json_to_distribution"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.distributions.json_to_distribution</span></code></a></p></td>
<td><p>Deserialize a distribution in JSON format.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.distributions.check_distribution_compatibility" title="optuna.distributions.check_distribution_compatibility"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.distributions.check_distribution_compatibility</span></code></a></p></td>
<td><p>A function to check compatibility of two distributions.</p></td>
</tr>
</tbody>
</table>
</section>
<span id="document-reference/exceptions"></span><span class="target" id="module-optuna.exceptions"></span><section id="optuna-exceptions">
<h4>optuna.exceptions<a class="headerlink" href="#optuna-exceptions" title="Permalink to this heading"></a></h4>
<p>The <a class="reference internal" href="#module-optuna.exceptions" title="optuna.exceptions"><code class="xref py py-mod docutils literal notranslate"><span class="pre">exceptions</span></code></a> module defines Optuna-specific exceptions deriving from a base <a class="reference internal" href="index.html#optuna.exceptions.OptunaError" title="optuna.exceptions.OptunaError"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptunaError</span></code></a> class. Of special importance for library users is the <a class="reference internal" href="index.html#optuna.exceptions.TrialPruned" title="optuna.exceptions.TrialPruned"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrialPruned</span></code></a> exception to be raised if <a class="reference internal" href="index.html#optuna.trial.Trial.should_prune" title="optuna.trial.Trial.should_prune"><code class="xref py py-func docutils literal notranslate"><span class="pre">optuna.trial.Trial.should_prune()</span></code></a> returns <code class="docutils literal notranslate"><span class="pre">True</span></code> for a trial that should be pruned.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.exceptions.OptunaError" title="optuna.exceptions.OptunaError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.exceptions.OptunaError</span></code></a></p></td>
<td><p>Base class for Optuna specific errors.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.exceptions.TrialPruned" title="optuna.exceptions.TrialPruned"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.exceptions.TrialPruned</span></code></a></p></td>
<td><p>Exception for pruned trials.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.exceptions.CLIUsageError" title="optuna.exceptions.CLIUsageError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.exceptions.CLIUsageError</span></code></a></p></td>
<td><p>Exception for CLI.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.exceptions.StorageInternalError" title="optuna.exceptions.StorageInternalError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.exceptions.StorageInternalError</span></code></a></p></td>
<td><p>Exception for storage operation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.exceptions.DuplicatedStudyError" title="optuna.exceptions.DuplicatedStudyError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.exceptions.DuplicatedStudyError</span></code></a></p></td>
<td><p>Exception for a duplicated study name.</p></td>
</tr>
</tbody>
</table>
</section>
<span id="document-reference/importance"></span><span class="target" id="module-optuna.importance"></span><section id="optuna-importance">
<h4>optuna.importance<a class="headerlink" href="#optuna-importance" title="Permalink to this heading"></a></h4>
<p>The <a class="reference internal" href="#module-optuna.importance" title="optuna.importance"><code class="xref py py-mod docutils literal notranslate"><span class="pre">importance</span></code></a> module provides functionality for evaluating hyperparameter importances based on completed trials in a given study. The utility function <a class="reference internal" href="index.html#optuna.importance.get_param_importances" title="optuna.importance.get_param_importances"><code class="xref py py-func docutils literal notranslate"><span class="pre">get_param_importances()</span></code></a> takes a <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a> and optional evaluator as two of its inputs. The evaluator must derive from <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseImportanceEvaluator</span></code>, and is initialized as a <a class="reference internal" href="index.html#optuna.importance.FanovaImportanceEvaluator" title="optuna.importance.FanovaImportanceEvaluator"><code class="xref py py-class docutils literal notranslate"><span class="pre">FanovaImportanceEvaluator</span></code></a> by default when not passed in. Users implementing custom evaluators should refer to either <a class="reference internal" href="index.html#optuna.importance.FanovaImportanceEvaluator" title="optuna.importance.FanovaImportanceEvaluator"><code class="xref py py-class docutils literal notranslate"><span class="pre">FanovaImportanceEvaluator</span></code></a> or <a class="reference internal" href="index.html#optuna.importance.MeanDecreaseImpurityImportanceEvaluator" title="optuna.importance.MeanDecreaseImpurityImportanceEvaluator"><code class="xref py py-class docutils literal notranslate"><span class="pre">MeanDecreaseImpurityImportanceEvaluator</span></code></a> as a guide, paying close attention to the format of the return value from the Evaluator’s <code class="docutils literal notranslate"><span class="pre">evaluate</span></code> function.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.importance.get_param_importances" title="optuna.importance.get_param_importances"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.importance.get_param_importances</span></code></a></p></td>
<td><p>Evaluate parameter importances based on completed trials in the given study.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.importance.FanovaImportanceEvaluator" title="optuna.importance.FanovaImportanceEvaluator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.importance.FanovaImportanceEvaluator</span></code></a></p></td>
<td><p>fANOVA importance evaluator.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.importance.MeanDecreaseImpurityImportanceEvaluator" title="optuna.importance.MeanDecreaseImpurityImportanceEvaluator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.importance.MeanDecreaseImpurityImportanceEvaluator</span></code></a></p></td>
<td><p>Mean Decrease Impurity (MDI) parameter importance evaluator.</p></td>
</tr>
</tbody>
</table>
</section>
<span id="document-reference/integration"></span><span class="target" id="module-optuna.integration"></span><section id="optuna-integration">
<h4>optuna.integration<a class="headerlink" href="#optuna-integration" title="Permalink to this heading"></a></h4>
<p>The <a class="reference internal" href="#module-optuna.integration" title="optuna.integration"><code class="xref py py-mod docutils literal notranslate"><span class="pre">integration</span></code></a> module contains classes used to integrate Optuna with external machine learning frameworks.</p>
<p>For most of the ML frameworks supported by Optuna, the corresponding Optuna integration class serves only to implement a callback object and functions, compliant with the framework’s specific callback API, to be called with each intermediate step in the model training. The functionality implemented in these callbacks across the different ML frameworks includes:</p>
<ol class="arabic simple">
<li><p>Reporting intermediate model scores back to the Optuna trial using <a class="reference internal" href="index.html#optuna.trial.Trial.report" title="optuna.trial.Trial.report"><code class="xref py py-func docutils literal notranslate"><span class="pre">optuna.trial.Trial.report()</span></code></a>,</p></li>
<li><p>According to the results of <a class="reference internal" href="index.html#optuna.trial.Trial.should_prune" title="optuna.trial.Trial.should_prune"><code class="xref py py-func docutils literal notranslate"><span class="pre">optuna.trial.Trial.should_prune()</span></code></a>, pruning the current model by raising <a class="reference internal" href="index.html#optuna.TrialPruned" title="optuna.TrialPruned"><code class="xref py py-func docutils literal notranslate"><span class="pre">optuna.TrialPruned()</span></code></a>, and</p></li>
<li><p>Reporting intermediate Optuna data such as the current trial number back to the framework, as done in <a class="reference internal" href="index.html#optuna.integration.MLflowCallback" title="optuna.integration.MLflowCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">MLflowCallback</span></code></a>.</p></li>
</ol>
<p>For scikit-learn, an integrated <a class="reference internal" href="index.html#optuna.integration.OptunaSearchCV" title="optuna.integration.OptunaSearchCV"><code class="xref py py-class docutils literal notranslate"><span class="pre">OptunaSearchCV</span></code></a> estimator is available that combines scikit-learn BaseEstimator functionality with access to a class-level <code class="docutils literal notranslate"><span class="pre">Study</span></code> object.</p>
<section id="allennlp">
<h5>AllenNLP<a class="headerlink" href="#allennlp" title="Permalink to this heading"></a></h5>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.AllenNLPExecutor" title="optuna.integration.AllenNLPExecutor"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.AllenNLPExecutor</span></code></a></p></td>
<td><p>AllenNLP extension to use optuna with Jsonnet config file.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.integration.allennlp.dump_best_config" title="optuna.integration.allennlp.dump_best_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.allennlp.dump_best_config</span></code></a></p></td>
<td><p>Save JSON config file with environment variables and best performing hyperparameters.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.AllenNLPPruningCallback" title="optuna.integration.AllenNLPPruningCallback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.AllenNLPPruningCallback</span></code></a></p></td>
<td><p>AllenNLP callback to prune unpromising trials.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="botorch">
<h5>BoTorch<a class="headerlink" href="#botorch" title="Permalink to this heading"></a></h5>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.BoTorchSampler" title="optuna.integration.BoTorchSampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.BoTorchSampler</span></code></a></p></td>
<td><p>A sampler that uses BoTorch, a Bayesian optimization library built on top of PyTorch.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.integration.botorch.qei_candidates_func" title="optuna.integration.botorch.qei_candidates_func"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.botorch.qei_candidates_func</span></code></a></p></td>
<td><p>Quasi MC-based batch Expected Improvement (qEI).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.botorch.qehvi_candidates_func" title="optuna.integration.botorch.qehvi_candidates_func"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.botorch.qehvi_candidates_func</span></code></a></p></td>
<td><p>Quasi MC-based batch Expected Hypervolume Improvement (qEHVI).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.integration.botorch.qnehvi_candidates_func" title="optuna.integration.botorch.qnehvi_candidates_func"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.botorch.qnehvi_candidates_func</span></code></a></p></td>
<td><p>Quasi MC-based batch Expected Noisy Hypervolume Improvement (qNEHVI).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.botorch.qparego_candidates_func" title="optuna.integration.botorch.qparego_candidates_func"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.botorch.qparego_candidates_func</span></code></a></p></td>
<td><p>Quasi MC-based extended ParEGO (qParEGO) for constrained multi-objective optimization.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="catalyst">
<h5>Catalyst<a class="headerlink" href="#catalyst" title="Permalink to this heading"></a></h5>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.CatalystPruningCallback" title="optuna.integration.CatalystPruningCallback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.CatalystPruningCallback</span></code></a></p></td>
<td><p>Catalyst callback to prune unpromising trials.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="catboost">
<h5>CatBoost<a class="headerlink" href="#catboost" title="Permalink to this heading"></a></h5>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.CatBoostPruningCallback" title="optuna.integration.CatBoostPruningCallback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.CatBoostPruningCallback</span></code></a></p></td>
<td><p>Callback for catboost to prune unpromising trials.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="chainer">
<h5>Chainer<a class="headerlink" href="#chainer" title="Permalink to this heading"></a></h5>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.ChainerMNStudy" title="optuna.integration.ChainerMNStudy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.ChainerMNStudy</span></code></a></p></td>
<td><p>A wrapper of <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a> to incorporate Optuna with ChainerMN.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="dask">
<h5>Dask<a class="headerlink" href="#dask" title="Permalink to this heading"></a></h5>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.DaskStorage" title="optuna.integration.DaskStorage"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.DaskStorage</span></code></a></p></td>
<td><p>Dask-compatible storage class.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="fast-ai">
<h5>fast.ai<a class="headerlink" href="#fast-ai" title="Permalink to this heading"></a></h5>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.FastAIV1PruningCallback" title="optuna.integration.FastAIV1PruningCallback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.FastAIV1PruningCallback</span></code></a></p></td>
<td><p>FastAI callback to prune unpromising trials for fastai.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.integration.FastAIV2PruningCallback" title="optuna.integration.FastAIV2PruningCallback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.FastAIV2PruningCallback</span></code></a></p></td>
<td><p>FastAI callback to prune unpromising trials for fastai.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.FastAIPruningCallback" title="optuna.integration.FastAIPruningCallback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.FastAIPruningCallback</span></code></a></p></td>
<td><p>alias of <a class="reference internal" href="index.html#optuna.integration.FastAIV2PruningCallback" title="optuna.integration.fastaiv2.FastAIV2PruningCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">FastAIV2PruningCallback</span></code></a></p></td>
</tr>
</tbody>
</table>
</section>
<section id="keras">
<h5>Keras<a class="headerlink" href="#keras" title="Permalink to this heading"></a></h5>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.KerasPruningCallback" title="optuna.integration.KerasPruningCallback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.KerasPruningCallback</span></code></a></p></td>
<td><p>Keras callback to prune unpromising trials.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="lightgbm">
<h5>LightGBM<a class="headerlink" href="#lightgbm" title="Permalink to this heading"></a></h5>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.LightGBMPruningCallback" title="optuna.integration.LightGBMPruningCallback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.LightGBMPruningCallback</span></code></a></p></td>
<td><p>Callback for LightGBM to prune unpromising trials.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.integration.lightgbm.train" title="optuna.integration.lightgbm.train"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.lightgbm.train</span></code></a></p></td>
<td><p>Wrapper of LightGBM Training API to tune hyperparameters.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.lightgbm.LightGBMTuner" title="optuna.integration.lightgbm.LightGBMTuner"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.lightgbm.LightGBMTuner</span></code></a></p></td>
<td><p>Hyperparameter tuner for LightGBM.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.integration.lightgbm.LightGBMTunerCV" title="optuna.integration.lightgbm.LightGBMTunerCV"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.lightgbm.LightGBMTunerCV</span></code></a></p></td>
<td><p>Hyperparameter tuner for LightGBM with cross-validation.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="mlflow">
<h5>MLflow<a class="headerlink" href="#mlflow" title="Permalink to this heading"></a></h5>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.MLflowCallback" title="optuna.integration.MLflowCallback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.MLflowCallback</span></code></a></p></td>
<td><p>Callback to track Optuna trials with MLflow.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="weights-biases">
<h5>Weights &amp; Biases<a class="headerlink" href="#weights-biases" title="Permalink to this heading"></a></h5>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.WeightsAndBiasesCallback" title="optuna.integration.WeightsAndBiasesCallback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.WeightsAndBiasesCallback</span></code></a></p></td>
<td><p>Callback to track Optuna trials with Weights &amp; Biases.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="mxnet">
<h5>MXNet<a class="headerlink" href="#mxnet" title="Permalink to this heading"></a></h5>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.MXNetPruningCallback" title="optuna.integration.MXNetPruningCallback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.MXNetPruningCallback</span></code></a></p></td>
<td><p>MXNet callback to prune unpromising trials.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="pycma">
<h5>pycma<a class="headerlink" href="#pycma" title="Permalink to this heading"></a></h5>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.PyCmaSampler" title="optuna.integration.PyCmaSampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.PyCmaSampler</span></code></a></p></td>
<td><p>A Sampler using cma library as the backend.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.integration.CmaEsSampler" title="optuna.integration.CmaEsSampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.CmaEsSampler</span></code></a></p></td>
<td><p>Wrapper class of PyCmaSampler for backward compatibility.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="pytorch">
<h5>PyTorch<a class="headerlink" href="#pytorch" title="Permalink to this heading"></a></h5>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.PyTorchIgnitePruningHandler" title="optuna.integration.PyTorchIgnitePruningHandler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.PyTorchIgnitePruningHandler</span></code></a></p></td>
<td><p>PyTorch Ignite handler to prune unpromising trials.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.integration.PyTorchLightningPruningCallback" title="optuna.integration.PyTorchLightningPruningCallback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.PyTorchLightningPruningCallback</span></code></a></p></td>
<td><p>PyTorch Lightning callback to prune unpromising trials.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.TorchDistributedTrial" title="optuna.integration.TorchDistributedTrial"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.TorchDistributedTrial</span></code></a></p></td>
<td><p>A wrapper of <a class="reference internal" href="index.html#optuna.trial.Trial" title="optuna.trial.Trial"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trial</span></code></a> to incorporate Optuna with PyTorch distributed.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="scikit-learn">
<h5>scikit-learn<a class="headerlink" href="#scikit-learn" title="Permalink to this heading"></a></h5>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.OptunaSearchCV" title="optuna.integration.OptunaSearchCV"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.OptunaSearchCV</span></code></a></p></td>
<td><p>Hyperparameter search with cross-validation.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="scikit-optimize">
<h5>scikit-optimize<a class="headerlink" href="#scikit-optimize" title="Permalink to this heading"></a></h5>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.SkoptSampler" title="optuna.integration.SkoptSampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.SkoptSampler</span></code></a></p></td>
<td><p>Sampler using Scikit-Optimize as the backend.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="shap">
<h5>SHAP<a class="headerlink" href="#shap" title="Permalink to this heading"></a></h5>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.ShapleyImportanceEvaluator" title="optuna.integration.ShapleyImportanceEvaluator"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.ShapleyImportanceEvaluator</span></code></a></p></td>
<td><p>Shapley (SHAP) parameter importance evaluator.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="skorch">
<h5>skorch<a class="headerlink" href="#skorch" title="Permalink to this heading"></a></h5>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.SkorchPruningCallback" title="optuna.integration.SkorchPruningCallback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.SkorchPruningCallback</span></code></a></p></td>
<td><p>Skorch callback to prune unpromising trials.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="tensorflow">
<h5>TensorFlow<a class="headerlink" href="#tensorflow" title="Permalink to this heading"></a></h5>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.TensorBoardCallback" title="optuna.integration.TensorBoardCallback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.TensorBoardCallback</span></code></a></p></td>
<td><p>Callback to track Optuna trials with TensorBoard.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.integration.TensorFlowPruningHook" title="optuna.integration.TensorFlowPruningHook"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.TensorFlowPruningHook</span></code></a></p></td>
<td><p>TensorFlow SessionRunHook to prune unpromising trials.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.TFKerasPruningCallback" title="optuna.integration.TFKerasPruningCallback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.TFKerasPruningCallback</span></code></a></p></td>
<td><p>tf.keras callback to prune unpromising trials.</p></td>
</tr>
</tbody>
</table>
</section>
<section id="xgboost">
<h5>XGBoost<a class="headerlink" href="#xgboost" title="Permalink to this heading"></a></h5>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.integration.XGBoostPruningCallback" title="optuna.integration.XGBoostPruningCallback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.integration.XGBoostPruningCallback</span></code></a></p></td>
<td><p>Callback for XGBoost to prune unpromising trials.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<span id="document-reference/logging"></span><span class="target" id="module-optuna.logging"></span><section id="optuna-logging">
<h4>optuna.logging<a class="headerlink" href="#optuna-logging" title="Permalink to this heading"></a></h4>
<p>The <a class="reference internal" href="#module-optuna.logging" title="optuna.logging"><code class="xref py py-mod docutils literal notranslate"><span class="pre">logging</span></code></a> module implements logging using the Python <code class="docutils literal notranslate"><span class="pre">logging</span></code> package. Library users may be especially interested in setting verbosity levels using <a class="reference internal" href="index.html#optuna.logging.set_verbosity" title="optuna.logging.set_verbosity"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_verbosity()</span></code></a> to one of <code class="docutils literal notranslate"><span class="pre">optuna.logging.CRITICAL</span></code> (aka <code class="docutils literal notranslate"><span class="pre">optuna.logging.FATAL</span></code>), <code class="docutils literal notranslate"><span class="pre">optuna.logging.ERROR</span></code>, <code class="docutils literal notranslate"><span class="pre">optuna.logging.WARNING</span></code> (aka <code class="docutils literal notranslate"><span class="pre">optuna.logging.WARN</span></code>), <code class="docutils literal notranslate"><span class="pre">optuna.logging.INFO</span></code>, or <code class="docutils literal notranslate"><span class="pre">optuna.logging.DEBUG</span></code>.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.logging.get_verbosity" title="optuna.logging.get_verbosity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.logging.get_verbosity</span></code></a></p></td>
<td><p>Return the current level for the Optuna's root logger.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.logging.set_verbosity" title="optuna.logging.set_verbosity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.logging.set_verbosity</span></code></a></p></td>
<td><p>Set the level for the Optuna's root logger.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.logging.disable_default_handler" title="optuna.logging.disable_default_handler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.logging.disable_default_handler</span></code></a></p></td>
<td><p>Disable the default handler of the Optuna's root logger.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.logging.enable_default_handler" title="optuna.logging.enable_default_handler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.logging.enable_default_handler</span></code></a></p></td>
<td><p>Enable the default handler of the Optuna's root logger.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.logging.disable_propagation" title="optuna.logging.disable_propagation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.logging.disable_propagation</span></code></a></p></td>
<td><p>Disable propagation of the library log outputs.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.logging.enable_propagation" title="optuna.logging.enable_propagation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.logging.enable_propagation</span></code></a></p></td>
<td><p>Enable propagation of the library log outputs.</p></td>
</tr>
</tbody>
</table>
</section>
<span id="document-reference/pruners"></span><span class="target" id="module-optuna.pruners"></span><section id="optuna-pruners">
<h4>optuna.pruners<a class="headerlink" href="#optuna-pruners" title="Permalink to this heading"></a></h4>
<p>The <a class="reference internal" href="#module-optuna.pruners" title="optuna.pruners"><code class="xref py py-mod docutils literal notranslate"><span class="pre">pruners</span></code></a> module defines a <a class="reference internal" href="index.html#optuna.pruners.BasePruner" title="optuna.pruners.BasePruner"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePruner</span></code></a> class characterized by an abstract <a class="reference internal" href="index.html#optuna.pruners.BasePruner.prune" title="optuna.pruners.BasePruner.prune"><code class="xref py py-meth docutils literal notranslate"><span class="pre">prune()</span></code></a> method, which, for a given trial and its associated study, returns a boolean value representing whether the trial should be pruned. This determination is made based on stored intermediate values of the objective function, as previously reported for the trial using <a class="reference internal" href="index.html#optuna.trial.Trial.report" title="optuna.trial.Trial.report"><code class="xref py py-meth docutils literal notranslate"><span class="pre">optuna.trial.Trial.report()</span></code></a>. The remaining classes in this module represent child classes, inheriting from <a class="reference internal" href="index.html#optuna.pruners.BasePruner" title="optuna.pruners.BasePruner"><code class="xref py py-class docutils literal notranslate"><span class="pre">BasePruner</span></code></a>, which implement different pruning strategies.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="index.html#pruning"><span class="std std-ref">3. Efficient Optimization Algorithms</span></a> tutorial explains the concept of the pruner classes and a minimal example.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="index.html#user-defined-pruner"><span class="std std-ref">User-Defined Pruner</span></a> tutorial could be helpful if you want to implement your own pruner classes.</p>
</div>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.pruners.BasePruner" title="optuna.pruners.BasePruner"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.pruners.BasePruner</span></code></a></p></td>
<td><p>Base class for pruners.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.pruners.MedianPruner" title="optuna.pruners.MedianPruner"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.pruners.MedianPruner</span></code></a></p></td>
<td><p>Pruner using the median stopping rule.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.pruners.NopPruner" title="optuna.pruners.NopPruner"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.pruners.NopPruner</span></code></a></p></td>
<td><p>Pruner which never prunes trials.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.pruners.PatientPruner" title="optuna.pruners.PatientPruner"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.pruners.PatientPruner</span></code></a></p></td>
<td><p>Pruner which wraps another pruner with tolerance.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.pruners.PercentilePruner" title="optuna.pruners.PercentilePruner"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.pruners.PercentilePruner</span></code></a></p></td>
<td><p>Pruner to keep the specified percentile of the trials.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.pruners.SuccessiveHalvingPruner" title="optuna.pruners.SuccessiveHalvingPruner"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.pruners.SuccessiveHalvingPruner</span></code></a></p></td>
<td><p>Pruner using Asynchronous Successive Halving Algorithm.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.pruners.HyperbandPruner" title="optuna.pruners.HyperbandPruner"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.pruners.HyperbandPruner</span></code></a></p></td>
<td><p>Pruner using Hyperband.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.pruners.ThresholdPruner" title="optuna.pruners.ThresholdPruner"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.pruners.ThresholdPruner</span></code></a></p></td>
<td><p>Pruner to detect outlying metrics of the trials.</p></td>
</tr>
</tbody>
</table>
</section>
<span id="document-reference/samplers/index"></span><span class="target" id="module-optuna.samplers"></span><section id="optuna-samplers">
<h4>optuna.samplers<a class="headerlink" href="#optuna-samplers" title="Permalink to this heading"></a></h4>
<p>The <a class="reference internal" href="#module-optuna.samplers" title="optuna.samplers"><code class="xref py py-mod docutils literal notranslate"><span class="pre">samplers</span></code></a> module defines a base class for parameter sampling as described extensively in <a class="reference internal" href="index.html#optuna.samplers.BaseSampler" title="optuna.samplers.BaseSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSampler</span></code></a>. The remaining classes in this module represent child classes, deriving from <a class="reference internal" href="index.html#optuna.samplers.BaseSampler" title="optuna.samplers.BaseSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSampler</span></code></a>, which implement different sampling strategies.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="index.html#pruning"><span class="std std-ref">3. Efficient Optimization Algorithms</span></a> tutorial explains the overview of the sampler classes.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="index.html#user-defined-sampler"><span class="std std-ref">User-Defined Sampler</span></a> tutorial could be helpful if you want to implement your own sampler classes.</p>
</div>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>RandomSampler</p></th>
<th class="head"><p>GridSampler</p></th>
<th class="head"><p>TPESampler</p></th>
<th class="head"><p>CmaEsSampler</p></th>
<th class="head"><p>NSGAIISampler</p></th>
<th class="head"><p>QMCSampler</p></th>
<th class="head"><p>BoTorchSampler</p></th>
<th class="head"><p>BruteForceSampler</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Float parameters</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>▲</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>✅  (❌ for infinite domain)</p></td>
</tr>
<tr class="row-odd"><td><p>Integer parameters</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>▲</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-even"><td><p>Categorical parameters</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>▲</p></td>
<td><p>✅</p></td>
<td><p>▲</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-odd"><td><p>Pruning</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>▲</p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>▲</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-even"><td><p>Multivariate optimization</p></td>
<td><p>▲</p></td>
<td><p>▲</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>▲</p></td>
<td><p>▲</p></td>
<td><p>✅</p></td>
<td><p>▲</p></td>
</tr>
<tr class="row-odd"><td><p>Conditional search space</p></td>
<td><p>✅</p></td>
<td><p>▲</p></td>
<td><p>✅</p></td>
<td><p>▲</p></td>
<td><p>▲</p></td>
<td><p>▲</p></td>
<td><p>▲</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-even"><td><p>Multi-objective optimization</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>❌</p></td>
<td><p>✅ (▲ for single-objective)</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-odd"><td><p>Batch optimization</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>▲</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-even"><td><p>Distributed optimization</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>✅</p></td>
<td><p>▲</p></td>
<td><p>✅</p></td>
</tr>
<tr class="row-odd"><td><p>Constrained optimization</p></td>
<td><p>❌</p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>❌</p></td>
<td><p>✅</p></td>
<td><p>❌</p></td>
</tr>
<tr class="row-even"><td><p>Time complexity (per trial) (*)</p></td>
<td><p><span class="math notranslate nohighlight">\(O(d)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(O(dn)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(O(dn \log n)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(O(d^3)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(O(mp^2)\)</span> (***)</p></td>
<td><p><span class="math notranslate nohighlight">\(O(dn)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(O(n^3)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(O(d)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Recommended budgets (#trials)
(**)</p></td>
<td><p>as many as
one likes</p></td>
<td><p>number of
combinations</p></td>
<td><p>100 – 1000</p></td>
<td><p>1000 – 10000</p></td>
<td><p>100 – 10000</p></td>
<td><p>as many as
one likes</p></td>
<td><p>10 – 100</p></td>
<td><p>number of combinations</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>✅: Supports this feature.
▲ : Works, but inefficiently.
❌: Causes an error, or has no interface.</p>
<p>(*): We assumes that <span class="math notranslate nohighlight">\(d\)</span> is the dimension of the search space, <span class="math notranslate nohighlight">\(n\)</span> is the number of finished trials, <span class="math notranslate nohighlight">\(m\)</span> is the number of objectives, and <span class="math notranslate nohighlight">\(p\)</span> is the population size (algorithm specific parameter).
This table shows the time complexity of the sampling algorithms. We may omit other terms that depend on the implementation in Optuna, including <span class="math notranslate nohighlight">\(O(d)\)</span> to call the sampling methods and <span class="math notranslate nohighlight">\(O(n)\)</span> to collect the completed trials.
This means that, for example, the actual time complexity of <a class="reference internal" href="index.html#optuna.samplers.RandomSampler" title="optuna.samplers.RandomSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">RandomSampler</span></code></a> is <span class="math notranslate nohighlight">\(O(d+n+d) = O(d+n)\)</span>.
From another perspective, with the exception of <a class="reference internal" href="index.html#optuna.samplers.NSGAIISampler" title="optuna.samplers.NSGAIISampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">NSGAIISampler</span></code></a>, all time complexity is written for single-objective optimization.</p>
<p>(**): The budget depends on the number of parameters and the number of objectives.</p>
<p>(***): This time complexity assumes that the number of population size <span class="math notranslate nohighlight">\(p\)</span> and the number of parallelization are regular.
This means that the number of parallelization should not exceed the number of population size <span class="math notranslate nohighlight">\(p\)</span>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For float, integer, or categorical parameters, see <a class="reference internal" href="index.html#configurations"><span class="std std-ref">2. Pythonic Search Space</span></a> tutorial.</p>
<p>For pruning, see <a class="reference internal" href="index.html#pruning"><span class="std std-ref">3. Efficient Optimization Algorithms</span></a> tutorial.</p>
<p>For multivariate optimization, see <a class="reference internal" href="index.html#optuna.samplers.BaseSampler" title="optuna.samplers.BaseSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseSampler</span></code></a>. The multivariate optimization is implemented as <a class="reference internal" href="index.html#optuna.samplers.BaseSampler.sample_relative" title="optuna.samplers.BaseSampler.sample_relative"><code class="xref py py-func docutils literal notranslate"><span class="pre">sample_relative()</span></code></a> in Optuna. Please check the concrete documents of samplers for more details.</p>
<p>For conditional search space, see <a class="reference internal" href="index.html#configurations"><span class="std std-ref">2. Pythonic Search Space</span></a> tutorial and <a class="reference internal" href="index.html#optuna.samplers.TPESampler" title="optuna.samplers.TPESampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">TPESampler</span></code></a>. The <code class="docutils literal notranslate"><span class="pre">group</span></code> option of <a class="reference internal" href="index.html#optuna.samplers.TPESampler" title="optuna.samplers.TPESampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">TPESampler</span></code></a> allows <a class="reference internal" href="index.html#optuna.samplers.TPESampler" title="optuna.samplers.TPESampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">TPESampler</span></code></a> to handle the conditional search space.</p>
<p>For multi-objective optimization, see <a class="reference internal" href="index.html#multi-objective"><span class="std std-ref">Multi-objective Optimization with Optuna</span></a> tutorial.</p>
<p>For batch optimization, see <a class="reference internal" href="index.html#batch-optimization"><span class="std std-ref">Batch Optimization</span></a> tutorial. Note that the <code class="docutils literal notranslate"><span class="pre">constant_liar</span></code> option of <a class="reference internal" href="index.html#optuna.samplers.TPESampler" title="optuna.samplers.TPESampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">TPESampler</span></code></a> allows <a class="reference internal" href="index.html#optuna.samplers.TPESampler" title="optuna.samplers.TPESampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">TPESampler</span></code></a> to handle the batch optimization.</p>
<p>For distributed optimization, see <a class="reference internal" href="index.html#distributed"><span class="std std-ref">4. Easy Parallelization</span></a> tutorial. Note that the <code class="docutils literal notranslate"><span class="pre">constant_liar</span></code> option of <a class="reference internal" href="index.html#optuna.samplers.TPESampler" title="optuna.samplers.TPESampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">TPESampler</span></code></a> allows <a class="reference internal" href="index.html#optuna.samplers.TPESampler" title="optuna.samplers.TPESampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">TPESampler</span></code></a> to handle the distributed optimization.</p>
<p>For constrained optimization, see an <a class="reference external" href="https://github.com/optuna/optuna-examples/blob/main/multi_objective/botorch_simple.py">example</a>.</p>
</div>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.samplers.BaseSampler" title="optuna.samplers.BaseSampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.samplers.BaseSampler</span></code></a></p></td>
<td><p>Base class for samplers.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.samplers.GridSampler" title="optuna.samplers.GridSampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.samplers.GridSampler</span></code></a></p></td>
<td><p>Sampler using grid search.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.samplers.RandomSampler" title="optuna.samplers.RandomSampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.samplers.RandomSampler</span></code></a></p></td>
<td><p>Sampler using random sampling.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.samplers.TPESampler" title="optuna.samplers.TPESampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.samplers.TPESampler</span></code></a></p></td>
<td><p>Sampler using TPE (Tree-structured Parzen Estimator) algorithm.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.samplers.CmaEsSampler" title="optuna.samplers.CmaEsSampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.samplers.CmaEsSampler</span></code></a></p></td>
<td><p>A sampler using <a class="reference external" href="https://github.com/CyberAgentAILab/cmaes">cmaes</a> as the backend.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.samplers.PartialFixedSampler" title="optuna.samplers.PartialFixedSampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.samplers.PartialFixedSampler</span></code></a></p></td>
<td><p>Sampler with partially fixed parameters.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.samplers.NSGAIISampler" title="optuna.samplers.NSGAIISampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.samplers.NSGAIISampler</span></code></a></p></td>
<td><p>Multi-objective sampler using the NSGA-II algorithm.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.samplers.MOTPESampler" title="optuna.samplers.MOTPESampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.samplers.MOTPESampler</span></code></a></p></td>
<td><p>Multi-objective sampler using the MOTPE algorithm.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.samplers.QMCSampler" title="optuna.samplers.QMCSampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.samplers.QMCSampler</span></code></a></p></td>
<td><p>A Quasi Monte Carlo Sampler that generates low-discrepancy sequences.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.samplers.BruteForceSampler" title="optuna.samplers.BruteForceSampler"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.samplers.BruteForceSampler</span></code></a></p></td>
<td><p>Sampler using brute force.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.samplers.IntersectionSearchSpace" title="optuna.samplers.IntersectionSearchSpace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.samplers.IntersectionSearchSpace</span></code></a></p></td>
<td><p>A class to calculate the intersection search space of a <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.samplers.intersection_search_space" title="optuna.samplers.intersection_search_space"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.samplers.intersection_search_space</span></code></a></p></td>
<td><p>Return the intersection search space of the <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a>.</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following <a class="reference internal" href="index.html#module-optuna.samplers.nsgaii" title="optuna.samplers.nsgaii"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optuna.samplers.nsgaii</span></code></a> module defines crossover operations used by <a class="reference internal" href="index.html#optuna.samplers.NSGAIISampler" title="optuna.samplers.NSGAIISampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">NSGAIISampler</span></code></a>.</p>
</div>
<div class="toctree-wrapper compound">
<span id="document-reference/samplers/nsgaii"></span><span class="target" id="module-optuna.samplers.nsgaii"></span><section id="optuna-samplers-nsgaii">
<h5>optuna.samplers.nsgaii<a class="headerlink" href="#optuna-samplers-nsgaii" title="Permalink to this heading"></a></h5>
<p>The <a class="reference internal" href="#module-optuna.samplers.nsgaii" title="optuna.samplers.nsgaii"><code class="xref py py-mod docutils literal notranslate"><span class="pre">nsgaii</span></code></a> module defines crossover operations used by <a class="reference internal" href="index.html#optuna.samplers.NSGAIISampler" title="optuna.samplers.NSGAIISampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">NSGAIISampler</span></code></a>.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.samplers.nsgaii.BaseCrossover" title="optuna.samplers.nsgaii.BaseCrossover"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.samplers.nsgaii.BaseCrossover</span></code></a></p></td>
<td><p>Base class for crossovers.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.samplers.nsgaii.UniformCrossover" title="optuna.samplers.nsgaii.UniformCrossover"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.samplers.nsgaii.UniformCrossover</span></code></a></p></td>
<td><p>Uniform Crossover operation used by <a class="reference internal" href="index.html#optuna.samplers.NSGAIISampler" title="optuna.samplers.NSGAIISampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">NSGAIISampler</span></code></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.samplers.nsgaii.BLXAlphaCrossover" title="optuna.samplers.nsgaii.BLXAlphaCrossover"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.samplers.nsgaii.BLXAlphaCrossover</span></code></a></p></td>
<td><p>Blend Crossover operation used by <a class="reference internal" href="index.html#optuna.samplers.NSGAIISampler" title="optuna.samplers.NSGAIISampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">NSGAIISampler</span></code></a>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.samplers.nsgaii.SPXCrossover" title="optuna.samplers.nsgaii.SPXCrossover"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.samplers.nsgaii.SPXCrossover</span></code></a></p></td>
<td><p>Simplex Crossover operation used by <a class="reference internal" href="index.html#optuna.samplers.NSGAIISampler" title="optuna.samplers.NSGAIISampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">NSGAIISampler</span></code></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.samplers.nsgaii.SBXCrossover" title="optuna.samplers.nsgaii.SBXCrossover"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.samplers.nsgaii.SBXCrossover</span></code></a></p></td>
<td><p>Simulated Binary Crossover operation used by <a class="reference internal" href="index.html#optuna.samplers.NSGAIISampler" title="optuna.samplers.NSGAIISampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">NSGAIISampler</span></code></a>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.samplers.nsgaii.VSBXCrossover" title="optuna.samplers.nsgaii.VSBXCrossover"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.samplers.nsgaii.VSBXCrossover</span></code></a></p></td>
<td><p>Modified Simulated Binary Crossover operation used by <a class="reference internal" href="index.html#optuna.samplers.NSGAIISampler" title="optuna.samplers.NSGAIISampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">NSGAIISampler</span></code></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.samplers.nsgaii.UNDXCrossover" title="optuna.samplers.nsgaii.UNDXCrossover"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.samplers.nsgaii.UNDXCrossover</span></code></a></p></td>
<td><p>Unimodal Normal Distribution Crossover used by <a class="reference internal" href="index.html#optuna.samplers.NSGAIISampler" title="optuna.samplers.NSGAIISampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">NSGAIISampler</span></code></a>.</p></td>
</tr>
</tbody>
</table>
</section>
</div>
</section>
<span id="document-reference/search_space"></span><span class="target" id="module-optuna.search_space"></span><section id="optuna-search-space">
<h4>optuna.search_space<a class="headerlink" href="#optuna-search-space" title="Permalink to this heading"></a></h4>
<p>The <a class="reference internal" href="#module-optuna.search_space" title="optuna.search_space"><code class="xref py py-mod docutils literal notranslate"><span class="pre">search_space</span></code></a> module provides functionality for controlling search space of parameters.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.search_space.IntersectionSearchSpace" title="optuna.search_space.IntersectionSearchSpace"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.search_space.IntersectionSearchSpace</span></code></a></p></td>
<td><p>A class to calculate the intersection search space of a <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.search_space.intersection_search_space" title="optuna.search_space.intersection_search_space"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.search_space.intersection_search_space</span></code></a></p></td>
<td><p>Return the intersection search space of the <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a>.</p></td>
</tr>
</tbody>
</table>
</section>
<span id="document-reference/storages"></span><span class="target" id="module-optuna.storages"></span><section id="optuna-storages">
<h4>optuna.storages<a class="headerlink" href="#optuna-storages" title="Permalink to this heading"></a></h4>
<p>The <a class="reference internal" href="#module-optuna.storages" title="optuna.storages"><code class="xref py py-mod docutils literal notranslate"><span class="pre">storages</span></code></a> module defines a <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseStorage</span></code> class which abstracts a backend database and provides library-internal interfaces to the read/write histories of the studies and trials. Library users who wish to use storage solutions other than the default in-memory storage should use one of the child classes of <code class="xref py py-class docutils literal notranslate"><span class="pre">BaseStorage</span></code> documented below.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.storages.RDBStorage" title="optuna.storages.RDBStorage"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.storages.RDBStorage</span></code></a></p></td>
<td><p>Storage class for RDB backend.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.storages.RetryFailedTrialCallback" title="optuna.storages.RetryFailedTrialCallback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.storages.RetryFailedTrialCallback</span></code></a></p></td>
<td><p>Retry a failed trial up to a maximum number of times.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.storages.fail_stale_trials" title="optuna.storages.fail_stale_trials"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.storages.fail_stale_trials</span></code></a></p></td>
<td><p>Fail stale trials and run their failure callbacks.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.storages.JournalStorage" title="optuna.storages.JournalStorage"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.storages.JournalStorage</span></code></a></p></td>
<td><p>Storage class for Journal storage backend.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.storages.JournalFileStorage" title="optuna.storages.JournalFileStorage"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.storages.JournalFileStorage</span></code></a></p></td>
<td><p>File storage class for Journal log backend.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.storages.JournalFileSymlinkLock" title="optuna.storages.JournalFileSymlinkLock"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.storages.JournalFileSymlinkLock</span></code></a></p></td>
<td><p>Lock class for synchronizing processes for NFSv2 or later.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.storages.JournalFileOpenLock" title="optuna.storages.JournalFileOpenLock"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.storages.JournalFileOpenLock</span></code></a></p></td>
<td><p>Lock class for synchronizing processes for NFSv3 or later.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.storages.JournalRedisStorage" title="optuna.storages.JournalRedisStorage"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.storages.JournalRedisStorage</span></code></a></p></td>
<td><p>Redis storage class for Journal log backend.</p></td>
</tr>
</tbody>
</table>
</section>
<span id="document-reference/study"></span><span class="target" id="module-optuna.study"></span><section id="optuna-study">
<h4>optuna.study<a class="headerlink" href="#optuna-study" title="Permalink to this heading"></a></h4>
<p>The <a class="reference internal" href="#module-optuna.study" title="optuna.study"><code class="xref py py-mod docutils literal notranslate"><span class="pre">study</span></code></a> module implements the <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a> object and related functions. A public constructor is available for the <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a> class, but direct use of this constructor is not recommended. Instead, library users should create and load a <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a> using <a class="reference internal" href="index.html#optuna.study.create_study" title="optuna.study.create_study"><code class="xref py py-func docutils literal notranslate"><span class="pre">create_study()</span></code></a> and <a class="reference internal" href="index.html#optuna.study.load_study" title="optuna.study.load_study"><code class="xref py py-func docutils literal notranslate"><span class="pre">load_study()</span></code></a> respectively.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.study.Study</span></code></a></p></td>
<td><p>A study corresponds to an optimization task, i.e., a set of trials.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.study.create_study" title="optuna.study.create_study"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.study.create_study</span></code></a></p></td>
<td><p>Create a new <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.study.load_study" title="optuna.study.load_study"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.study.load_study</span></code></a></p></td>
<td><p>Load the existing <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a> that has the specified name.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.study.delete_study" title="optuna.study.delete_study"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.study.delete_study</span></code></a></p></td>
<td><p>Delete a <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a> object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.study.copy_study" title="optuna.study.copy_study"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.study.copy_study</span></code></a></p></td>
<td><p>Copy study from one storage to another.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.study.get_all_study_summaries" title="optuna.study.get_all_study_summaries"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.study.get_all_study_summaries</span></code></a></p></td>
<td><p>Get all history of studies stored in a specified storage.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.study.MaxTrialsCallback" title="optuna.study.MaxTrialsCallback"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.study.MaxTrialsCallback</span></code></a></p></td>
<td><p>Set a maximum number of trials before ending the study.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.study.StudyDirection" title="optuna.study.StudyDirection"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.study.StudyDirection</span></code></a></p></td>
<td><p>Direction of a <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.study.StudySummary" title="optuna.study.StudySummary"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.study.StudySummary</span></code></a></p></td>
<td><p>Basic attributes and aggregated results of a <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a>.</p></td>
</tr>
</tbody>
</table>
</section>
<span id="document-reference/trial"></span><span class="target" id="module-optuna.trial"></span><section id="optuna-trial">
<h4>optuna.trial<a class="headerlink" href="#optuna-trial" title="Permalink to this heading"></a></h4>
<p>The <a class="reference internal" href="#module-optuna.trial" title="optuna.trial"><code class="xref py py-mod docutils literal notranslate"><span class="pre">trial</span></code></a> module contains <a class="reference internal" href="index.html#optuna.trial.Trial" title="optuna.trial.Trial"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trial</span></code></a> related classes and functions.</p>
<p>A <a class="reference internal" href="index.html#optuna.trial.Trial" title="optuna.trial.Trial"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trial</span></code></a> instance represents a process of evaluating an objective function. This instance is passed to an objective function and provides interfaces to get parameter suggestion, manage the trial’s state, and set/get user-defined attributes of the trial, so that Optuna users can define a custom objective function through the interfaces. Basically, Optuna users only use it in their custom objective functions.</p>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.trial.Trial" title="optuna.trial.Trial"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.trial.Trial</span></code></a></p></td>
<td><p>A trial is a process of evaluating an objective function.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.trial.FixedTrial" title="optuna.trial.FixedTrial"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.trial.FixedTrial</span></code></a></p></td>
<td><p>A trial class which suggests a fixed value for each parameter.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.trial.FrozenTrial" title="optuna.trial.FrozenTrial"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.trial.FrozenTrial</span></code></a></p></td>
<td><p>Status and results of a <a class="reference internal" href="index.html#optuna.trial.Trial" title="optuna.trial.Trial"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trial</span></code></a>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.trial.TrialState" title="optuna.trial.TrialState"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.trial.TrialState</span></code></a></p></td>
<td><p>State of a <a class="reference internal" href="index.html#optuna.trial.Trial" title="optuna.trial.Trial"><code class="xref py py-class docutils literal notranslate"><span class="pre">Trial</span></code></a>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.trial.create_trial" title="optuna.trial.create_trial"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.trial.create_trial</span></code></a></p></td>
<td><p>Create a new <a class="reference internal" href="index.html#optuna.trial.FrozenTrial" title="optuna.trial.FrozenTrial"><code class="xref py py-class docutils literal notranslate"><span class="pre">FrozenTrial</span></code></a>.</p></td>
</tr>
</tbody>
</table>
</section>
<span id="document-reference/visualization/index"></span><span class="target" id="module-optuna.visualization"></span><section id="optuna-visualization">
<h4>optuna.visualization<a class="headerlink" href="#optuna-visualization" title="Permalink to this heading"></a></h4>
<p>The <a class="reference internal" href="#module-optuna.visualization" title="optuna.visualization"><code class="xref py py-mod docutils literal notranslate"><span class="pre">visualization</span></code></a> module provides utility functions for plotting the optimization process using plotly and matplotlib. Plotting functions generally take a <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a> object and optional parameters are passed as a list to the <code class="docutils literal notranslate"><span class="pre">params</span></code> argument.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In the <a class="reference internal" href="#module-optuna.visualization" title="optuna.visualization"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optuna.visualization</span></code></a> module, the following functions use plotly to create figures, but <a class="reference external" href="https://github.com/jupyterlab/jupyterlab">JupyterLab</a> cannot
render them by default. Please follow this <a class="reference external" href="https://github.com/plotly/plotly.py#jupyterlab-support">installation guide</a> to show figures in
<a class="reference external" href="https://github.com/jupyterlab/jupyterlab">JupyterLab</a>.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="index.html#optuna.visualization.plot_param_importances" title="optuna.visualization.plot_param_importances"><code class="xref py py-func docutils literal notranslate"><span class="pre">plot_param_importances()</span></code></a> requires the Python package of <a class="reference external" href="https://github.com/scikit-learn/scikit-learn">scikit-learn</a>.</p>
</div>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.visualization.plot_contour" title="optuna.visualization.plot_contour"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.visualization.plot_contour</span></code></a></p></td>
<td><p>Plot the parameter relationship as contour plot in a study.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.visualization.plot_edf" title="optuna.visualization.plot_edf"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.visualization.plot_edf</span></code></a></p></td>
<td><p>Plot the objective value EDF (empirical distribution function) of a study.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.visualization.plot_intermediate_values" title="optuna.visualization.plot_intermediate_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.visualization.plot_intermediate_values</span></code></a></p></td>
<td><p>Plot intermediate values of all trials in a study.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.visualization.plot_optimization_history" title="optuna.visualization.plot_optimization_history"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.visualization.plot_optimization_history</span></code></a></p></td>
<td><p>Plot optimization history of all trials in a study.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.visualization.plot_parallel_coordinate" title="optuna.visualization.plot_parallel_coordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.visualization.plot_parallel_coordinate</span></code></a></p></td>
<td><p>Plot the high-dimensional parameter relationships in a study.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.visualization.plot_param_importances" title="optuna.visualization.plot_param_importances"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.visualization.plot_param_importances</span></code></a></p></td>
<td><p>Plot hyperparameter importances.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.visualization.plot_pareto_front" title="optuna.visualization.plot_pareto_front"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.visualization.plot_pareto_front</span></code></a></p></td>
<td><p>Plot the Pareto front of a study.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.visualization.plot_slice" title="optuna.visualization.plot_slice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.visualization.plot_slice</span></code></a></p></td>
<td><p>Plot the parameter relationship as slice plot in a study.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.visualization.is_available" title="optuna.visualization.is_available"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.visualization.is_available</span></code></a></p></td>
<td><p>Returns whether visualization with plotly is available or not.</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following <a class="reference internal" href="index.html#module-optuna.visualization.matplotlib" title="optuna.visualization.matplotlib"><code class="xref py py-mod docutils literal notranslate"><span class="pre">optuna.visualization.matplotlib</span></code></a> module uses Matplotlib as a backend.</p>
</div>
<div class="toctree-wrapper compound">
<span id="document-reference/visualization/matplotlib"></span><span class="target" id="module-optuna.visualization.matplotlib"></span><section id="optuna-visualization-matplotlib">
<h5>optuna.visualization.matplotlib<a class="headerlink" href="#optuna-visualization-matplotlib" title="Permalink to this heading"></a></h5>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following functions use Matplotlib as a backend.</p>
</div>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.visualization.matplotlib.plot_contour" title="optuna.visualization.matplotlib.plot_contour"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.visualization.matplotlib.plot_contour</span></code></a></p></td>
<td><p>Plot the parameter relationship as contour plot in a study with Matplotlib.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.visualization.matplotlib.plot_edf" title="optuna.visualization.matplotlib.plot_edf"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.visualization.matplotlib.plot_edf</span></code></a></p></td>
<td><p>Plot the objective value EDF (empirical distribution function) of a study with Matplotlib.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.visualization.matplotlib.plot_intermediate_values" title="optuna.visualization.matplotlib.plot_intermediate_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.visualization.matplotlib.plot_intermediate_values</span></code></a></p></td>
<td><p>Plot intermediate values of all trials in a study with Matplotlib.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.visualization.matplotlib.plot_optimization_history" title="optuna.visualization.matplotlib.plot_optimization_history"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.visualization.matplotlib.plot_optimization_history</span></code></a></p></td>
<td><p>Plot optimization history of all trials in a study with Matplotlib.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.visualization.matplotlib.plot_parallel_coordinate" title="optuna.visualization.matplotlib.plot_parallel_coordinate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.visualization.matplotlib.plot_parallel_coordinate</span></code></a></p></td>
<td><p>Plot the high-dimensional parameter relationships in a study with Matplotlib.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.visualization.matplotlib.plot_param_importances" title="optuna.visualization.matplotlib.plot_param_importances"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.visualization.matplotlib.plot_param_importances</span></code></a></p></td>
<td><p>Plot hyperparameter importances with Matplotlib.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.visualization.matplotlib.plot_pareto_front" title="optuna.visualization.matplotlib.plot_pareto_front"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.visualization.matplotlib.plot_pareto_front</span></code></a></p></td>
<td><p>Plot the Pareto front of a study.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="index.html#optuna.visualization.matplotlib.plot_slice" title="optuna.visualization.matplotlib.plot_slice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.visualization.matplotlib.plot_slice</span></code></a></p></td>
<td><p>Plot the parameter relationship as slice plot in a study with Matplotlib.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="index.html#optuna.visualization.matplotlib.is_available" title="optuna.visualization.matplotlib.is_available"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.visualization.matplotlib.is_available</span></code></a></p></td>
<td><p>Returns whether visualization with Matplotlib is available or not.</p></td>
</tr>
</tbody>
</table>
</section>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>The <a class="reference internal" href="index.html#visualization"><span class="std std-ref">5. Quick Visualization for Hyperparameter Optimization Analysis</span></a> tutorial provides use-cases with examples.</p>
</div>
</section>
</div>
</section>
<span id="document-faq"></span><section id="faq">
<h3>FAQ<a class="headerlink" href="#faq" title="Permalink to this heading"></a></h3>
<nav class="contents local" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#can-i-use-optuna-with-x-where-x-is-your-favorite-ml-library" id="id1">Can I use Optuna with X? (where X is your favorite ML library)</a></p></li>
<li><p><a class="reference internal" href="#how-to-define-objective-functions-that-have-own-arguments" id="id2">How to define objective functions that have own arguments?</a></p></li>
<li><p><a class="reference internal" href="#can-i-use-optuna-without-remote-rdb-servers" id="id3">Can I use Optuna without remote RDB servers?</a></p></li>
<li><p><a class="reference internal" href="#how-can-i-save-and-resume-studies" id="id4">How can I save and resume studies?</a></p></li>
<li><p><a class="reference internal" href="#how-to-suppress-log-messages-of-optuna" id="id5">How to suppress log messages of Optuna?</a></p></li>
<li><p><a class="reference internal" href="#how-to-save-machine-learning-models-trained-in-objective-functions" id="id6">How to save machine learning models trained in objective functions?</a></p></li>
<li><p><a class="reference internal" href="#how-can-i-obtain-reproducible-optimization-results" id="id7">How can I obtain reproducible optimization results?</a></p></li>
<li><p><a class="reference internal" href="#how-are-exceptions-from-trials-handled" id="id8">How are exceptions from trials handled?</a></p></li>
<li><p><a class="reference internal" href="#how-are-nans-returned-by-trials-handled" id="id9">How are NaNs returned by trials handled?</a></p></li>
<li><p><a class="reference internal" href="#what-happens-when-i-dynamically-alter-a-search-space" id="id10">What happens when I dynamically alter a search space?</a></p></li>
<li><p><a class="reference internal" href="#how-can-i-use-two-gpus-for-evaluating-two-trials-simultaneously" id="id11">How can I use two GPUs for evaluating two trials simultaneously?</a></p></li>
<li><p><a class="reference internal" href="#how-can-i-test-my-objective-functions" id="id12">How can I test my objective functions?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-avoid-running-out-of-memory-oom-when-optimizing-studies" id="id13">How do I avoid running out of memory (OOM) when optimizing studies?</a></p></li>
<li><p><a class="reference internal" href="#how-can-i-output-a-log-only-when-the-best-value-is-updated" id="id14">How can I output a log only when the best value is updated?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-suggest-variables-which-represent-the-proportion-that-is-are-in-accordance-with-dirichlet-distribution" id="id15">How do I suggest variables which represent the proportion, that is, are in accordance with Dirichlet distribution?</a></p></li>
<li><p><a class="reference internal" href="#how-can-i-optimize-a-model-with-some-constraints" id="id16">How can I optimize a model with some constraints?</a></p></li>
<li><p><a class="reference internal" href="#how-can-i-parallelize-optimization" id="id17">How can I parallelize optimization?</a></p>
<ul>
<li><p><a class="reference internal" href="#multi-threading-parallelization-with-a-single-node" id="id18">1. Multi-threading parallelization with a single node</a></p></li>
<li><p><a class="reference internal" href="#multi-processing-parallelization-with-single-node" id="id19">2. Multi-processing parallelization with single node</a></p></li>
<li><p><a class="reference internal" href="#multi-processing-parallelization-with-multiple-nodes" id="id20">3. Multi-processing parallelization with multiple nodes</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#how-can-i-solve-the-error-that-occurs-when-performing-parallel-optimization-with-sqlite3" id="id21">How can I solve the error that occurs when performing parallel optimization with SQLite3?</a></p></li>
<li><p><a class="reference internal" href="#can-i-monitor-trials-and-make-them-failed-automatically-when-they-are-killed-unexpectedly" id="id22">Can I monitor trials and make them failed automatically when they are killed unexpectedly?</a></p></li>
</ul>
</nav>
<section id="can-i-use-optuna-with-x-where-x-is-your-favorite-ml-library">
<h4><a class="toc-backref" href="#id1" role="doc-backlink">Can I use Optuna with X? (where X is your favorite ML library)</a><a class="headerlink" href="#can-i-use-optuna-with-x-where-x-is-your-favorite-ml-library" title="Permalink to this heading"></a></h4>
<p>Optuna is compatible with most ML libraries, and it’s easy to use Optuna with those.
Please refer to <a class="reference external" href="https://github.com/optuna/optuna-examples/">examples</a>.</p>
</section>
<section id="how-to-define-objective-functions-that-have-own-arguments">
<span id="objective-func-additional-args"></span><h4><a class="toc-backref" href="#id2" role="doc-backlink">How to define objective functions that have own arguments?</a><a class="headerlink" href="#how-to-define-objective-functions-that-have-own-arguments" title="Permalink to this heading"></a></h4>
<p>There are two ways to realize it.</p>
<p>First, callable classes can be used for that purpose as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">optuna</span>


<span class="k">class</span> <span class="nc">Objective</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">min_x</span><span class="p">,</span> <span class="n">max_x</span><span class="p">):</span>
        <span class="c1"># Hold this implementation specific arguments as the fields of the class.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min_x</span> <span class="o">=</span> <span class="n">min_x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_x</span> <span class="o">=</span> <span class="n">max_x</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">trial</span><span class="p">):</span>
        <span class="c1"># Calculate an objective value by using the extra arguments.</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">min_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_x</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>


<span class="c1"># Execute an optimization by using an `Objective` instance.</span>
<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">()</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">Objective</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">),</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p>Second, you can use <code class="docutils literal notranslate"><span class="pre">lambda</span></code> or <code class="docutils literal notranslate"><span class="pre">functools.partial</span></code> for creating functions (closures) that hold extra arguments.
Below is an example that uses <code class="docutils literal notranslate"><span class="pre">lambda</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">optuna</span>

<span class="c1"># Objective function that takes three arguments.</span>
<span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">,</span> <span class="n">min_x</span><span class="p">,</span> <span class="n">max_x</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">min_x</span><span class="p">,</span> <span class="n">max_x</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>


<span class="c1"># Extra arguments.</span>
<span class="n">min_x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">100</span>
<span class="n">max_x</span> <span class="o">=</span> <span class="mi">100</span>

<span class="c1"># Execute an optimization by using the above objective function wrapped by `lambda`.</span>
<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">()</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="k">lambda</span> <span class="n">trial</span><span class="p">:</span> <span class="n">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">,</span> <span class="n">min_x</span><span class="p">,</span> <span class="n">max_x</span><span class="p">),</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<p>Please also refer to <a class="reference external" href="https://github.com/optuna/optuna-examples/tree/main/sklearn/sklearn_additional_args.py">sklearn_addtitional_args.py</a> example,
which reuses the dataset instead of loading it in each trial execution.</p>
</section>
<section id="can-i-use-optuna-without-remote-rdb-servers">
<h4><a class="toc-backref" href="#id3" role="doc-backlink">Can I use Optuna without remote RDB servers?</a><a class="headerlink" href="#can-i-use-optuna-without-remote-rdb-servers" title="Permalink to this heading"></a></h4>
<p>Yes, it’s possible.</p>
<p>In the simplest form, Optuna works with in-memory storage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">()</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">)</span>
</pre></div>
</div>
<p>If you want to save and resume studies,  it’s handy to use SQLite as the local storage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">study_name</span><span class="o">=</span><span class="s2">&quot;foo_study&quot;</span><span class="p">,</span> <span class="n">storage</span><span class="o">=</span><span class="s2">&quot;sqlite:///example.db&quot;</span><span class="p">)</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">)</span>  <span class="c1"># The state of `study` will be persisted to the local SQLite file.</span>
</pre></div>
</div>
<p>Please see <a class="reference internal" href="index.html#rdb"><span class="std std-ref">Saving/Resuming Study with RDB Backend</span></a> for more details.</p>
</section>
<section id="how-can-i-save-and-resume-studies">
<h4><a class="toc-backref" href="#id4" role="doc-backlink">How can I save and resume studies?</a><a class="headerlink" href="#how-can-i-save-and-resume-studies" title="Permalink to this heading"></a></h4>
<p>There are two ways of persisting studies, which depend if you are using
in-memory storage (default) or remote databases (RDB). In-memory studies can be
saved and loaded like usual Python objects using <code class="docutils literal notranslate"><span class="pre">pickle</span></code> or <code class="docutils literal notranslate"><span class="pre">joblib</span></code>. For
example, using <code class="docutils literal notranslate"><span class="pre">joblib</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">()</span>
<span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">study</span><span class="p">,</span> <span class="s2">&quot;study.pkl&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>And to resume the study:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">study</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;study.pkl&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best trial until now:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Value: &quot;</span><span class="p">,</span> <span class="n">study</span><span class="o">.</span><span class="n">best_trial</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Params: &quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">study</span><span class="o">.</span><span class="n">best_trial</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;    </span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that Optuna does not support saving/reloading across different Optuna
versions with <code class="docutils literal notranslate"><span class="pre">pickle</span></code>. To save/reload a study across different Optuna versions,
please use RDBs and <a class="reference external" href="reference/cli.html#storage-upgrade">upgrade storage schema</a>
if necessary. If you are using RDBs, see <a class="reference internal" href="index.html#rdb"><span class="std std-ref">Saving/Resuming Study with RDB Backend</span></a> for more details.</p>
</section>
<section id="how-to-suppress-log-messages-of-optuna">
<h4><a class="toc-backref" href="#id5" role="doc-backlink">How to suppress log messages of Optuna?</a><a class="headerlink" href="#how-to-suppress-log-messages-of-optuna" title="Permalink to this heading"></a></h4>
<p>By default, Optuna shows log messages at the <code class="docutils literal notranslate"><span class="pre">optuna.logging.INFO</span></code> level.
You can change logging levels by using  <a class="reference internal" href="index.html#optuna.logging.set_verbosity" title="optuna.logging.set_verbosity"><code class="xref py py-func docutils literal notranslate"><span class="pre">optuna.logging.set_verbosity()</span></code></a>.</p>
<p>For instance, you can stop showing each trial result as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">optuna</span><span class="o">.</span><span class="n">logging</span><span class="o">.</span><span class="n">set_verbosity</span><span class="p">(</span><span class="n">optuna</span><span class="o">.</span><span class="n">logging</span><span class="o">.</span><span class="n">WARNING</span><span class="p">)</span>

<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">()</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">)</span>
<span class="c1"># Logs like &#39;[I 2020-07-21 13:41:45,627] Trial 0 finished with value:...&#39; are disabled.</span>
</pre></div>
</div>
<p>Please refer to <a class="reference internal" href="index.html#module-optuna.logging" title="optuna.logging"><code class="xref py py-class docutils literal notranslate"><span class="pre">optuna.logging</span></code></a> for further details.</p>
</section>
<section id="how-to-save-machine-learning-models-trained-in-objective-functions">
<h4><a class="toc-backref" href="#id6" role="doc-backlink">How to save machine learning models trained in objective functions?</a><a class="headerlink" href="#how-to-save-machine-learning-models-trained-in-objective-functions" title="Permalink to this heading"></a></h4>
<p>Optuna saves hyperparameter values with its corresponding objective value to storage,
but it discards intermediate objects such as machine learning models and neural network weights.
To save models or weights, please use features of the machine learning library you used.</p>
<p>We recommend saving <a class="reference internal" href="index.html#optuna.trial.Trial.number" title="optuna.trial.Trial.number"><code class="xref py py-obj docutils literal notranslate"><span class="pre">optuna.trial.Trial.number</span></code></a> with a model in order to identify its corresponding trial.
For example, you can save SVM models trained in the objective function as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="n">svc_c</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;svc_c&quot;</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="mf">1e10</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">clf</span> <span class="o">=</span> <span class="n">sklearn</span><span class="o">.</span><span class="n">svm</span><span class="o">.</span><span class="n">SVC</span><span class="p">(</span><span class="n">C</span><span class="o">=</span><span class="n">svc_c</span><span class="p">)</span>
    <span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

    <span class="c1"># Save a trained model to a file.</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.pickle&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">trial</span><span class="o">.</span><span class="n">number</span><span class="p">),</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fout</span><span class="p">:</span>
        <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">fout</span><span class="p">)</span>
    <span class="k">return</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_valid</span><span class="p">))</span>


<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">()</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Load the best model.</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">.pickle&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">study</span><span class="o">.</span><span class="n">best_trial</span><span class="o">.</span><span class="n">number</span><span class="p">),</span> <span class="s2">&quot;rb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fin</span><span class="p">:</span>
    <span class="n">best_clf</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">fin</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_valid</span><span class="p">,</span> <span class="n">best_clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_valid</span><span class="p">)))</span>
</pre></div>
</div>
</section>
<section id="how-can-i-obtain-reproducible-optimization-results">
<h4><a class="toc-backref" href="#id7" role="doc-backlink">How can I obtain reproducible optimization results?</a><a class="headerlink" href="#how-can-i-obtain-reproducible-optimization-results" title="Permalink to this heading"></a></h4>
<p>To make the parameters suggested by Optuna reproducible, you can specify a fixed random seed via <code class="docutils literal notranslate"><span class="pre">seed</span></code> argument of an instance of <a class="reference internal" href="index.html#module-optuna.samplers" title="optuna.samplers"><code class="xref py py-mod docutils literal notranslate"><span class="pre">samplers</span></code></a> as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sampler</span> <span class="o">=</span> <span class="n">TPESampler</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>  <span class="c1"># Make the sampler behave in a deterministic way.</span>
<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">sampler</span><span class="o">=</span><span class="n">sampler</span><span class="p">)</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">)</span>
</pre></div>
</div>
<p>To make the pruning by <a class="reference internal" href="index.html#optuna.pruners.HyperbandPruner" title="optuna.pruners.HyperbandPruner"><code class="xref py py-class docutils literal notranslate"><span class="pre">HyperbandPruner</span></code></a> reproducible, you can specify <code class="docutils literal notranslate"><span class="pre">study_name</span></code> of <a class="reference internal" href="index.html#optuna.study.Study" title="optuna.study.Study"><code class="xref py py-class docutils literal notranslate"><span class="pre">Study</span></code></a> and <a class="reference external" href="https://docs.python.org/3/using/cmdline.html#envvar-PYTHONHASHSEED">hash seed</a>.</p>
<p>However, there are two caveats.</p>
<p>First, when optimizing a study in distributed or parallel mode, there is inherent non-determinism.
Thus it is very difficult to reproduce the same results in such condition.
We recommend executing optimization of a study sequentially if you would like to reproduce the result.</p>
<p>Second, if your objective function behaves in a non-deterministic way (i.e., it does not return the same value even if the same parameters were suggested), you cannot reproduce an optimization.
To deal with this problem, please set an option (e.g., random seed) to make the behavior deterministic if your optimization target (e.g., an ML library) provides it.</p>
</section>
<section id="how-are-exceptions-from-trials-handled">
<h4><a class="toc-backref" href="#id8" role="doc-backlink">How are exceptions from trials handled?</a><a class="headerlink" href="#how-are-exceptions-from-trials-handled" title="Permalink to this heading"></a></h4>
<p>Trials that raise exceptions without catching them will be treated as failures, i.e. with the <a class="reference internal" href="index.html#optuna.trial.TrialState.FAIL" title="optuna.trial.TrialState.FAIL"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FAIL</span></code></a> status.</p>
<p>By default, all exceptions except <a class="reference internal" href="index.html#optuna.exceptions.TrialPruned" title="optuna.exceptions.TrialPruned"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrialPruned</span></code></a> raised in objective functions are propagated to the caller of <a class="reference internal" href="index.html#optuna.study.Study.optimize" title="optuna.study.Study.optimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">optimize()</span></code></a>.
In other words, studies are aborted when such exceptions are raised.
It might be desirable to continue a study with the remaining trials.
To do so, you can specify in <a class="reference internal" href="index.html#optuna.study.Study.optimize" title="optuna.study.Study.optimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">optimize()</span></code></a> which exception types to catch using the <code class="docutils literal notranslate"><span class="pre">catch</span></code> argument.
Exceptions of these types are caught inside the study and will not propagate further.</p>
<p>You can find the failed trials in log messages.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>W<span class="w"> </span><span class="m">2018</span>-12-07<span class="w"> </span><span class="m">16</span>:38:36,889<span class="o">]</span><span class="w"> </span>Setting<span class="w"> </span>status<span class="w"> </span>of<span class="w"> </span>trial#0<span class="w"> </span>as<span class="w"> </span>TrialState.FAIL<span class="w"> </span>because<span class="w"> </span>of<span class="w"> </span><span class="se">\</span>
the<span class="w"> </span>following<span class="w"> </span>error:<span class="w"> </span>ValueError<span class="o">(</span><span class="s1">&#39;A sample error in objective.&#39;</span><span class="o">)</span>
</pre></div>
</div>
<p>You can also find the failed trials by checking the trial states as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">study</span><span class="o">.</span><span class="n">trials_dataframe</span><span class="p">()</span>
</pre></div>
</div>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>number</p></td>
<td><p>state</p></td>
<td><p>value</p></td>
<td><p>…</p></td>
<td><p>params</p></td>
<td><p>system_attrs</p></td>
</tr>
<tr class="row-even"><td><p>0</p></td>
<td><p>TrialState.FAIL</p></td>
<td></td>
<td><p>…</p></td>
<td><p>0</p></td>
<td><p>Setting status of trial#0 as TrialState.FAIL because of the following error: ValueError(‘A test error in objective.’)</p></td>
</tr>
<tr class="row-odd"><td><p>1</p></td>
<td><p>TrialState.COMPLETE</p></td>
<td><p>1269</p></td>
<td><p>…</p></td>
<td><p>1</p></td>
<td></td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>The <code class="docutils literal notranslate"><span class="pre">catch</span></code> argument in <a class="reference internal" href="index.html#optuna.study.Study.optimize" title="optuna.study.Study.optimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">optimize()</span></code></a>.</p>
</div>
</section>
<section id="how-are-nans-returned-by-trials-handled">
<h4><a class="toc-backref" href="#id9" role="doc-backlink">How are NaNs returned by trials handled?</a><a class="headerlink" href="#how-are-nans-returned-by-trials-handled" title="Permalink to this heading"></a></h4>
<p>Trials that return NaN (<code class="docutils literal notranslate"><span class="pre">float('nan')</span></code>) are treated as failures, but they will not abort studies.</p>
<p>Trials which return NaN are shown as follows:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>W<span class="w"> </span><span class="m">2018</span>-12-07<span class="w"> </span><span class="m">16</span>:41:59,000<span class="o">]</span><span class="w"> </span>Setting<span class="w"> </span>status<span class="w"> </span>of<span class="w"> </span>trial#2<span class="w"> </span>as<span class="w"> </span>TrialState.FAIL<span class="w"> </span>because<span class="w"> </span>the<span class="w"> </span><span class="se">\</span>
objective<span class="w"> </span><span class="k">function</span><span class="w"> </span>returned<span class="w"> </span>nan.
</pre></div>
</div>
</section>
<section id="what-happens-when-i-dynamically-alter-a-search-space">
<h4><a class="toc-backref" href="#id10" role="doc-backlink">What happens when I dynamically alter a search space?</a><a class="headerlink" href="#what-happens-when-i-dynamically-alter-a-search-space" title="Permalink to this heading"></a></h4>
<p>Since parameters search spaces are specified in each call to the suggestion API, e.g.
<a class="reference internal" href="index.html#optuna.trial.Trial.suggest_float" title="optuna.trial.Trial.suggest_float"><code class="xref py py-func docutils literal notranslate"><span class="pre">suggest_float()</span></code></a> and <a class="reference internal" href="index.html#optuna.trial.Trial.suggest_int" title="optuna.trial.Trial.suggest_int"><code class="xref py py-func docutils literal notranslate"><span class="pre">suggest_int()</span></code></a>,
it is possible to, in a single study, alter the range by sampling parameters from different search
spaces in different trials.
The behavior when altered is defined by each sampler individually.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Discussion about the TPE sampler. <a class="reference external" href="https://github.com/optuna/optuna/issues/822">https://github.com/optuna/optuna/issues/822</a></p>
</div>
</section>
<section id="how-can-i-use-two-gpus-for-evaluating-two-trials-simultaneously">
<h4><a class="toc-backref" href="#id11" role="doc-backlink">How can I use two GPUs for evaluating two trials simultaneously?</a><a class="headerlink" href="#how-can-i-use-two-gpus-for-evaluating-two-trials-simultaneously" title="Permalink to this heading"></a></h4>
<p>If your optimization target supports GPU (CUDA) acceleration and you want to specify which GPU is used in your script,
<code class="docutils literal notranslate"><span class="pre">main.py</span></code>, the easiest way is to set <code class="docutils literal notranslate"><span class="pre">CUDA_VISIBLE_DEVICES</span></code> environment variable:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># On a terminal.</span>
<span class="c1">#</span>
<span class="c1"># Specify to use the first GPU, and run an optimization.</span>
$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">CUDA_VISIBLE_DEVICES</span><span class="o">=</span><span class="m">0</span>
$<span class="w"> </span>python<span class="w"> </span>main.py

<span class="c1"># On another terminal.</span>
<span class="c1">#</span>
<span class="c1"># Specify to use the second GPU, and run another optimization.</span>
$<span class="w"> </span><span class="nb">export</span><span class="w"> </span><span class="nv">CUDA_VISIBLE_DEVICES</span><span class="o">=</span><span class="m">1</span>
$<span class="w"> </span>python<span class="w"> </span>main.py
</pre></div>
</div>
<p>Please refer to <a class="reference external" href="https://docs.nvidia.com/cuda/cuda-c-programming-guide/index.html#env-vars">CUDA C Programming Guide</a> for further details.</p>
</section>
<section id="how-can-i-test-my-objective-functions">
<h4><a class="toc-backref" href="#id12" role="doc-backlink">How can I test my objective functions?</a><a class="headerlink" href="#how-can-i-test-my-objective-functions" title="Permalink to this heading"></a></h4>
<p>When you test objective functions, you may prefer fixed parameter values to sampled ones.
In that case, you can use <a class="reference internal" href="index.html#optuna.trial.FixedTrial" title="optuna.trial.FixedTrial"><code class="xref py py-class docutils literal notranslate"><span class="pre">FixedTrial</span></code></a>, which suggests fixed parameter values based on a given dictionary of parameters.
For instance, you can input arbitrary values of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> to the objective function <span class="math notranslate nohighlight">\(x + y\)</span> as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_int</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>


<span class="n">objective</span><span class="p">(</span><span class="n">FixedTrial</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">}))</span>  <span class="c1"># 0.0</span>
<span class="n">objective</span><span class="p">(</span><span class="n">FixedTrial</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">4</span><span class="p">}))</span>  <span class="c1"># -5.0</span>
</pre></div>
</div>
<p>Using <a class="reference internal" href="index.html#optuna.trial.FixedTrial" title="optuna.trial.FixedTrial"><code class="xref py py-class docutils literal notranslate"><span class="pre">FixedTrial</span></code></a>, you can write unit tests as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># A test function of pytest</span>
<span class="k">def</span> <span class="nf">test_objective</span><span class="p">():</span>
    <span class="k">assert</span> <span class="mf">1.0</span> <span class="o">==</span> <span class="n">objective</span><span class="p">(</span><span class="n">FixedTrial</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}))</span>
    <span class="k">assert</span> <span class="o">-</span><span class="mf">1.0</span> <span class="o">==</span> <span class="n">objective</span><span class="p">(</span><span class="n">FixedTrial</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">}))</span>
    <span class="k">assert</span> <span class="mf">0.0</span> <span class="o">==</span> <span class="n">objective</span><span class="p">(</span><span class="n">FixedTrial</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}))</span>
</pre></div>
</div>
</section>
<section id="how-do-i-avoid-running-out-of-memory-oom-when-optimizing-studies">
<span id="out-of-memory-gc-collect"></span><h4><a class="toc-backref" href="#id13" role="doc-backlink">How do I avoid running out of memory (OOM) when optimizing studies?</a><a class="headerlink" href="#how-do-i-avoid-running-out-of-memory-oom-when-optimizing-studies" title="Permalink to this heading"></a></h4>
<p>If the memory footprint increases as you run more trials, try to periodically run the garbage collector.
Specify <code class="docutils literal notranslate"><span class="pre">gc_after_trial</span></code> to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> when calling <a class="reference internal" href="index.html#optuna.study.Study.optimize" title="optuna.study.Study.optimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">optimize()</span></code></a> or call <a class="reference external" href="https://docs.python.org/3/library/gc.html#gc.collect" title="(in Python v3.11)"><code class="xref py py-func docutils literal notranslate"><span class="pre">gc.collect()</span></code></a> inside a callback.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_int</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>


<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">()</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">gc_after_trial</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># `gc_after_trial=True` is more or less identical to the following.</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="k">lambda</span> <span class="n">study</span><span class="p">,</span> <span class="n">trial</span><span class="p">:</span> <span class="n">gc</span><span class="o">.</span><span class="n">collect</span><span class="p">()])</span>
</pre></div>
</div>
<p>There is a performance trade-off for running the garbage collector, which could be non-negligible depending on how fast your objective function otherwise is. Therefore, <code class="docutils literal notranslate"><span class="pre">gc_after_trial</span></code> is <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.11)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a> by default.
Note that the above examples are similar to running the garbage collector inside the objective function, except for the fact that <a class="reference external" href="https://docs.python.org/3/library/gc.html#gc.collect" title="(in Python v3.11)"><code class="xref py py-func docutils literal notranslate"><span class="pre">gc.collect()</span></code></a> is called even when errors, including <a class="reference internal" href="index.html#optuna.exceptions.TrialPruned" title="optuna.exceptions.TrialPruned"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrialPruned</span></code></a> are raised.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="index.html#optuna.integration.ChainerMNStudy" title="optuna.integration.ChainerMNStudy"><code class="xref py py-class docutils literal notranslate"><span class="pre">ChainerMNStudy</span></code></a> does currently not provide <code class="docutils literal notranslate"><span class="pre">gc_after_trial</span></code> nor callbacks for <a class="reference internal" href="index.html#optuna.integration.ChainerMNStudy.optimize" title="optuna.integration.ChainerMNStudy.optimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">optimize()</span></code></a>.
When using this class, you will have to call the garbage collector inside the objective function.</p>
</div>
</section>
<section id="how-can-i-output-a-log-only-when-the-best-value-is-updated">
<h4><a class="toc-backref" href="#id14" role="doc-backlink">How can I output a log only when the best value is updated?</a><a class="headerlink" href="#how-can-i-output-a-log-only-when-the-best-value-is-updated" title="Permalink to this heading"></a></h4>
<p>Here’s how to replace the logging feature of optuna with your own logging callback function.
The implemented callback can be passed to <a class="reference internal" href="index.html#optuna.study.Study.optimize" title="optuna.study.Study.optimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">optimize()</span></code></a>.
Here’s an example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">optuna</span>


<span class="c1"># Turn off optuna log notes.</span>
<span class="n">optuna</span><span class="o">.</span><span class="n">logging</span><span class="o">.</span><span class="n">set_verbosity</span><span class="p">(</span><span class="n">optuna</span><span class="o">.</span><span class="n">logging</span><span class="o">.</span><span class="n">WARN</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span>


<span class="k">def</span> <span class="nf">logging_callback</span><span class="p">(</span><span class="n">study</span><span class="p">,</span> <span class="n">frozen_trial</span><span class="p">):</span>
    <span class="n">previous_best_value</span> <span class="o">=</span> <span class="n">study</span><span class="o">.</span><span class="n">user_attrs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;previous_best_value&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">previous_best_value</span> <span class="o">!=</span> <span class="n">study</span><span class="o">.</span><span class="n">best_value</span><span class="p">:</span>
        <span class="n">study</span><span class="o">.</span><span class="n">set_user_attr</span><span class="p">(</span><span class="s2">&quot;previous_best_value&quot;</span><span class="p">,</span> <span class="n">study</span><span class="o">.</span><span class="n">best_value</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;Trial </span><span class="si">{}</span><span class="s2"> finished with best value: </span><span class="si">{}</span><span class="s2"> and parameters: </span><span class="si">{}</span><span class="s2">. &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">frozen_trial</span><span class="o">.</span><span class="n">number</span><span class="p">,</span>
            <span class="n">frozen_trial</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
            <span class="n">frozen_trial</span><span class="o">.</span><span class="n">params</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="p">)</span>


<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">()</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">logging_callback</span><span class="p">])</span>
</pre></div>
</div>
<p>Note that this callback may show incorrect values when you try to optimize an objective function with <code class="docutils literal notranslate"><span class="pre">n_jobs!=1</span></code>
(or other forms of distributed optimization) due to its reads and writes to storage that are prone to race conditions.</p>
</section>
<section id="how-do-i-suggest-variables-which-represent-the-proportion-that-is-are-in-accordance-with-dirichlet-distribution">
<h4><a class="toc-backref" href="#id15" role="doc-backlink">How do I suggest variables which represent the proportion, that is, are in accordance with Dirichlet distribution?</a><a class="headerlink" href="#how-do-i-suggest-variables-which-represent-the-proportion-that-is-are-in-accordance-with-dirichlet-distribution" title="Permalink to this heading"></a></h4>
<p>When you want to suggest <span class="math notranslate nohighlight">\(n\)</span> variables which represent the proportion, that is, <span class="math notranslate nohighlight">\(p[0], p[1], ..., p[n-1]\)</span> which satisfy <span class="math notranslate nohighlight">\(0 \le p[k] \le 1\)</span> for any <span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\(p[0] + p[1] + ... + p[n-1] = 1\)</span>, try the below.
For example, these variables can be used as weights when interpolating the loss functions.
These variables are in accordance with the flat <a class="reference external" href="https://en.wikipedia.org/wiki/Dirichlet_distribution">Dirichlet distribution</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">optuna</span>


<span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;x_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>

    <span class="n">p</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="nb">sum</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">trial</span><span class="o">.</span><span class="n">set_user_attr</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="k">return</span> <span class="mi">0</span>

<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">sampler</span><span class="o">=</span><span class="n">optuna</span><span class="o">.</span><span class="n">samplers</span><span class="o">.</span><span class="n">RandomSampler</span><span class="p">())</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">p</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">p</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">trial</span><span class="o">.</span><span class="n">user_attrs</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;p_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="k">for</span> <span class="n">trial</span> <span class="ow">in</span> <span class="n">study</span><span class="o">.</span><span class="n">trials</span><span class="p">])</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">))[</span><span class="mi">1</span><span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">p</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">axes</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;p_</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s2">&quot;sampled_ps.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This method is justified in the following way:
First, if we apply the transformation <span class="math notranslate nohighlight">\(x = - \log (u)\)</span> to the variable <span class="math notranslate nohighlight">\(u\)</span> sampled from the uniform distribution <span class="math notranslate nohighlight">\(Uni(0, 1)\)</span> in the interval <span class="math notranslate nohighlight">\([0, 1]\)</span>, the variable <span class="math notranslate nohighlight">\(x\)</span> will follow the exponential distribution <span class="math notranslate nohighlight">\(Exp(1)\)</span> with scale parameter <span class="math notranslate nohighlight">\(1\)</span>.
Furthermore, for <span class="math notranslate nohighlight">\(n\)</span> variables <span class="math notranslate nohighlight">\(x[0], ..., x[n-1]\)</span> that follow the exponential distribution of scale parameter <span class="math notranslate nohighlight">\(1\)</span> independently, normalizing them with <span class="math notranslate nohighlight">\(p[i] = x[i] / \sum_i x[i]\)</span>, the vector <span class="math notranslate nohighlight">\(p\)</span> follows the Dirichlet distribution <span class="math notranslate nohighlight">\(Dir(\alpha)\)</span> of scale parameter <span class="math notranslate nohighlight">\(\alpha = (1, ..., 1)\)</span>.
You can verify the transformation by calculating the elements of the Jacobian.</p>
</section>
<section id="how-can-i-optimize-a-model-with-some-constraints">
<h4><a class="toc-backref" href="#id16" role="doc-backlink">How can I optimize a model with some constraints?</a><a class="headerlink" href="#how-can-i-optimize-a-model-with-some-constraints" title="Permalink to this heading"></a></h4>
<p>When you want to optimize a model with constraints, you can use the following classes: <a class="reference internal" href="index.html#optuna.samplers.TPESampler" title="optuna.samplers.TPESampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">TPESampler</span></code></a>, <a class="reference internal" href="index.html#optuna.samplers.NSGAIISampler" title="optuna.samplers.NSGAIISampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">NSGAIISampler</span></code></a> or <a class="reference internal" href="index.html#optuna.integration.BoTorchSampler" title="optuna.integration.BoTorchSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BoTorchSampler</span></code></a>.
The following example is a benchmark of Binh and Korn function, a multi-objective optimization, with constraints using <a class="reference internal" href="index.html#optuna.samplers.NSGAIISampler" title="optuna.samplers.NSGAIISampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">NSGAIISampler</span></code></a>. This one has two constraints <span class="math notranslate nohighlight">\(c_0 = (x-5)^2 + y^2 - 25 \le 0\)</span> and <span class="math notranslate nohighlight">\(c_1 = -(x - 8)^2 - (y + 3)^2 + 7.7 \le 0\)</span> and finds the optimal solution satisfying these constraints.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">optuna</span>


<span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="c1"># Binh and Korn function with constraints.</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">trial</span><span class="o">.</span><span class="n">suggest_float</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

    <span class="c1"># Constraints which are considered feasible if less than or equal to zero.</span>
    <span class="c1"># The feasible region is basically the intersection of a circle centered at (x=5, y=0)</span>
    <span class="c1"># and the complement to a circle centered at (x=8, y=-3).</span>
    <span class="n">c0</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">25</span>
    <span class="n">c1</span> <span class="o">=</span> <span class="o">-</span><span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="mi">8</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">y</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mf">7.7</span>

    <span class="c1"># Store the constraints as user attributes so that they can be restored after optimization.</span>
    <span class="n">trial</span><span class="o">.</span><span class="n">set_user_attr</span><span class="p">(</span><span class="s2">&quot;constraint&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">c0</span><span class="p">,</span> <span class="n">c1</span><span class="p">))</span>

    <span class="n">v0</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">y</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">v1</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>

    <span class="k">return</span> <span class="n">v0</span><span class="p">,</span> <span class="n">v1</span>


<span class="k">def</span> <span class="nf">constraints</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">trial</span><span class="o">.</span><span class="n">user_attrs</span><span class="p">[</span><span class="s2">&quot;constraint&quot;</span><span class="p">]</span>


<span class="n">sampler</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">samplers</span><span class="o">.</span><span class="n">NSGAIISampler</span><span class="p">(</span><span class="n">constraints_func</span><span class="o">=</span><span class="n">constraints</span><span class="p">)</span>
<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span>
    <span class="n">directions</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;minimize&quot;</span><span class="p">,</span> <span class="s2">&quot;minimize&quot;</span><span class="p">],</span>
    <span class="n">sampler</span><span class="o">=</span><span class="n">sampler</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of finished trials: &quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">study</span><span class="o">.</span><span class="n">trials</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Pareto front:&quot;</span><span class="p">)</span>

<span class="n">trials</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">study</span><span class="o">.</span><span class="n">best_trials</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">t</span><span class="p">:</span> <span class="n">t</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

<span class="k">for</span> <span class="n">trial</span> <span class="ow">in</span> <span class="n">trials</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;  Trial#</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">trial</span><span class="o">.</span><span class="n">number</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span>
        <span class="s2">&quot;    Values: Values=</span><span class="si">{}</span><span class="s2">, Constraint=</span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="n">trial</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">trial</span><span class="o">.</span><span class="n">user_attrs</span><span class="p">[</span><span class="s2">&quot;constraint&quot;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;    Params: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">trial</span><span class="o">.</span><span class="n">params</span><span class="p">))</span>
</pre></div>
</div>
<p>If you are interested in an example for <a class="reference internal" href="index.html#optuna.integration.BoTorchSampler" title="optuna.integration.BoTorchSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">BoTorchSampler</span></code></a>, please refer to <a class="reference external" href="https://github.com/optuna/optuna-examples/blob/main/multi_objective/botorch_simple.py">this sample code</a>.</p>
<p>There are two kinds of constrained optimizations, one with soft constraints and the other with hard constraints.
Soft constraints do not have to be satisfied, but an objective function is penalized if they are unsatisfied. On the other hand, hard constraints must be satisfied.</p>
<p>Optuna is adopting the soft one and <strong>DOES NOT</strong> support the hard one. In other words, Optuna <strong>DOES NOT</strong> have built-in samplers for the hard constraints.</p>
</section>
<section id="how-can-i-parallelize-optimization">
<h4><a class="toc-backref" href="#id17" role="doc-backlink">How can I parallelize optimization?</a><a class="headerlink" href="#how-can-i-parallelize-optimization" title="Permalink to this heading"></a></h4>
<p>The variations of parallelization are in the following three cases.</p>
<ol class="arabic simple">
<li><p>Multi-threading parallelization with single node</p></li>
<li><p>Multi-processing parallelization with single node</p></li>
<li><p>Multi-processing parallelization with multiple nodes</p></li>
</ol>
<section id="multi-threading-parallelization-with-a-single-node">
<h5><a class="toc-backref" href="#id18" role="doc-backlink">1. Multi-threading parallelization with a single node</a><a class="headerlink" href="#multi-threading-parallelization-with-a-single-node" title="Permalink to this heading"></a></h5>
<p>Parallelization can be achieved by setting the argument <code class="docutils literal notranslate"><span class="pre">n_jobs</span></code> in <a class="reference internal" href="index.html#optuna.study.Study.optimize" title="optuna.study.Study.optimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">optuna.study.Study.optimize()</span></code></a>.
However, the python code will not be faster due to GIL because <a class="reference internal" href="index.html#optuna.study.Study.optimize" title="optuna.study.Study.optimize"><code class="xref py py-func docutils literal notranslate"><span class="pre">optuna.study.Study.optimize()</span></code></a> with <code class="docutils literal notranslate"><span class="pre">n_jobs!=1</span></code> uses multi-threading.</p>
<p>While optimizing, it will be faster in limited situations, such as waiting for other server requests or C/C++ processing with numpy, etc., but it will not be faster in other cases.</p>
<p>For more information about 1., see <a class="reference external" href="https://optuna.readthedocs.io/en/stable/reference/index.html">APIReference</a>.</p>
</section>
<section id="multi-processing-parallelization-with-single-node">
<h5><a class="toc-backref" href="#id19" role="doc-backlink">2. Multi-processing parallelization with single node</a><a class="headerlink" href="#multi-processing-parallelization-with-single-node" title="Permalink to this heading"></a></h5>
<p>This can be achieved by using <a class="reference internal" href="index.html#optuna.storages.JournalFileStorage" title="optuna.storages.JournalFileStorage"><code class="xref py py-class docutils literal notranslate"><span class="pre">JournalFileStorage</span></code></a> or client/server RDBs (such as PostgreSQL and MySQL).</p>
<p>For more information about 2., see <a class="reference external" href="https://optuna.readthedocs.io/en/stable/tutorial/10_key_features/004_distributed.html">TutorialEasyParallelization</a>.</p>
</section>
<section id="multi-processing-parallelization-with-multiple-nodes">
<h5><a class="toc-backref" href="#id20" role="doc-backlink">3. Multi-processing parallelization with multiple nodes</a><a class="headerlink" href="#multi-processing-parallelization-with-multiple-nodes" title="Permalink to this heading"></a></h5>
<p>This can be achieved by using client/server RDBs (such as PostgreSQL and MySQL).
However, if you are in the environment where you can not install a client/server RDB, you can not run multi-processing parallelization with multiple nodes.</p>
<p>For more information about 3., see <a class="reference external" href="https://optuna.readthedocs.io/en/stable/tutorial/10_key_features/004_distributed.html">TutorialEasyParallelization</a>.</p>
</section>
</section>
<section id="how-can-i-solve-the-error-that-occurs-when-performing-parallel-optimization-with-sqlite3">
<span id="sqlite-concurrency"></span><h4><a class="toc-backref" href="#id21" role="doc-backlink">How can I solve the error that occurs when performing parallel optimization with SQLite3?</a><a class="headerlink" href="#how-can-i-solve-the-error-that-occurs-when-performing-parallel-optimization-with-sqlite3" title="Permalink to this heading"></a></h4>
<p>We would never recommend SQLite3 for parallel optimization in the following reasons.</p>
<ul class="simple">
<li><p>To concurrently evaluate trials enqueued by <a class="reference internal" href="index.html#optuna.study.Study.enqueue_trial" title="optuna.study.Study.enqueue_trial"><code class="xref py py-func docutils literal notranslate"><span class="pre">enqueue_trial()</span></code></a>, <a class="reference internal" href="index.html#optuna.storages.RDBStorage" title="optuna.storages.RDBStorage"><code class="xref py py-class docutils literal notranslate"><span class="pre">RDBStorage</span></code></a> uses <cite>SELECT … FOR UPDATE</cite> syntax, which is unsupported in <a class="reference external" href="https://github.com/sqlalchemy/sqlalchemy/blob/rel_1_4_41/lib/sqlalchemy/dialects/sqlite/base.py#L1265-L1267">SQLite3</a>.</p></li>
<li><p>As described in <a class="reference external" href="https://docs.sqlalchemy.org/en/14/dialects/sqlite.html#sqlite-concurrency">the SQLAlchemy’s documentation</a>,
SQLite3 (and pysqlite driver) does not support a high level of concurrency.
You may get a “database is locked” error, which occurs when one thread or process has an exclusive lock on a database connection (in reality a file handle) and another thread times out waiting for the lock to be released.
You can increase the default <a class="reference external" href="https://docs.python.org/3/library/sqlite3.html#sqlite3.connect">timeout</a> value like <cite>optuna.storages.RDBStorage(“sqlite:///example.db”, engine_kwargs={“connect_args”: {“timeout”: 20.0}})</cite> though.</p></li>
<li><p>For distributed optimization via NFS, SQLite3 does not work as described at <a class="reference external" href="https://www.sqlite.org/faq.html#q5">FAQ section of sqlite.org</a>.</p></li>
</ul>
<p>If you want to use a file-based Optuna storage for these scenarios, please consider using <a class="reference internal" href="index.html#optuna.storages.JournalFileStorage" title="optuna.storages.JournalFileStorage"><code class="xref py py-class docutils literal notranslate"><span class="pre">JournalFileStorage</span></code></a> instead.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">optuna</span>
<span class="kn">from</span> <span class="nn">optuna.storages</span> <span class="kn">import</span> <span class="n">JournalStorage</span><span class="p">,</span> <span class="n">JournalFileStorage</span>

<span class="n">storage</span> <span class="o">=</span> <span class="n">JournalStorage</span><span class="p">(</span><span class="n">JournalFileStorage</span><span class="p">(</span><span class="s2">&quot;optuna-journal.log&quot;</span><span class="p">))</span>
<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">storage</span><span class="o">=</span><span class="n">storage</span><span class="p">)</span>
<span class="o">...</span>
</pre></div>
</div>
<p>See <a class="reference external" href="https://medium.com/optuna/distributed-optimization-via-nfs-using-optunas-new-operation-based-logging-storage-9815f9c3f932">the Medium blog post</a> for details.</p>
</section>
<section id="can-i-monitor-trials-and-make-them-failed-automatically-when-they-are-killed-unexpectedly">
<span id="heartbeat-monitoring"></span><h4><a class="toc-backref" href="#id22" role="doc-backlink">Can I monitor trials and make them failed automatically when they are killed unexpectedly?</a><a class="headerlink" href="#can-i-monitor-trials-and-make-them-failed-automatically-when-they-are-killed-unexpectedly" title="Permalink to this heading"></a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Heartbeat mechanism is experimental. API would change in the future.</p>
</div>
<p>A process running a trial could be killed unexpectedly, typically by a job scheduler in a cluster environment.
If trials are killed unexpectedly, they will be left on the storage with their states <cite>RUNNING</cite> until we remove them or update their state manually.
For such a case, Optuna supports monitoring trials using <a class="reference external" href="https://en.wikipedia.org/wiki/Heartbeat_(computing)">heartbeat</a> mechanism.
Using heartbeat, if a process running a trial is killed unexpectedly,
Optuna will automatically change the state of the trial that was running on that process to <a class="reference internal" href="index.html#optuna.trial.TrialState.FAIL" title="optuna.trial.TrialState.FAIL"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FAIL</span></code></a>
from <a class="reference internal" href="index.html#optuna.trial.TrialState.RUNNING" title="optuna.trial.TrialState.RUNNING"><code class="xref py py-obj docutils literal notranslate"><span class="pre">RUNNING</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">optuna</span>

<span class="k">def</span> <span class="nf">objective</span><span class="p">(</span><span class="n">trial</span><span class="p">):</span>
    <span class="p">(</span><span class="n">Very</span> <span class="n">time</span><span class="o">-</span><span class="n">consuming</span> <span class="n">computation</span><span class="p">)</span>

<span class="c1"># Recording heartbeats every 60 seconds.</span>
<span class="c1"># Other processes&#39; trials where more than 120 seconds have passed</span>
<span class="c1"># since the last heartbeat was recorded will be automatically failed.</span>
<span class="n">storage</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">storages</span><span class="o">.</span><span class="n">RDBStorage</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="s2">&quot;sqlite:///:memory:&quot;</span><span class="p">,</span> <span class="n">heartbeat_interval</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span> <span class="n">grace_period</span><span class="o">=</span><span class="mi">120</span><span class="p">)</span>
<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">storage</span><span class="o">=</span><span class="n">storage</span><span class="p">)</span>
<span class="n">study</span><span class="o">.</span><span class="n">optimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">n_trials</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The heartbeat is supposed to be used with <a class="reference internal" href="index.html#optuna.study.Study.optimize" title="optuna.study.Study.optimize"><code class="xref py py-meth docutils literal notranslate"><span class="pre">optimize()</span></code></a>. If you use <a class="reference internal" href="index.html#optuna.study.Study.ask" title="optuna.study.Study.ask"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ask()</span></code></a> and
<a class="reference internal" href="index.html#optuna.study.Study.tell" title="optuna.study.Study.tell"><code class="xref py py-meth docutils literal notranslate"><span class="pre">tell()</span></code></a>, please change the state of the killed trials by calling <a class="reference internal" href="index.html#optuna.study.Study.tell" title="optuna.study.Study.tell"><code class="xref py py-meth docutils literal notranslate"><span class="pre">tell()</span></code></a>
explicitly.</p>
</div>
<p>You can also execute a callback function to process the failed trial.
Optuna provides a callback to retry failed trials as <a class="reference internal" href="index.html#optuna.storages.RetryFailedTrialCallback" title="optuna.storages.RetryFailedTrialCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">RetryFailedTrialCallback</span></code></a>.
Note that a callback is invoked at a beginning of each trial, which means <a class="reference internal" href="index.html#optuna.storages.RetryFailedTrialCallback" title="optuna.storages.RetryFailedTrialCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">RetryFailedTrialCallback</span></code></a>
will retry failed trials when a new trial starts to evaluate.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">optuna</span>
<span class="kn">from</span> <span class="nn">optuna.storages</span> <span class="kn">import</span> <span class="n">RetryFailedTrialCallback</span>

<span class="n">storage</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">storages</span><span class="o">.</span><span class="n">RDBStorage</span><span class="p">(</span>
    <span class="n">url</span><span class="o">=</span><span class="s2">&quot;sqlite:///:memory:&quot;</span><span class="p">,</span>
    <span class="n">heartbeat_interval</span><span class="o">=</span><span class="mi">60</span><span class="p">,</span>
    <span class="n">grace_period</span><span class="o">=</span><span class="mi">120</span><span class="p">,</span>
    <span class="n">failed_trial_callback</span><span class="o">=</span><span class="n">RetryFailedTrialCallback</span><span class="p">(</span><span class="n">max_retry</span><span class="o">=</span><span class="mi">3</span><span class="p">),</span>
<span class="p">)</span>

<span class="n">study</span> <span class="o">=</span> <span class="n">optuna</span><span class="o">.</span><span class="n">create_study</span><span class="p">(</span><span class="n">storage</span><span class="o">=</span><span class="n">storage</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</div>
</section>
</section>
<section id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this heading"></a></h1>
<ul class="simple">
<li><p><a class="reference internal" href="genindex.html"><span class="std std-ref">Index</span></a></p></li>
<li><p><a class="reference internal" href="py-modindex.html"><span class="std std-ref">Module Index</span></a></p></li>
<li><p><a class="reference internal" href="search.html"><span class="std std-ref">Search Page</span></a></p></li>
</ul>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2018, Optuna Contributors.
      <span class="commit">Revision <code>4adaf8df</code>.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
    <a href="#">Privacy Policy</a>.
     


</footer>
        </div>
      </div>
    </section>
  </div>
  

  <div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="Versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      <span class="fa fa-book"> Read the Docs</span>
      v: latest
      <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
      <dl>
        <dt>Versions</dt>
        
          <dd><a href="/en/latest/">latest</a></dd>
        
          <dd><a href="/en/stable/">stable</a></dd>
        
          <dd><a href="/en/v3.1.0/">v3.1.0</a></dd>
        
          <dd><a href="/en/v3.1.0-b0/">v3.1.0-b0</a></dd>
        
          <dd><a href="/en/v3.0.6/">v3.0.6</a></dd>
        
          <dd><a href="/en/v3.0.5/">v3.0.5</a></dd>
        
          <dd><a href="/en/v3.0.4/">v3.0.4</a></dd>
        
          <dd><a href="/en/v3.0.3/">v3.0.3</a></dd>
        
          <dd><a href="/en/v3.0.2/">v3.0.2</a></dd>
        
          <dd><a href="/en/v3.0.1/">v3.0.1</a></dd>
        
          <dd><a href="/en/v3.0.0/">v3.0.0</a></dd>
        
          <dd><a href="/en/v3.0.0-rc0/">v3.0.0-rc0</a></dd>
        
          <dd><a href="/en/v3.0.0-b1/">v3.0.0-b1</a></dd>
        
          <dd><a href="/en/v3.0.0-b0/">v3.0.0-b0</a></dd>
        
          <dd><a href="/en/v3.0.0-a2/">v3.0.0-a2</a></dd>
        
          <dd><a href="/en/v3.0.0-a1/">v3.0.0-a1</a></dd>
        
          <dd><a href="/en/v3.0.0-a0/">v3.0.0-a0</a></dd>
        
          <dd><a href="/en/v2.10.1/">v2.10.1</a></dd>
        
          <dd><a href="/en/v2.10.0/">v2.10.0</a></dd>
        
          <dd><a href="/en/v2.9.1/">v2.9.1</a></dd>
        
          <dd><a href="/en/v2.9.0/">v2.9.0</a></dd>
        
          <dd><a href="/en/v2.8.0/">v2.8.0</a></dd>
        
          <dd><a href="/en/v2.7.0/">v2.7.0</a></dd>
        
          <dd><a href="/en/v2.6.0/">v2.6.0</a></dd>
        
          <dd><a href="/en/v2.5.0/">v2.5.0</a></dd>
        
          <dd><a href="/en/v2.4.0/">v2.4.0</a></dd>
        
          <dd><a href="/en/v2.3.0/">v2.3.0</a></dd>
        
          <dd><a href="/en/v2.2.0/">v2.2.0</a></dd>
        
          <dd><a href="/en/v2.1.0/">v2.1.0</a></dd>
        
          <dd><a href="/en/v2.0.0/">v2.0.0</a></dd>
        
          <dd><a href="/en/v2.0.0-rc0/">v2.0.0-rc0</a></dd>
        
          <dd><a href="/en/v1.5.0/">v1.5.0</a></dd>
        
          <dd><a href="/en/v1.4.0/">v1.4.0</a></dd>
        
          <dd><a href="/en/v1.3.0/">v1.3.0</a></dd>
        
          <dd><a href="/en/v1.2.0/">v1.2.0</a></dd>
        
          <dd><a href="/en/v1.1.0/">v1.1.0</a></dd>
        
          <dd><a href="/en/v1.0.0/">v1.0.0</a></dd>
        
          <dd><a href="/en/v0.19.0/">v0.19.0</a></dd>
        
      </dl>
      <dl>
        <dt>Downloads</dt>
        
          <dd><a href="//optuna.readthedocs.io/_/downloads/en/latest/pdf/">pdf</a></dd>
        
          <dd><a href="//optuna.readthedocs.io/_/downloads/en/latest/htmlzip/">html</a></dd>
        
          <dd><a href="//optuna.readthedocs.io/_/downloads/en/latest/epub/">epub</a></dd>
        
      </dl>
      <dl>
        
        <dt>On Read the Docs</dt>
          <dd>
            <a href="//readthedocs.org/projects/optuna/?fromdocs=optuna">Project Home</a>
          </dd>
          <dd>
            <a href="//readthedocs.org/builds/optuna/?fromdocs=optuna">Builds</a>
          </dd>
      </dl>
    </div>
  </div>
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>